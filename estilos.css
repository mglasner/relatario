/* Estilos de La Casa del Terror */

/* --- Fuentes locales --- */

@font-face {
    font-family: Creepster;
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('assets/fonts/creepster-400-latin.woff2') format('woff2');
}

@font-face {
    font-family: Quicksand;
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('assets/fonts/quicksand-variable-latin.woff2') format('woff2');
}

:root {
    /* Fuentes */
    --font-display: creepster, cursive;
    --font-body: quicksand, sans-serif;

    /* Tema base */
    --color-fondo: #1a1a2e;
    --color-superficie: #16213e;
    --color-oscuro: #0d0d1a;
    --color-accent: #e94560;
    --color-accent-hover: #c73652;
    --color-texto: #e0e0e0;
    --color-texto-secundario: #a0a0b0;
    --color-texto-tenue: #888;
    --color-texto-apagado: #666;
    --color-texto-muy-apagado: #555;
    --color-borde: #333;
    --color-borde-claro: #444;
    --color-dorado: #ffd700;

    /* Radios */
    --radio-tarjeta: 15px;
    --radio-boton: 8px;
}

body {
    margin: 0;
    padding: 0;
    background-color: var(--color-fondo);
    color: var(--color-texto);
    font-family: var(--font-body);
}

#juego {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
    text-align: center;
}

#juego.juego-inmersivo {
    max-width: none;
    padding: 10px;
}

#juego.juego-inmersivo .barra-superior {
    max-width: var(--ancho-3d);
    margin-inline: auto;
}

h1 {
    font-family: var(--font-display);
    font-size: 2.5rem;
    color: white;
    letter-spacing: 0.04em;
}

/* --- Carrusel horizontal --- */

.carrusel-wrapper {
    position: relative;
}

.carrusel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    width: 36px;
    height: 36px;
    border: 2px solid rgb(255 255 255 / 20%);
    border-radius: 50%;
    background-color: rgb(15 15 30 / 85%);
    color: var(--color-texto);
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        background-color 0.2s,
        border-color 0.2s,
        opacity 0.3s;
    opacity: 0.7;
}

.carrusel-btn:hover {
    background-color: rgb(30 30 60 / 95%);
    border-color: var(--color-accent);
    color: var(--color-accent);
    opacity: 1;
}

.carrusel-btn:disabled {
    opacity: 0;
    pointer-events: none;
}

.carrusel-btn-izq {
    left: -6px;
}

.carrusel-btn-der {
    right: -6px;
}

/* --- Selección de personaje --- */

.titulo-heroes {
    font-family: var(--font-display);
    color: var(--color-dorado);
    font-size: 1.4rem;
    margin-top: 30px;
    margin-bottom: 0;
    text-shadow: 0 0 10px rgb(255 215 0 / 35%);
}

.subtitulo-seleccion {
    color: var(--color-texto-secundario);
    font-size: 0.95rem;
    margin: 4px 0 0;
    letter-spacing: 0.02em;
}

.personajes {
    display: flex;
    gap: 20px;
    margin: 15px 0 30px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding: 10px 20px;
    scroll-padding: 20px;
    scrollbar-width: none;
}

.personajes::-webkit-scrollbar {
    display: none;
}

.personaje {
    position: relative;
    background-color: var(--color-superficie);
    border: 3px solid #0f3460;
    border-radius: var(--radio-tarjeta);
    padding: 20px;
    width: 200px;
    cursor: pointer;
    flex-shrink: 0;
    scroll-snap-align: center;
    transition:
        transform 0.2s,
        border-color 0.2s,
        box-shadow 0.2s;
}

.personaje:hover {
    transform: scale(1.05);
    border-color: var(--color-accent);
}

/* Foco de teclado (navegación con flechas) */
.personaje.enfocado:not(.seleccionado) {
    outline: 2px dashed rgb(255 255 255 / 70%);
    outline-offset: 4px;
    animation: pulso-foco-personaje 1.5s ease-in-out infinite;
}

@keyframes pulso-foco-personaje {
    0%,
    100% {
        outline-color: rgb(255 255 255 / 40%);
    }

    50% {
        outline-color: rgb(255 255 255 / 90%);
    }
}

.personaje.seleccionado {
    position: relative;
    border-color: #e94560;
    box-shadow:
        0 0 30px rgb(233 69 96 / 70%),
        0 0 60px rgb(233 69 96 / 30%);
    transform: scale(1.1);
    animation: temblar 0.4s ease;
    background-color: #1e1040;
}

/* Glow animado GPU-composited (opacity en vez de box-shadow) */
.personaje.seleccionado::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    box-shadow:
        0 0 50px rgb(233 69 96 / 90%),
        0 0 100px rgb(147 51 234 / 50%);
    animation: pulso-opacity 1.5s ease-in-out 0.4s infinite;
    pointer-events: none;
}

.personaje.seleccionado .avatar {
    animation: girar 0.6s ease;
}

.personaje.seleccionado h3 {
    animation: neon 1.5s ease-in-out infinite;
}

/* Temblor al seleccionar */
@keyframes temblar {
    0% {
        transform: scale(1.1) rotate(0deg);
    }

    15% {
        transform: scale(1.15) rotate(-5deg);
    }

    30% {
        transform: scale(1.1) rotate(5deg);
    }

    45% {
        transform: scale(1.15) rotate(-3deg);
    }

    60% {
        transform: scale(1.1) rotate(3deg);
    }

    75% {
        transform: scale(1.12) rotate(-1deg);
    }

    100% {
        transform: scale(1.1) rotate(0deg);
    }
}

/* Brillo pulsante continuo — GPU-composited: solo anima opacity */
@keyframes pulso-opacity {
    0%,
    100% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }
}

/* El emoji gira una vuelta */
@keyframes girar {
    0% {
        transform: rotateY(0deg) scale(1);
    }

    50% {
        transform: rotateY(180deg) scale(1.3);
    }

    100% {
        transform: rotateY(360deg) scale(1);
    }
}

/* Nombre con efecto neón */
@keyframes neon {
    0% {
        color: #e94560;
        text-shadow: none;
    }

    50% {
        color: #ff6b81;
        text-shadow:
            0 0 10px #e94560,
            0 0 20px #e94560;
    }

    100% {
        color: #e94560;
        text-shadow: none;
    }
}

.avatar {
    font-size: 4rem;
    margin-bottom: 10px;
    display: inline-block;
}

.avatar img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-texto-muy-apagado);
}

/* --- Colores por personaje --- */

/* Lina - paleta morada */
.personaje-lina {
    border-color: #4a1a6b;
    background-color: #1a0a2e;
}

.personaje-lina:hover {
    border-color: #9b59b6;
}

.personaje-lina h3 {
    color: #bb86fc;
}

.personaje-lina .avatar img {
    border-color: #9b59b6;
}

.personaje-lina.seleccionado {
    border-color: #bb86fc;
    box-shadow:
        0 0 30px rgb(187 134 252 / 70%),
        0 0 60px rgb(155 89 182 / 30%);
    background-color: #2a1045;
}

.personaje-lina.seleccionado h3 {
    animation: neon-lina 1.5s ease-in-out infinite;
}

@keyframes neon-lina {
    0% {
        color: #bb86fc;
        text-shadow: none;
    }

    50% {
        color: #e0b0ff;
        text-shadow:
            0 0 10px #9b59b6,
            0 0 20px #9b59b6;
    }

    100% {
        color: #bb86fc;
        text-shadow: none;
    }
}

/* Rosé - paleta verde */
.personaje-rose {
    border-color: #1a6b2a;
    background-color: #0a2e14;
}

.personaje-rose:hover {
    border-color: #2ecc71;
}

.personaje-rose h3 {
    color: #6bfc86;
}

.personaje-rose .avatar img {
    border-color: #2ecc71;
}

.personaje-rose.seleccionado {
    border-color: #6bfc86;
    box-shadow:
        0 0 30px rgb(107 252 134 / 70%),
        0 0 60px rgb(46 204 113 / 30%);
    background-color: #10452a;
}

.personaje-rose.seleccionado h3 {
    animation: neon-rose 1.5s ease-in-out infinite;
}

@keyframes neon-rose {
    0% {
        color: #6bfc86;
        text-shadow: none;
    }

    50% {
        color: #b0ffc0;
        text-shadow:
            0 0 10px #2ecc71,
            0 0 20px #2ecc71;
    }

    100% {
        color: #6bfc86;
        text-shadow: none;
    }
}

/* Hana - paleta rosa/fucsia */
.personaje-hana {
    border-color: #6b1a5a;
    background-color: #2e0a28;
}

.personaje-hana:hover {
    border-color: #e91e90;
}

.personaje-hana h3 {
    color: #fc86d4;
}

.personaje-hana .avatar img {
    border-color: #e91e90;
}

.personaje-hana.seleccionado {
    border-color: #fc86d4;
    box-shadow:
        0 0 30px rgb(252 134 212 / 70%),
        0 0 60px rgb(233 30 144 / 30%);
    background-color: #3a1035;
}

.personaje-hana.seleccionado h3 {
    animation: neon-hana 1.5s ease-in-out infinite;
}

@keyframes neon-hana {
    0% {
        color: #fc86d4;
        text-shadow: none;
    }

    50% {
        color: #ffb0e6;
        text-shadow:
            0 0 10px #e91e90,
            0 0 20px #e91e90;
    }

    100% {
        color: #fc86d4;
        text-shadow: none;
    }
}

/* DonBu - paleta marrón/ámbar */
.personaje-donbu {
    border-color: #6b4a1a;
    background-color: #2e1a0a;
}

.personaje-donbu:hover {
    border-color: #d4a052;
}

.personaje-donbu h3 {
    color: #fcca6b;
}

.personaje-donbu .avatar img {
    border-color: #d4a052;
}

.personaje-donbu.seleccionado {
    border-color: #fcca6b;
    box-shadow:
        0 0 30px rgb(252 202 107 / 70%),
        0 0 60px rgb(212 160 82 / 30%);
    background-color: #3a2510;
}

.personaje-donbu.seleccionado h3 {
    animation: neon-donbu 1.5s ease-in-out infinite;
}

@keyframes neon-donbu {
    0% {
        color: #fcca6b;
        text-shadow: none;
    }

    50% {
        color: #ffe0a0;
        text-shadow:
            0 0 10px #d4a052,
            0 0 20px #d4a052;
    }

    100% {
        color: #fcca6b;
        text-shadow: none;
    }
}

/* Kira - paleta teal/púrpura */
.personaje-kira {
    border-color: #1a5a5a;
    background-color: #0a2020;
}

.personaje-kira:hover {
    border-color: #2ec4b6;
}

.personaje-kira h3 {
    color: #5eeadb;
}

.personaje-kira .avatar img {
    border-color: #2ec4b6;
}

.personaje-kira.seleccionado {
    border-color: #5eeadb;
    box-shadow:
        0 0 30px rgb(94 234 219 / 70%),
        0 0 60px rgb(46 196 182 / 30%);
    background-color: #102a2a;
}

.personaje-kira.seleccionado h3 {
    animation: neon-kira 1.5s ease-in-out infinite;
}

@keyframes neon-kira {
    0% {
        color: #5eeadb;
        text-shadow: none;
    }

    50% {
        color: #a0fff0;
        text-shadow:
            0 0 10px #2ec4b6,
            0 0 20px #2ec4b6;
    }

    100% {
        color: #5eeadb;
        text-shadow: none;
    }
}

/* PandaJuro - paleta azul con rojo */
.personaje-pandajuro {
    border-color: #1a3a6b;
    background-color: #0a1430;
}

.personaje-pandajuro:hover {
    border-color: #3498db;
}

.personaje-pandajuro h3 {
    color: #6bb5fc;
}

.personaje-pandajuro .avatar img {
    border-color: #c0392b;
}

.personaje-pandajuro.seleccionado {
    border-color: #6bb5fc;
    box-shadow:
        0 0 30px rgb(107 181 252 / 70%),
        0 0 60px rgb(192 57 43 / 40%);
    background-color: #151035;
}

.personaje-pandajuro.seleccionado h3 {
    animation: neon-pandajuro 1.5s ease-in-out infinite;
}

@keyframes neon-pandajuro {
    0% {
        color: #6bb5fc;
        text-shadow: none;
    }

    50% {
        color: #ff6b6b;
        text-shadow:
            0 0 10px #c0392b,
            0 0 20px #3498db;
    }

    100% {
        color: #6bb5fc;
        text-shadow: none;
    }
}

/* PomPom - paleta rosa/crema */
.personaje-pompom {
    border-color: #7a4a5a;
    background-color: #2a1520;
}

.personaje-pompom:hover {
    border-color: #f8a5c2;
}

.personaje-pompom h3 {
    color: #fcc2d7;
}

.personaje-pompom .avatar img {
    border-color: #f8a5c2;
}

.personaje-pompom.seleccionado {
    border-color: #fcc2d7;
    box-shadow:
        0 0 30px rgb(252 194 215 / 70%),
        0 0 60px rgb(248 165 194 / 30%);
    background-color: #351a28;
}

.personaje-pompom.seleccionado h3 {
    animation: neon-pompom 1.5s ease-in-out infinite;
}

@keyframes neon-pompom {
    0% {
        color: #fcc2d7;
        text-shadow: none;
    }

    50% {
        color: #ffe0ec;
        text-shadow:
            0 0 10px #f8a5c2,
            0 0 20px #f8a5c2;
    }

    100% {
        color: #fcc2d7;
        text-shadow: none;
    }
}

/* Orejas - paleta naranja/tierra */
.personaje-orejas {
    border-color: #6b3a0a;
    background-color: #2a1505;
}

.personaje-orejas:hover {
    border-color: #e67e22;
}

.personaje-orejas h3 {
    color: #f0a04b;
}

.personaje-orejas .avatar img {
    border-color: #e67e22;
}

.personaje-orejas.seleccionado {
    border-color: #f0a04b;
    box-shadow:
        0 0 30px rgb(240 160 75 / 70%),
        0 0 60px rgb(230 126 34 / 30%);
    background-color: #352010;
}

.personaje-orejas.seleccionado h3 {
    animation: neon-orejas 1.5s ease-in-out infinite;
}

@keyframes neon-orejas {
    0% {
        color: #f0a04b;
        text-shadow: none;
    }

    50% {
        color: #ffcc80;
        text-shadow:
            0 0 10px #e67e22,
            0 0 20px #e67e22;
    }

    100% {
        color: #f0a04b;
        text-shadow: none;
    }
}

.personaje h3 {
    font-family: var(--font-display);
    color: var(--color-accent);
    margin: 5px 0;
    font-size: 1.3rem;
}

.descripcion {
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* --- Stats del personaje en la tarjeta --- */

.stats {
    text-align: left;
    border-top: 1px solid rgb(255 255 255 / 8%);
    padding-top: 10px;
    margin-top: 4px;
}

.stat-label {
    display: block;
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: #9898b0;
    margin-bottom: 4px;
}

/* Barra de vida */
.stat-vida {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vida .stat-label {
    grid-column: 1 / -1;
}

.barra-vida-fondo {
    height: 6px;
    background-color: rgb(255 255 255 / 8%);
    border-radius: 3px;
    overflow: hidden;
}

.barra-vida-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e94560, #ff6b81);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-valor {
    font-size: 0.8rem;
    font-weight: bold;
    color: #ccc;
}

/* Barra de velocidad */
.stat-velocidad {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-velocidad .stat-label {
    grid-column: 1 / -1;
}

.barra-velocidad-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #f59e0b, #fbbf24);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-vel-ataque {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vel-ataque .stat-label {
    grid-column: 1 / -1;
}

.barra-vel-ataque-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e05a8a, #f472b6);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

/* Ataques */
.stat-atributos {
    margin-top: 6px;
    margin-bottom: 12px;
}

.stat-atributos .tier-badge {
    position: static;
}

.stat-ataques {
    margin-top: 12px;
}

.ataque {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 3px 0;
}

.ataque-nombre {
    font-size: 0.75rem;
    color: #b0b0c0;
}

.ataque-dano {
    font-size: 0.75rem;
    font-weight: bold;
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 12%);
    padding: 1px 6px;
    border-radius: var(--radio-boton);
}

/* Colores de barra de vida por personaje */
.personaje-lina .barra-vida-relleno {
    background: linear-gradient(90deg, #9b59b6, #bb86fc);
}

.personaje-lina .ataque-dano {
    color: #bb86fc;
    background-color: rgb(155 89 182 / 15%);
}

.personaje-rose .barra-vida-relleno {
    background: linear-gradient(90deg, #2ecc71, #6bfc86);
}

.personaje-rose .ataque-dano {
    color: #6bfc86;
    background-color: rgb(46 204 113 / 15%);
}

.personaje-hana .barra-vida-relleno {
    background: linear-gradient(90deg, #e91e90, #fc86d4);
}

.personaje-hana .ataque-dano {
    color: #fc86d4;
    background-color: rgb(233 30 144 / 15%);
}

.personaje-kira .barra-vida-relleno {
    background: linear-gradient(90deg, #2ec4b6, #5eeadb);
}

.personaje-kira .ataque-dano {
    color: #5eeadb;
    background-color: rgb(46 196 182 / 15%);
}

.personaje-donbu .barra-vida-relleno {
    background: linear-gradient(90deg, #d4a052, #fcca6b);
}

.personaje-donbu .ataque-dano {
    color: #fcca6b;
    background-color: rgb(212 160 82 / 15%);
}

.personaje-pompom .barra-vida-relleno {
    background: linear-gradient(90deg, #f8a5c2, #fcc2d7);
}

.personaje-pompom .ataque-dano {
    color: #fcc2d7;
    background-color: rgb(248 165 194 / 15%);
}

.personaje-orejas .barra-vida-relleno {
    background: linear-gradient(90deg, #e67e22, #f0a04b);
}

.personaje-orejas .ataque-dano {
    color: #f0a04b;
    background-color: rgb(230 126 34 / 15%);
}

.personaje-pandajuro .barra-vida-relleno {
    background: linear-gradient(90deg, #c0392b, #6bb5fc);
}

.personaje-pandajuro .ataque-dano {
    color: #6bb5fc;
    background-color: rgb(107 181 252 / 15%);
}

/* --- Sección de villanos --- */

.titulo-villanos {
    font-family: var(--font-display);
    color: var(--color-accent);
    font-size: 1.4rem;
    margin-top: 40px;
    margin-bottom: 5px;
    text-shadow: 0 0 10px rgb(233 69 96 / 40%);
}

.villanos {
    display: flex;
    gap: 20px;
    margin: 15px 0;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding: 10px 20px;
    scroll-padding: 20px;
    scrollbar-width: none;
}

.villanos::-webkit-scrollbar {
    display: none;
}

.villano {
    position: relative;
    background-color: var(--color-superficie);
    border: 3px solid var(--color-borde);
    border-radius: var(--radio-tarjeta);
    padding: 20px;
    width: 200px;
    cursor: default;
    flex-shrink: 0;
    scroll-snap-align: center;
    opacity: 0.75;
    transition: opacity 0.3s;
}

.villano:hover {
    opacity: 1;
}

/* Badge de tier */
.tier-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 0.6rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    padding: 2px 8px;
    border-radius: 20px;
    line-height: 1.4;
}

.tier-esbirro {
    background-color: rgb(80 80 80 / 40%);
    color: #aaa;
}

.tier-terror {
    background-color: rgb(168 85 247 / 20%);
    color: #c084fc;
}

.tier-pesadilla {
    background-color: rgb(239 68 68 / 20%);
    color: #f87171;
}

.tier-leyenda {
    background-color: rgb(245 158 11 / 20%);
    color: #fbbf24;
}

.villano h3 {
    font-family: var(--font-display);
    color: #999;
    margin: 5px 0;
    font-size: 1.3rem;
}

.villano .descripcion {
    font-size: 0.85rem;
    color: #777;
}

.avatar-emoji {
    font-size: 4rem;
    display: block;
    line-height: 1;
}

/* Siniestra — rojo/negro */
.villano-siniestra {
    --v-color: #f44;
    --v-oscuro: #8b0000;
    --v-glow: rgb(255 50 50 / 40%);
    --v-tenue: rgb(255 68 68 / 12%);

    border-color: #4a0a0a;
    background-color: #1a0808;
}

.villano-siniestra h3 {
    color: #f44;
}

.villano-siniestra .avatar img {
    border-color: #8b0000;
    box-shadow: 0 0 10px rgb(255 50 50 / 40%);
}

.villano-siniestra .barra-vida-relleno {
    background: linear-gradient(90deg, #8b0000, #f44);
}

.villano-siniestra .ataque-dano {
    color: #f44;
    background-color: rgb(255 68 68 / 15%);
}

/* Trasgo — negro/gris */
.villano-trasgo {
    --v-color: #888;
    --v-oscuro: #555;
    --v-glow: rgb(150 150 150 / 30%);
    --v-tenue: rgb(150 150 150 / 12%);

    border-color: #333;
    background-color: #111118;
}

.villano-trasgo h3 {
    color: #888;
}

.villano-trasgo .avatar img {
    border-color: #555;
    box-shadow: 0 0 8px rgb(150 150 150 / 30%);
}

.villano-trasgo .barra-vida-relleno {
    background: linear-gradient(90deg, #444, #888);
}

.villano-trasgo .ataque-dano {
    color: #999;
    background-color: rgb(150 150 150 / 15%);
}

/* El Profano — azul/negro */
.villano-profano {
    --v-color: #48c;
    --v-oscuro: #1a3a6b;
    --v-glow: rgb(50 100 200 / 40%);
    --v-tenue: rgb(68 136 204 / 12%);

    border-color: #0a1a3a;
    background-color: #080e1a;
}

.villano-profano h3 {
    color: #48c;
}

.villano-profano .avatar img {
    border-color: #1a3a6b;
    box-shadow: 0 0 10px rgb(50 100 200 / 40%);
}

.villano-profano .barra-vida-relleno {
    background: linear-gradient(90deg, #1a2a4a, #48c);
}

.villano-profano .ataque-dano {
    color: #48c;
    background-color: rgb(68 136 204 / 15%);
}

/* El Errante — verde/negro */
.villano-errante {
    --v-color: #4c4;
    --v-oscuro: #2a6b2a;
    --v-glow: rgb(50 200 50 / 40%);
    --v-tenue: rgb(68 204 68 / 12%);

    border-color: #0a4a0a;
    background-color: #081a08;
}

.villano-errante h3 {
    color: #4c4;
}

.villano-errante .avatar img {
    border-color: #2a6b2a;
    box-shadow: 0 0 10px rgb(50 200 50 / 40%);
}

.villano-errante .barra-vida-relleno {
    background: linear-gradient(90deg, #1a6b1a, #4c4);
}

.villano-errante .ataque-dano {
    color: #4c4;
    background-color: rgb(68 204 68 / 15%);
}

/* --- Overlay de empezar (sobre tarjeta seleccionada) --- */

.seleccion-overlay {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgb(0 0 0 / 50%), rgb(0 0 0 / 75%));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
    animation: aparecer-overlay 0.3s ease;
    cursor: pointer;
}

@keyframes aparecer-overlay {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

.btn-empezar {
    font-family: var(--font-display);
    padding: 12px 30px;
    font-size: 1.1rem;
    font-weight: bold;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    background-color: var(--color-accent);
    color: white;
    box-shadow: 0 0 20px rgb(233 69 96 / 60%);
    position: relative;
    transition: background-color 0.2s;
}

/* Glow animado GPU-composited */
.btn-empezar::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    box-shadow:
        0 0 35px rgb(233 69 96 / 90%),
        0 0 60px rgb(233 69 96 / 30%);
    animation: pulso-opacity 1.5s ease-in-out infinite;
    pointer-events: none;
}

.btn-empezar:hover {
    background-color: var(--color-accent-hover);
    box-shadow: 0 0 30px rgb(233 69 96 / 80%);
}

/* --- Modal de detalle de personaje --- */

#modal-personaje {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-personaje-contenido {
    position: relative;
    background-color: var(--color-superficie);
    border: 2px solid rgb(255 255 255 / 12%);
    border-radius: var(--radio-tarjeta);
    padding: 28px 32px 24px;
    text-align: center;
    box-shadow: 0 0 40px rgb(0 0 0 / 50%);
    animation: modal-aparecer 0.3s ease;
    max-width: min(340px, 90vw);
    height: min(520px, 80vh);
    display: flex;
    flex-direction: column;
}

.modal-personaje-contenido .avatar img {
    width: 130px;
    height: 130px;
}

.modal-personaje-contenido h3 {
    font-family: var(--font-display);
    font-size: 1.5rem;
    margin: 8px 0 4px;
}

.modal-personaje-contenido .descripcion {
    margin-bottom: 12px;
    display: block;
    -webkit-line-clamp: unset;
    white-space: pre-line;
}

/* --- Tabs en modal de personaje --- */

.modal-personaje-tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 10px;
}

.modal-personaje-tab {
    background: none;
    border: none;
    border-bottom: 2px solid transparent;
    color: rgb(180 165 140 / 50%);
    font-family: var(--font-display);
    font-size: 0.8rem;
    padding: 4px 14px;
    cursor: pointer;
    letter-spacing: 0.05em;
    transition:
        color 0.2s,
        border-color 0.2s;
}

.modal-personaje-tab:hover {
    color: rgb(200 185 160);
}

.modal-personaje-tab-activo {
    color: var(--p-color, var(--color-accent));
    border-bottom-color: var(--p-color, var(--color-accent));
}

.modal-personaje-paneles {
    display: grid;
    grid-template-rows: 1fr;
    flex: 1;
    min-height: 0;
}

.modal-personaje-panel {
    grid-area: 1 / 1;
    visibility: hidden;
    opacity: 0;
    overflow-y: auto;
    padding-right: 8px;
    scrollbar-width: thin;
    scrollbar-color: var(--p-color, rgb(255 255 255 / 20%)) transparent;
}

.modal-personaje-panel::-webkit-scrollbar {
    width: 5px;
}

.modal-personaje-panel::-webkit-scrollbar-track {
    background: transparent;
}

.modal-personaje-panel::-webkit-scrollbar-thumb {
    background: var(--p-color, rgb(255 255 255 / 20%));
    border-radius: 4px;
}

.modal-personaje-panel::-webkit-scrollbar-thumb:hover {
    background: rgb(255 255 255 / 35%);
}

.modal-personaje-panel-activo {
    visibility: visible;
    opacity: 1;
    animation: modal-panel-entrada 0.25s ease;
}

@keyframes modal-panel-entrada {
    from {
        opacity: 0;
        transform: translateY(4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-personaje-descripcion {
    font-size: 0.95rem;
    line-height: 1.6;
    color: rgb(210 195 170);
    font-style: italic;
    text-align: left;
    padding: 4px 0;
    white-space: pre-line;
}

.modal-personaje-botones {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 16px;
}

.btn-cerrar-modal {
    padding: 10px 30px;
    font-size: 1rem;
    border: 2px solid var(--color-borde-claro);
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: transparent;
    color: #888;
    transition:
        border-color 0.3s,
        color 0.3s;
}

.btn-cerrar-modal:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
}

/* --- Pantalla del pasillo --- */

#pantalla-juego {
    display: flex;
    flex-direction: column;
    align-items: center;
}

#pasillo {
    position: relative;
    width: min(400px, 90vw);
    aspect-ratio: 2 / 3;
    touch-action: none;
    contain: layout paint;
    background:
        repeating-conic-gradient(#1a1a28 0% 25%, #15152a 0% 50%) 0 0 / 50px 50px,
        radial-gradient(ellipse at 50% 60%, rgb(80 50 20 / 30%) 0%, transparent 60%),
        var(--color-oscuro);
    border-left: 18px solid transparent;
    border-right: 18px solid transparent;
    border-image: repeating-linear-gradient(
            180deg,
            #2a1a0a 0,
            #3d2815 8px,
            #1a0f05 8px,
            #2a1a0a 16px
        )
        18;
    box-shadow:
        inset 0 0 80px rgb(0 0 0 / 80%),
        inset 0 0 30px rgb(0 0 0 / 50%),
        0 0 20px rgb(0 0 0 / 60%);
    overflow: hidden;
    animation: parpadeo-luz 6s ease-in-out infinite;
}

/* Capas de niebla */
.niebla-capa {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 7;
}

.niebla-capa-1 {
    background:
        radial-gradient(ellipse at 25% 25%, rgb(120 90 160 / 22%) 0%, transparent 55%),
        radial-gradient(ellipse at 75% 65%, rgb(120 90 160 / 18%) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 80%, rgb(100 80 140 / 12%) 0%, transparent 60%);
    animation: niebla-1 8s ease-in-out infinite alternate;
}

.niebla-capa-2 {
    background:
        radial-gradient(ellipse at 65% 35%, rgb(90 70 130 / 18%) 0%, transparent 50%),
        radial-gradient(ellipse at 15% 75%, rgb(100 80 140 / 15%) 0%, transparent 45%),
        radial-gradient(ellipse at 80% 90%, rgb(80 60 120 / 10%) 0%, transparent 50%);
    animation: niebla-2 12s ease-in-out infinite alternate-reverse;
}

@keyframes niebla-1 {
    0% {
        opacity: 0.5;
        transform: translateX(-8px) translateY(2px);
    }

    100% {
        opacity: 1;
        transform: translateX(8px) translateY(-2px);
    }
}

@keyframes niebla-2 {
    0% {
        opacity: 0.4;
        transform: translateX(6px) translateY(-3px);
    }

    100% {
        opacity: 0.9;
        transform: translateX(-6px) translateY(3px);
    }
}

@keyframes parpadeo-luz {
    0%,
    90%,
    100% {
        opacity: 1;
    }

    92% {
        opacity: 0.7;
    }

    94% {
        opacity: 1;
    }

    96% {
        opacity: 0.6;
    }

    98% {
        opacity: 0.9;
    }
}

/* --- Decoración del pasillo --- */

/* Ventana gótica al fondo */
.pasillo-ventana {
    position: absolute;
    top: 3%;
    left: 50%;
    transform: translateX(-50%);
    width: 22%;
    height: 12%;
    border-radius: 50% 50% 4px 4px;
    border: 3px solid #3a2a1a;
    overflow: hidden;
    box-shadow:
        inset 0 0 10px rgb(0 0 0 / 60%),
        0 0 12px rgb(0 0 0 / 50%);
    pointer-events: none;
    z-index: 1;
}

.ventana-cielo {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #0a0a2a 0%, #1a1a4a 60%, #2a2a5a 100%);
    position: relative;
}

.ventana-luna {
    position: absolute;
    top: 18%;
    right: 20%;
    width: 28%;
    aspect-ratio: 1;
    border-radius: 50%;
    background: radial-gradient(circle at 40% 40%, #fffde8 0%, #e8d88a 60%, #c8b86a 100%);
    box-shadow:
        0 0 8px rgb(255 253 232 / 60%),
        0 0 20px rgb(255 253 232 / 25%);
    animation: luna-pulso 4s ease-in-out infinite;
}

@keyframes luna-pulso {
    0%,
    100% {
        box-shadow:
            0 0 8px rgb(255 253 232 / 60%),
            0 0 20px rgb(255 253 232 / 25%);
    }

    50% {
        box-shadow:
            0 0 12px rgb(255 253 232 / 80%),
            0 0 30px rgb(255 253 232 / 35%);
    }
}

.ventana-estrella {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #fff;
    border-radius: 50%;
    animation: estrella-titilar 2s ease-in-out infinite;
}

.ventana-estrella-1 {
    top: 20%;
    left: 15%;
}

.ventana-estrella-2 {
    top: 40%;
    left: 35%;
    animation-delay: 0.7s;
}

.ventana-estrella-3 {
    top: 15%;
    left: 55%;
    animation-delay: 1.3s;
}

@keyframes estrella-titilar {
    0%,
    100% {
        opacity: 0.3;
    }

    50% {
        opacity: 1;
    }
}

/* Telarañas en esquinas superiores — SVG con hilos y anillos */
.telarana {
    position: absolute;
    top: 0;
    width: 28%;
    height: 28%;
    pointer-events: none;
    z-index: 2;
    background-size: 100% 100%;
    background-repeat: no-repeat;
}

.telarana-izq {
    left: 0;
    background-image: url('assets/img/pasillo/telarana-izq.svg');
}

.telarana-der {
    right: 0;
    background-image: url('assets/img/pasillo/telarana-der.svg');
}

/* Alfombra central */
.pasillo-alfombra {
    position: absolute;
    top: 18%;
    left: 30%;
    width: 40%;
    height: 80%;
    background:
        repeating-linear-gradient(
            45deg,
            rgb(120 30 30 / 12%) 0,
            rgb(120 30 30 / 12%) 1px,
            transparent 1px,
            transparent 8px
        ),
        repeating-linear-gradient(
            -45deg,
            rgb(120 30 30 / 12%) 0,
            rgb(120 30 30 / 12%) 1px,
            transparent 1px,
            transparent 8px
        ),
        linear-gradient(
            180deg,
            rgb(80 20 20 / 20%) 0%,
            rgb(60 15 15 / 30%) 50%,
            rgb(80 20 20 / 20%) 100%
        );
    border-left: 2px solid rgb(100 30 30 / 20%);
    border-right: 2px solid rgb(100 30 30 / 20%);
    pointer-events: none;
    z-index: 0;
}

/* Cuadros siniestros mejorados */
.deco-cuadro {
    position: absolute;
    pointer-events: none;
    z-index: 1;
}

.cuadro-marco {
    width: 100%;
    height: 100%;
    border: 3px solid #6a5a30;
    border-radius: 2px;
    overflow: hidden;
    box-shadow:
        0 2px 8px rgb(0 0 0 / 70%),
        0 0 3px rgb(100 70 30 / 30%),
        inset 0 0 6px rgb(100 80 30 / 20%);
    position: relative;
}

/* Brillo inquietante periódico en los cuadros */
.cuadro-marco::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 50% 50%, rgb(200 50 30 / 15%) 0%, transparent 70%);
    opacity: 0;
    animation: cuadro-inquietante 8s ease-in-out infinite;
}

@keyframes cuadro-inquietante {
    0%,
    85%,
    100% {
        opacity: 0;
    }

    90% {
        opacity: 1;
    }
}

.cuadro-marco img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.7);
}

.deco-cuadro-izq {
    left: 2%;
    top: 45.3%;
    width: 13.75%;
    height: 7.5%;
    transform: rotate(-2deg);
}

.deco-cuadro-der {
    right: 2%;
    top: 46.3%;
    width: 14.5%;
    height: 7%;
    transform: rotate(2deg);
}

/* Antorchas animadas */
.antorcha {
    position: absolute;
    width: 5%;
    height: 8%;
    pointer-events: none;
    z-index: 2;
}

.antorcha-soporte {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 30%;
    height: 55%;
    background: linear-gradient(180deg, #5a3a1a 0%, #3a2510 100%);
    border-radius: 2px;
}

.antorcha-llama {
    position: absolute;
    top: 5%;
    left: 50%;
    transform: translateX(-50%);
    width: 55%;
    aspect-ratio: 3 / 4;
    background: radial-gradient(
        ellipse at 50% 60%,
        #ffd54f 0%,
        #ff9800 40%,
        #e65100 70%,
        transparent 100%
    );
    border-radius: 50% 50% 40% 40%;
    animation: llama-parpadeo 0.4s ease-in-out infinite alternate;
    will-change: transform;
}

.antorcha-luz {
    position: absolute;
    top: -30%;
    left: -100%;
    width: 300%;
    height: 200%;
    background: radial-gradient(ellipse at 50% 40%, rgb(255 180 50 / 8%) 0%, transparent 60%);
    animation: llama-luz 2s ease-in-out infinite alternate;
    pointer-events: none;
}

@keyframes llama-parpadeo {
    0% {
        transform: translateX(-50%) scaleY(1) scaleX(1);
        opacity: 0.9;
    }

    100% {
        transform: translateX(-50%) scaleY(1.15) scaleX(0.9);
        opacity: 1;
    }
}

@keyframes llama-luz {
    0% {
        opacity: 0.6;
    }

    100% {
        opacity: 1;
    }
}

/* Posiciones de antorchas (par superior flanqueando la ventana) */
.antorcha-izq.antorcha-1 {
    left: 6%;
    top: 12%;
    animation-delay: 0.1s;
}

.antorcha-der.antorcha-2 {
    right: 6%;
    top: 12%;
}

.antorcha-2 .antorcha-llama {
    animation-delay: 0.15s;
}

/* Partículas de polvo flotante */
.polvo {
    position: absolute;
    width: 2px;
    height: 2px;
    background: rgb(200 180 150 / 40%);
    border-radius: 50%;
    pointer-events: none;
    z-index: 6;
    animation: polvo-flotar var(--polvo-duracion, 10s) ease-in-out infinite;
    will-change: transform;
}

@keyframes polvo-flotar {
    0%,
    100% {
        opacity: 0;
        transform: translateY(0);
    }

    20% {
        opacity: 0.6;
    }

    50% {
        opacity: 0.4;
    }

    80% {
        opacity: 0.6;
    }

    90% {
        opacity: 0;
        transform: translateY(-40px);
    }
}

.polvo-1 {
    left: 15%;
    top: 30%;

    --polvo-duracion: 9s;
}

.polvo-2 {
    left: 70%;
    top: 50%;

    --polvo-duracion: 12s;

    animation-delay: 1.5s;
}

.polvo-3 {
    left: 40%;
    top: 20%;

    --polvo-duracion: 11s;

    animation-delay: 3s;
    width: 3px;
    height: 3px;
}

.polvo-4 {
    left: 85%;
    top: 65%;

    --polvo-duracion: 13s;

    animation-delay: 4.5s;
}

.polvo-5 {
    left: 25%;
    top: 75%;

    --polvo-duracion: 10s;

    animation-delay: 2s;
}

.polvo-6 {
    left: 55%;
    top: 35%;

    --polvo-duracion: 14s;

    animation-delay: 6s;
    width: 3px;
    height: 3px;
}

.polvo-7 {
    left: 80%;
    top: 15%;

    --polvo-duracion: 15s;

    animation-delay: 7s;
}

.polvo-8 {
    left: 10%;
    top: 55%;

    --polvo-duracion: 11s;

    animation-delay: 5s;
}

.polvo-9 {
    left: 48%;
    top: 60%;

    --polvo-duracion: 10s;

    animation-delay: 1s;
    width: 3px;
    height: 3px;
}

.polvo-10 {
    left: 92%;
    top: 40%;

    --polvo-duracion: 13s;

    animation-delay: 3.5s;
}

.polvo-11 {
    left: 33%;
    top: 85%;

    --polvo-duracion: 9s;

    animation-delay: 8s;
    width: 3px;
    height: 3px;
}

.polvo-12 {
    left: 65%;
    top: 10%;

    --polvo-duracion: 12s;

    animation-delay: 2.5s;
}

.polvo-13 {
    left: 20%;
    top: 45%;

    --polvo-duracion: 14s;

    animation-delay: 9s;
    width: 3px;
    height: 3px;
}

.polvo-14 {
    left: 75%;
    top: 75%;

    --polvo-duracion: 11s;

    animation-delay: 6.5s;
}

/* --- Puertas con personalidad --- */

/* Variables de color por puerta */
.puerta-1 {
    --puerta-accent: #bb86fc;
    --puerta-accent-rgb: 187 134 252;
    --puerta-marco: #4a3a5a;

    top: 58%;
}

.puerta-2 {
    --puerta-accent: #6bfc86;
    --puerta-accent-rgb: 107 252 134;
    --puerta-marco: #2a4a32;

    top: 58%;
}

.puerta-3 {
    --puerta-accent: #e94560;
    --puerta-accent-rgb: 233 69 96;
    --puerta-marco: #5a2a2a;

    top: 22%;
}

.puerta-4 {
    --puerta-accent: #5eeadb;
    --puerta-accent-rgb: 94 234 219;
    --puerta-marco: #1a3a4a;

    top: 22%;
}

.puerta {
    position: absolute;
    width: 17%;
    height: 17%;
    cursor: pointer;
    z-index: 3;
    display: flex;
    align-items: center;
    justify-content: center;
}

.puerta-marco {
    width: 100%;
    height: 100%;
    background: var(--puerta-marco);
    border-radius: 6px 6px 0 0;
    padding: 3px;
    box-shadow:
        inset 0 0 8px rgb(0 0 0 / 40%),
        0 2px 6px rgb(0 0 0 / 50%);
    overflow: hidden;
}

.puerta-hoja {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #3d2815 0%, #2a1a0a 40%, #1f1208 100%);
    border-radius: 4px 4px 0 0;
    position: relative;
    transition:
        transform 0.4s ease,
        box-shadow 0.3s;
    transform-origin: left center;
    will-change: transform;
}

.puerta-detalle {
    position: absolute;
    inset: 15% 10%;
    border-radius: 2px;
    opacity: 0.3;
    pointer-events: none;
}

/* Puerta 1 — patrón de laberinto */
.puerta-1 .puerta-detalle {
    background:
        repeating-linear-gradient(
            0deg,
            rgb(187 134 252 / 20%) 0,
            rgb(187 134 252 / 20%) 1px,
            transparent 1px,
            transparent 6px
        ),
        repeating-linear-gradient(
            90deg,
            rgb(187 134 252 / 20%) 0,
            rgb(187 134 252 / 20%) 1px,
            transparent 1px,
            transparent 6px
        );
}

.puerta-1 .puerta-marco {
    border-radius: 12px 12px 0 0;
}

/* Puerta 2 — patrón geométrico neón */
.puerta-2 .puerta-marco {
    background: #1a2a1e;
    border: 1px solid rgb(107 252 134 / 30%);
}

.puerta-2 .puerta-hoja {
    background: linear-gradient(180deg, #1a2a20 0%, #0f1a14 40%, #0a1210 100%);
}

.puerta-2 .puerta-detalle {
    background:
        repeating-linear-gradient(
            60deg,
            rgb(107 252 134 / 15%) 0,
            rgb(107 252 134 / 15%) 1px,
            transparent 1px,
            transparent 8px
        ),
        repeating-linear-gradient(
            -60deg,
            rgb(107 252 134 / 15%) 0,
            rgb(107 252 134 / 15%) 1px,
            transparent 1px,
            transparent 8px
        );
}

/* Puerta 3 — resplandor de fuego */
.puerta-3 .puerta-detalle {
    background: linear-gradient(0deg, rgb(233 69 96 / 25%) 0%, transparent 60%);
    animation: fuego-puerta 2s ease-in-out infinite alternate;
}

@keyframes fuego-puerta {
    0% {
        inset: 40% 10% 15%;
    }

    100% {
        inset: 30% 10% 15%;
    }
}

.puerta-3 .puerta-marco {
    background: repeating-linear-gradient(180deg, #5a2a2a 0, #4a2020 3px, #3a1818 3px, #5a2a2a 6px);
}

/* Puerta 4 — ondas de agua */
.puerta-4 .puerta-marco {
    background: #1a2a33;
}

.puerta-4 .puerta-detalle {
    background: repeating-linear-gradient(
        0deg,
        rgb(94 234 219 / 10%) 0,
        rgb(94 234 219 / 10%) 2px,
        transparent 2px,
        transparent 6px
    );
    animation: agua-puerta 3s linear infinite;
}

@keyframes agua-puerta {
    0% {
        transform: translateY(0);
    }

    100% {
        transform: translateY(6px);
    }
}

.puerta-tirador {
    position: absolute;
    width: 6px;
    height: 6px;
    background: #8a7a60;
    border-radius: 50%;
    right: 15%;
    top: 50%;
    box-shadow: 0 0 3px rgb(200 180 120 / 40%);
}

.puerta-brillo {
    position: absolute;
    inset: -4px;
    border-radius: 8px 8px 0 0;
    box-shadow: 0 0 12px rgb(var(--puerta-accent-rgb) / 25%);
    animation: respiracion-puerta 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes respiracion-puerta {
    0%,
    100% {
        opacity: 0.3;
    }

    50% {
        opacity: 0.8;
    }
}

.puerta-numero {
    position: absolute;
    bottom: -22px;
    left: 50%;
    transform: translateX(-50%);
    font-family: var(--font-display);
    font-size: 1.1rem;
    font-weight: bold;
    color: rgb(var(--puerta-accent-rgb) / 60%);
    text-shadow: 0 0 5px rgb(var(--puerta-accent-rgb) / 30%);
    pointer-events: none;
}

/* Posiciones de las puertas */
.puerta-izquierda {
    left: 2%;
}

.puerta-derecha {
    right: 2%;
}

/* --- Sistema de proximidad --- */

.puerta-cerca .puerta-hoja {
    transform: perspective(200px) rotateY(-8deg);
    box-shadow: inset 0 0 10px rgb(0 0 0 / 30%);
}

.puerta-cerca .puerta-brillo {
    box-shadow:
        0 0 16px rgb(var(--puerta-accent-rgb) / 40%),
        0 0 30px rgb(var(--puerta-accent-rgb) / 15%);
    animation-duration: 1.5s;
}

.puerta-cerca .puerta-numero {
    color: var(--puerta-accent);
    text-shadow: 0 0 8px rgb(var(--puerta-accent-rgb) / 50%);
}

@media (hover: hover) and (pointer: fine) {
    .puerta-cerca:hover .puerta-hoja {
        transform: perspective(200px) rotateY(-12deg);
    }

    .puerta-cerca:hover .puerta-brillo {
        box-shadow:
            0 0 22px rgb(var(--puerta-accent-rgb) / 50%),
            0 0 40px rgb(var(--puerta-accent-rgb) / 25%);
    }
}

/* --- Personaje jugador --- */

#personaje-jugador {
    position: absolute;
    width: 12.5%;
    aspect-ratio: 1;
    z-index: 9;
    contain: layout style;
}

.jugador-luz {
    position: absolute;
    inset: -80%;
    background: radial-gradient(ellipse at 50% 50%, rgb(255 220 150 / 8%) 0%, transparent 60%);
    pointer-events: none;
}

.jugador-sombra {
    position: absolute;
    bottom: -15%;
    left: 10%;
    width: 80%;
    height: 30%;
    background: radial-gradient(ellipse at 50% 50%, rgb(0 0 0 / 40%) 0%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
    transition: transform 0.15s;
}

#personaje-jugador img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
    box-shadow: 0 0 10px rgb(0 0 0 / 60%);
    position: relative;
    will-change: transform;
}

/* Animación de caminar */
#personaje-jugador.moviendo img {
    animation: jugador-bobbing 0.3s ease-in-out infinite alternate;
}

@keyframes jugador-bobbing {
    0% {
        transform: translateY(0);
    }

    100% {
        transform: translateY(-2px);
    }
}

/* Brillo del personaje según selección */
#personaje-jugador.jugador-lina img {
    border-color: #9b59b6;
    box-shadow: 0 0 12px rgb(155 89 182 / 50%);
}

#personaje-jugador.jugador-rose img {
    border-color: #2ecc71;
    box-shadow: 0 0 12px rgb(46 204 113 / 50%);
}

#personaje-jugador.jugador-pandajuro img {
    border-color: #c0392b;
    box-shadow: 0 0 12px rgb(192 57 43 / 50%);
}

#personaje-jugador.jugador-hana img {
    border-color: #e91e90;
    box-shadow: 0 0 12px rgb(233 30 144 / 50%);
}

#personaje-jugador.jugador-kira img {
    border-color: #2ec4b6;
    box-shadow: 0 0 12px rgb(46 196 182 / 50%);
}

#personaje-jugador.jugador-donbu img {
    border-color: #d4a052;
    box-shadow: 0 0 12px rgb(212 160 82 / 50%);
}

#personaje-jugador.jugador-pompom img {
    border-color: #f8a5c2;
    box-shadow: 0 0 12px rgb(248 165 194 / 50%);
}

#personaje-jugador.jugador-orejas img {
    border-color: #e67e22;
    box-shadow: 0 0 12px rgb(230 126 34 / 50%);
}

/* --- Controles hint --- */

#controles-hint {
    margin-top: 15px;
    font-size: 0.9rem;
    color: var(--color-texto-apagado);
    animation: parpadeo-hint 2s ease-in-out infinite;
}

@keyframes parpadeo-hint {
    0%,
    100% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }
}

/* --- Modal de confirmación --- */

#modal-puerta {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(0 0 0 / 75%);
}

.modal-contenido {
    position: relative;
    background-color: var(--color-superficie);
    border: 2px solid var(--modal-accent, var(--color-accent));
    border-radius: 15px;
    padding: 28px 32px 24px;
    text-align: center;
    box-shadow:
        0 0 40px rgb(0 0 0 / 50%),
        0 0 15px var(--modal-accent, var(--color-accent));
    animation: modal-aparecer 0.3s ease;
    max-width: min(340px, 90vw);
}

@keyframes modal-aparecer {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-puerta-linea {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    border-radius: 15px 15px 0 0;
    background: var(--modal-accent, var(--color-accent));
    box-shadow: 0 0 12px var(--modal-accent, var(--color-accent));
}

.modal-puerta-icono {
    font-size: 3rem;
    line-height: 1;
    margin: 4px 0 8px;
    filter: drop-shadow(0 0 12px var(--modal-accent, var(--color-accent)));
    animation: flotar-icono 2.5s ease-in-out infinite;
}

@keyframes flotar-icono {
    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-5px);
    }
}

.modal-puerta-nivel {
    display: inline-block;
    font-family: var(--font-body);
    font-size: 0.65rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: var(--modal-accent, var(--color-accent));
    background: rgb(255 255 255 / 6%);
    padding: 3px 12px;
    border-radius: 20px;
    margin-bottom: 4px;
}

.modal-contenido h2 {
    font-family: var(--font-display);
    color: var(--modal-accent, var(--color-accent));
    margin: 0 0 8px;
    text-shadow: 0 0 10px var(--modal-accent, var(--color-accent));
}

.modal-contenido p {
    color: #ccc;
    margin: 0 0 25px;
}

.modal-botones {
    display: flex;
    gap: 15px;
    justify-content: center;
}

#btn-entrar {
    padding: 10px 30px;
    font-size: 1rem;
    border: none;
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: var(--modal-accent, var(--color-accent));
    color: white;
    transition: filter 0.2s;
}

#btn-entrar:hover {
    filter: brightness(0.85);
}

#btn-cancelar {
    padding: 10px 30px;
    font-size: 1rem;
    border: 2px solid var(--color-borde-claro);
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: transparent;
    color: #888;
    transition:
        border-color 0.3s,
        color 0.3s;
}

#btn-cancelar:hover {
    border-color: var(--modal-accent, var(--color-accent));
    color: var(--modal-accent, var(--color-accent));
}

/* Foco de navegación con flechas */
.modal-btn-foco {
    outline: 2px solid #fff;
    outline-offset: 3px;
    animation: pulso-foco 1s ease-in-out infinite;
}

@keyframes pulso-foco {
    0%,
    100% {
        outline-color: rgb(255 255 255 / 60%);
    }

    50% {
        outline-color: rgb(255 255 255 / 100%);
    }
}

/* --- Modal de derrota --- */

.modal-derrota {
    position: absolute;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-derrota-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(10 0 0 / 85%);
    animation: derrota-fondo-aparecer 0.5s ease;
}

@keyframes derrota-fondo-aparecer {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.modal-derrota-caja {
    position: relative;
    background: linear-gradient(180deg, #1a0a0a 0%, #0d0d1a 100%);
    border: 2px solid #8b0000;
    border-radius: 12px;
    padding: 24px 32px;
    text-align: center;
    box-shadow:
        0 0 30px rgb(139 0 0 / 40%),
        inset 0 0 20px rgb(0 0 0 / 50%);
    animation: derrota-caja-aparecer 0.4s ease;
    max-width: min(280px, 85vw);
}

@keyframes derrota-caja-aparecer {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-derrota-caja h2 {
    font-family: var(--font-display);
    color: #c33;
    font-size: 1.2rem;
    margin: 0 0 6px;
    text-shadow: 0 0 12px rgb(200 50 50 / 50%);
}

.modal-derrota-caja p {
    color: #999;
    font-size: 0.85rem;
    margin: 0 0 18px;
}

.modal-derrota-icono {
    font-size: 2.5rem;
    margin-bottom: 8px;
    animation: derrota-pulso 2s ease-in-out infinite;
}

@keyframes derrota-pulso {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

.modal-derrota-btn {
    padding: 10px 28px;
    font-size: 0.9rem;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(180deg, #8b0000 0%, #5a0000 100%);
    border: 2px solid #a22;
    border-radius: 8px;
    cursor: pointer;
    text-shadow: 0 1px 2px rgb(0 0 0 / 50%);
    box-shadow: 0 2px 8px rgb(139 0 0 / 30%);
    transition:
        transform 0.15s,
        box-shadow 0.15s,
        background 0.2s;
}

.modal-derrota-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgb(139 0 0 / 50%);
    background: linear-gradient(180deg, #a11 0%, #6a0000 100%);
}

.modal-derrota-btn:active {
    transform: translateY(1px);
    box-shadow: 0 1px 4px rgb(139 0 0 / 30%);
}

/* --- Barra superior del jugador --- */

.barra-superior {
    display: flex;
    align-items: center;
    gap: 15px;
    background-color: rgb(15 15 30 / 95%);
    border: 2px solid var(--color-borde);
    border-radius: 10px;
    padding: 8px 15px;
    margin-bottom: 15px;
}

.barra-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.barra-jugador img {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
}

.barra-jugador span {
    font-size: 0.9rem;
    font-weight: bold;
    color: var(--color-texto);
}

.barra-vida-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    min-width: 100px;
}

.barra-vida-corazon {
    font-size: 0.9rem;
    animation: latido 1.2s ease-in-out infinite;
}

@keyframes latido {
    0%,
    100% {
        transform: scale(1);
    }

    15% {
        transform: scale(1.25);
    }

    30% {
        transform: scale(1);
    }
}

.barra-vida-jugador .barra-vida-fondo {
    flex: 1;
    height: 14px;
    border-radius: 7px;
    position: relative;
}

.barra-vida-jugador .barra-vida-relleno {
    border-radius: 7px;
    transition:
        transform 0.4s ease,
        background 0.4s ease;
    position: relative;
    overflow: hidden;
}

.barra-vida-jugador .barra-vida-relleno::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgb(255 255 255 / 25%) 50%,
        transparent 100%
    );
    animation: shimmer-vida 2.5s ease-in-out infinite;
}

@keyframes shimmer-vida {
    0% {
        transform: translateX(-100%);
    }

    100% {
        transform: translateX(100%);
    }
}

.barra-vida-texto {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: bold;
    color: white;
    text-shadow: 0 1px 2px rgb(0 0 0 / 60%);
    z-index: 1;
}

.barra-vida-peligro .barra-vida-corazon {
    animation: latido-rapido 0.5s ease-in-out infinite;
}

@keyframes latido-rapido {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.35);
    }
}

.barra-inventario {
    display: flex;
    align-items: center;
    gap: 5px;
    flex-shrink: 0;
}

.inventario-slot {
    width: 28px;
    height: 28px;
    border: 2px solid rgb(255 255 255 / 8%);
    border-radius: 6px;
    background-color: rgb(255 255 255 / 3%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    line-height: 1;
    transition:
        border-color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s;
}

.inventario-slot-lleno {
    border-color: var(--slot-color);
    background-color: rgb(255 255 255 / 6%);
    box-shadow:
        0 0 8px var(--slot-color),
        inset 0 0 6px rgb(0 0 0 / 30%);
    animation: slot-aparecer 0.4s ease;
}

@keyframes slot-aparecer {
    0% {
        transform: scale(0.5);
        opacity: 0;
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Colores de borde de avatar según personaje */
.barra-lina .barra-jugador img {
    border-color: #9b59b6;
}

.barra-rose .barra-jugador img {
    border-color: #2ecc71;
}

.barra-pandajuro .barra-jugador img {
    border-color: #c0392b;
}

.barra-hana .barra-jugador img {
    border-color: #e91e90;
}

.barra-kira .barra-jugador img {
    border-color: #2ec4b6;
}

.barra-donbu .barra-jugador img {
    border-color: #d4a052;
}

/* --- Habitación 1: El Laberinto --- */

/* --- Paletas por habitación --- */

.habitacion-1 {
    --hab-pared: #2a1a3e;
    --hab-pared-medio: #1a102e;
    --hab-pared-oscuro: #150d24;
    --hab-borde: rgb(100 60 150 / 20%);
    --hab-accent: #bb86fc;
}

.habitacion-2 {
    --hab-pared: #1a3e1a;
    --hab-pared-medio: #102e10;
    --hab-pared-oscuro: #0d240d;
    --hab-borde: rgb(60 150 80 / 20%);
    --hab-accent: #6bfc86;
}

.habitacion-3 {
    --hab-pared: #3e1a1a;
    --hab-pared-medio: #2e1010;
    --hab-pared-oscuro: #240d0d;
    --hab-borde: rgb(150 60 60 / 20%);
    --hab-accent: #e94560;
}

.habitacion-4 {
    --hab-pared: #1a1a3e;
    --hab-pared-medio: #10102e;
    --hab-pared-oscuro: #0d0d24;
    --hab-borde: rgb(60 80 150 / 20%);
    --hab-accent: #5eeadb;
}

#pantalla-habitacion1 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Cabecera: botón huir + título en una sola fila */
.cabecera-habitacion {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0 0 2px;
    width: 100%;
    justify-content: center;
}

.titulo-habitacion {
    font-family: var(--font-display);
    color: var(--color-accent);
    font-size: 1.3rem;
    margin: 0;
    text-shadow: 0 0 10px rgb(233 69 96 / 50%);
}

#laberinto-indicador,
#laberinto3d-indicador {
    font-size: 0.95rem;
    color: #aaa;
    margin: 2px 0 6px;
    transition:
        color 0.3s,
        text-shadow 0.3s;
}

#laberinto-indicador.llave-obtenida,
#laberinto3d-indicador.llave-obtenida {
    color: var(--color-dorado);
    text-shadow: 0 0 10px rgb(255 215 0 / 60%);
    animation: brillo-llave 1.5s ease-in-out infinite;
}

@keyframes brillo-llave {
    0%,
    100% {
        text-shadow: 0 0 10px rgb(255 215 0 / 40%);
    }

    50% {
        text-shadow:
            0 0 20px rgb(255 215 0 / 80%),
            0 0 30px rgb(255 215 0 / 30%);
    }
}

/* Contenedor del laberinto (dimensiones se setean desde JS) */
#laberinto {
    position: relative;
    background-color: var(--color-oscuro);
    touch-action: none;
    contain: layout paint;
    border: 3px solid var(--color-borde);
    border-radius: 8px;
    overflow: hidden;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%);
}

/* Paredes del laberinto */
.laberinto-pared {
    position: absolute;
    background: linear-gradient(
        135deg,
        var(--hab-pared) 0%,
        var(--hab-pared-medio) 50%,
        var(--hab-pared-oscuro) 100%
    );
    border: 1px solid var(--hab-borde);
    box-shadow: inset 0 0 6px rgb(0 0 0 / 40%);
}

/* Trampas del laberinto */
.laberinto-trampa {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    border-radius: 3px;
    background-color: rgb(80 30 30 / 25%);
    transition:
        background-color 0.2s,
        box-shadow 0.2s;
}

.laberinto-trampa::after {
    content: '🔥';
    font-size: 0.9rem;
    opacity: 0.15;
    transition: opacity 0.2s;
}

.laberinto-trampa.trampa-activa {
    background-color: rgb(200 50 30 / 45%);
    box-shadow: inset 0 0 10px rgb(255 50 30 / 50%);
}

.laberinto-trampa.trampa-activa::after {
    opacity: 1;
    animation: trampa-fuego 0.4s ease-in-out infinite alternate;
}

@keyframes trampa-fuego {
    from {
        transform: scale(1);
    }

    to {
        transform: scale(1.3);
    }
}

/* Trampas de lentitud */
.laberinto-trampa-lenta {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    border-radius: 3px;
    background-color: rgb(30 50 80 / 25%);
    transition:
        background-color 0.3s,
        box-shadow 0.3s;
}

.laberinto-trampa-lenta::after {
    content: '🕸️';
    font-size: 0.9rem;
    opacity: 0.15;
    transition: opacity 0.3s;
}

.laberinto-trampa-lenta.trampa-lenta-activa {
    background-color: rgb(80 140 220 / 35%);
    box-shadow: inset 0 0 10px rgb(100 180 255 / 40%);
}

.laberinto-trampa-lenta.trampa-lenta-activa::after {
    opacity: 1;
    animation: trampa-lenta-pulso 0.6s ease-in-out infinite alternate;
}

@keyframes trampa-lenta-pulso {
    from {
        transform: scale(1);
        filter: brightness(1);
    }

    to {
        transform: scale(1.2);
        filter: brightness(1.4);
    }
}

/* Efecto de lentitud en el jugador */
.jugador-lento img {
    filter: brightness(0.7) saturate(0.5) hue-rotate(200deg) !important;
    animation: jugador-lento-pulso 0.8s ease-in-out infinite !important;
}

@keyframes jugador-lento-pulso {
    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

/* Texto flotante de efecto */
.efecto-flotante {
    position: absolute;
    font-weight: bold;
    font-size: 0.85rem;
    z-index: 10;
    pointer-events: none;
    animation: dano-subir 1s ease-out forwards;
}

.efecto-lentitud {
    color: #7cb8ff;
    text-shadow: 0 0 6px rgb(100 180 255 / 70%);
}

/* Flash al recibir daño de trampa */
.jugador-golpeado img {
    animation: golpe-flash 0.3s ease !important;
}

@keyframes golpe-flash {
    0% {
        filter: brightness(1);
    }

    25% {
        filter: brightness(3) saturate(0);
    }

    50% {
        filter: brightness(1) sepia(1) saturate(5) hue-rotate(-30deg);
    }

    100% {
        filter: brightness(1);
    }
}

/* Número de daño flotante */
.dano-flotante {
    position: absolute;
    font-family: var(--font-display);
    color: #f44;
    font-weight: bold;
    font-size: 1.4rem;
    z-index: 10;
    pointer-events: none;
    text-shadow:
        0 0 8px rgb(255 0 0 / 80%),
        0 2px 4px rgb(0 0 0 / 50%);
    animation: dano-subir 1s ease-out forwards;
}

@keyframes dano-subir {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1.5);
    }

    30% {
        opacity: 1;
        transform: translateY(-10px) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-35px) scale(0.8);
    }
}

/* Screen shake al recibir daño */
.screen-shake {
    animation: screen-shake 0.3s ease;
}

@keyframes screen-shake {
    0%,
    100% {
        transform: translate(0);
    }

    15% {
        transform: translate(-4px, 2px);
    }

    30% {
        transform: translate(4px, -2px);
    }

    45% {
        transform: translate(-3px, -1px);
    }

    60% {
        transform: translate(3px, 1px);
    }

    75% {
        transform: translate(-1px, 2px);
    }
}

/* Viñeta roja al recibir daño */
.vineta-dano::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    box-shadow: inset 0 0 40px rgb(233 69 96 / 60%);
    pointer-events: none;
    z-index: 20;
    animation: vineta-flash 0.4s ease-out forwards;
}

@keyframes vineta-flash {
    0% {
        opacity: 1;
    }

    100% {
        opacity: 0;
    }
}

/* Trasgo (enemigo) en el laberinto */
.trasgo-laberinto {
    position: absolute;
    z-index: 4;
    transform: scale(1.6);
}

.trasgo-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #666;
    box-shadow: 0 0 8px rgb(150 150 150 / 40%);
}

/* Glow animado GPU-composited (opacity en vez de box-shadow) */
.trasgo-laberinto::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    box-shadow: 0 0 14px rgb(200 80 80 / 60%);
    animation: pulso-opacity 2s ease-in-out infinite;
    pointer-events: none;
}

/* Villano terror en el laberinto */
.terror-laberinto {
    position: absolute;
    z-index: 4;
}

.terror-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #a855f7;
    box-shadow: 0 0 8px rgb(168 85 247 / 40%);
}

/* Glow púrpura pulsante */
.terror-laberinto::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    box-shadow: 0 0 14px rgb(168 85 247 / 60%);
    animation: pulso-opacity 2s ease-in-out infinite;
    pointer-events: none;
}

/* Animación de aparición */
.terror-aparicion {
    animation: terror-spawn 0.5s ease-out;
}

@keyframes terror-spawn {
    from {
        transform: scale(0);
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* --- Countdown de amenaza: ring en esquina + borde pulsante --- */

/* Ring pequeño en esquina superior derecha */
.countdown-terror {
    position: absolute;
    top: 6px;
    right: 6px;
    z-index: 15;
    display: flex;
    flex-direction: column;
    align-items: center;
    pointer-events: none;
    animation: countdown-aparecer 0.6s ease-out;
}

@keyframes countdown-aparecer {
    from {
        opacity: 0;
        transform: scale(0.5);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

.countdown-anillo-wrap {
    position: relative;
    width: 52px;
    height: 52px;
    filter: drop-shadow(0 0 6px rgb(168 85 247 / 50%));
}

.countdown-anillo {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.countdown-pista {
    fill: none;
    stroke: rgb(168 85 247 / 15%);
    stroke-width: 6;
}

.countdown-progreso {
    fill: none;
    stroke: #a855f7;
    stroke-width: 6;
    stroke-linecap: round;
    transition:
        stroke-dashoffset 0.8s ease-in-out,
        stroke 0.5s ease;
}

.countdown-numero {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: #c084fc;
    text-shadow: 0 0 8px rgb(168 85 247 / 70%);
    transition:
        color 0.5s ease,
        text-shadow 0.5s ease;
}

.countdown-tick {
    animation: countdown-tick 0.3s ease-out;
}

@keyframes countdown-tick {
    0% {
        transform: scale(1.3);
        opacity: 0.6;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.countdown-texto {
    font-family: var(--font-body);
    font-size: 0.5rem;
    font-weight: 700;
    color: rgb(192 132 252 / 70%);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-top: 2px;
    text-shadow: 0 0 6px rgb(168 85 247 / 40%);
    transition: color 0.5s ease;
}

/* --- Borde del laberinto pulsante durante countdown --- */

.laberinto-amenaza {
    border-color: rgb(168 85 247 / 40%) !important;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%),
        0 0 12px rgb(168 85 247 / 25%),
        inset 0 0 12px rgb(168 85 247 / 10%) !important;
    animation: borde-amenaza 2s ease-in-out infinite !important;
}

@keyframes borde-amenaza {
    0%,
    100% {
        border-color: rgb(168 85 247 / 25%);
    }

    50% {
        border-color: rgb(168 85 247 / 50%);
    }
}

/* --- Estado urgente (últimos 3 segundos) --- */

.countdown-urgente .countdown-progreso {
    stroke: #ef4444;
}

.countdown-urgente .countdown-anillo-wrap {
    filter: drop-shadow(0 0 8px rgb(239 68 68 / 60%));
    animation: countdown-sacudir 0.4s ease-in-out infinite;
}

.countdown-urgente .countdown-numero {
    color: #f87171;
    text-shadow: 0 0 10px rgb(239 68 68 / 90%);
    animation: countdown-pulso-num 0.5s ease-in-out infinite;
}

.countdown-urgente .countdown-texto {
    color: rgb(248 113 113 / 90%);
}

.laberinto-amenaza-urgente {
    border-color: rgb(239 68 68 / 50%) !important;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%),
        0 0 15px rgb(239 68 68 / 35%),
        inset 0 0 15px rgb(239 68 68 / 15%) !important;
    animation: borde-amenaza-urgente 0.6s ease-in-out infinite !important;
}

@keyframes borde-amenaza-urgente {
    0%,
    100% {
        border-color: rgb(239 68 68 / 30%);
    }

    50% {
        border-color: rgb(239 68 68 / 60%);
    }
}

@keyframes countdown-sacudir {
    0%,
    100% {
        transform: translateX(0);
    }

    25% {
        transform: translateX(-2px) rotate(-1deg);
    }

    75% {
        transform: translateX(2px) rotate(1deg);
    }
}

@keyframes countdown-pulso-num {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }
}

/* Animación de salida al llegar a 0 */
.countdown-salida {
    animation: countdown-salida 0.4s ease-in forwards;
}

@keyframes countdown-salida {
    from {
        opacity: 1;
        transform: scale(1);
    }

    to {
        opacity: 0;
        transform: scale(0.3);
    }
}

/* Llave */
.laberinto-llave {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    animation: flotar-llave 2s ease-in-out infinite;
    z-index: 2;
}

@keyframes flotar-llave {
    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-4px);
    }
}

/* Animación al recoger la llave */
.laberinto-llave.llave-recogida {
    animation: absorber-llave 0.5s ease-in forwards;
    pointer-events: none;
}

@keyframes absorber-llave {
    0% {
        transform: scale(1);
        opacity: 1;
    }

    50% {
        transform: scale(1.5);
        opacity: 0.7;
    }

    100% {
        transform: scale(0);
        opacity: 0;
    }
}

/* Salida */
.laberinto-salida {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    z-index: 1;
    opacity: 0.6;
}

/* Jugador dentro del laberinto (escala visual se aplica desde JS según estatura) */
.jugador-laberinto {
    position: absolute;
    z-index: 5;
}

.jugador-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
    box-shadow: 0 0 8px rgb(0 0 0 / 60%);
}

/* Colores del jugador en el laberinto */
.jugador-laberinto.jugador-lina img {
    border-color: #9b59b6;
    box-shadow: 0 0 10px rgb(155 89 182 / 50%);
}

.jugador-laberinto.jugador-rose img {
    border-color: #2ecc71;
    box-shadow: 0 0 10px rgb(46 204 113 / 50%);
}

.jugador-laberinto.jugador-pandajuro img {
    border-color: #c0392b;
    box-shadow: 0 0 10px rgb(192 57 43 / 50%);
}

.jugador-laberinto.jugador-hana img {
    border-color: #e91e90;
    box-shadow: 0 0 10px rgb(233 30 144 / 50%);
}

.jugador-laberinto.jugador-kira img {
    border-color: #2ec4b6;
    box-shadow: 0 0 10px rgb(46 196 182 / 50%);
}

.jugador-laberinto.jugador-donbu img {
    border-color: #d4a052;
    box-shadow: 0 0 10px rgb(212 160 82 / 50%);
}

.jugador-laberinto.jugador-pompom img {
    border-color: #f8a5c2;
    box-shadow: 0 0 10px rgb(248 165 194 / 50%);
}

.jugador-laberinto.jugador-orejas img {
    border-color: #e67e22;
    box-shadow: 0 0 10px rgb(230 126 34 / 50%);
}

/* Mensaje de éxito */
#laberinto-mensaje,
#laberinto3d-mensaje {
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: #4cff4c;
    margin: 4px 0;
    text-shadow: 0 0 15px rgb(76 255 76 / 50%);
    animation: aparecer-mensaje 0.4s ease;
}

@keyframes aparecer-mensaje {
    from {
        transform: scale(0.5);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

/* Hint del laberinto */
.laberinto-hint {
    margin-top: 4px;
    font-size: 0.85rem;
    color: var(--color-texto-muy-apagado);
    animation: parpadeo-hint 2s ease-in-out infinite;
}

/* Botón huir: icono compacto en la cabecera */
.btn-huir {
    height: 32px;
    padding: 0 10px;
    border: 2px solid rgb(255 255 255 / 10%);
    border-radius: 16px;
    cursor: pointer;
    background-color: rgb(255 255 255 / 5%);
    color: #999;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
    gap: 3px;
    flex-shrink: 0;
    transition:
        border-color 0.3s,
        color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s;
}

.btn-huir:hover,
.btn-huir:active {
    border-color: var(--color-accent);
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 10%);
    box-shadow: 0 0 12px rgb(233 69 96 / 30%);
}

/* Flecha del botón huir: pulso sutil */
.btn-huir-flecha {
    display: inline-block;
    animation: pulso-huir 2s ease-in-out infinite;
}

@keyframes pulso-huir {
    0%,
    100% {
        transform: translateX(0);
        opacity: 0.7;
    }

    50% {
        transform: translateX(-2px);
        opacity: 1;
    }
}

/* --- Habitación 2: El Laberinto 3D --- */

#pantalla-habitacion2 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

#contenedor-3d {
    position: relative;
    contain: layout paint;
    border: 3px solid var(--color-borde);
    border-radius: 8px;
    overflow: hidden;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%);
}

#canvas-3d {
    display: block;
}

#canvas-minimapa {
    position: absolute;
    top: 8px;
    right: 8px;
    border: 2px solid rgb(150 100 200 / 40%);
    border-radius: 4px;
    opacity: 0.85;
}

/* --- Transiciones entre pantallas --- */

.transicion-overlay {
    position: fixed;
    inset: 0;
    z-index: 200;
    pointer-events: none;
    opacity: 0;
}

/* Fade: oscurecer a negro */
.transicion-fade-in {
    background-color: var(--color-oscuro);
    opacity: 0;
    pointer-events: all;
    animation: fade-in 0.4s ease forwards;
}

.transicion-fade-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: fade-out 0.4s ease forwards;
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes fade-out {
    from {
        opacity: 1;
    }

    to {
        opacity: 0;
    }
}

/* Wipe: cortina horizontal de izquierda a derecha */
.transicion-wipe-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-in 0.4s ease forwards;
}

.transicion-wipe-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-out 0.4s ease forwards;
}

@keyframes wipe-in {
    from {
        clip-path: inset(0 100% 0 0);
    }

    to {
        clip-path: inset(0 0 0 0);
    }
}

@keyframes wipe-out {
    from {
        clip-path: inset(0 0 0 0);
    }

    to {
        clip-path: inset(0 0 0 100%);
    }
}

/* Iris: círculo que se cierra y abre (estilo cartoon) */
.transicion-iris-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-in 0.5s ease forwards;
}

.transicion-iris-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-out 0.5s ease forwards;
}

@keyframes iris-in {
    from {
        clip-path: circle(100% at 50% 50%);
    }

    to {
        clip-path: circle(0% at 50% 50%);
    }
}

@keyframes iris-out {
    from {
        clip-path: circle(0% at 50% 50%);
    }

    to {
        clip-path: circle(100% at 50% 50%);
    }
}

/* --- D-pad virtual (touch) --- */

.dpad-contenedor {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 150;
    display: grid;
    grid-template:
        '.     arriba  .      ' 56px
        'izq   .       der    ' 56px
        '.     abajo   .      ' 56px
        / 56px 56px 56px;
    gap: 4px;
}

.dpad-btn {
    width: 56px;
    height: 56px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 12px;
    background-color: rgb(15 15 30 / 75%);
    color: rgb(255 255 255 / 60%);
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: none;
    user-select: none;
    transition:
        background-color 0.1s,
        border-color 0.1s;
}

.dpad-btn:active {
    background-color: rgb(233 69 96 / 40%);
    border-color: var(--color-accent);
    color: white;
}

.dpad-arriba {
    grid-area: arriba;
}

.dpad-izquierda {
    grid-area: izq;
}

.dpad-derecha {
    grid-area: der;
}

.dpad-abajo {
    grid-area: abajo;
}

/* Ocultar D-pad en dispositivos sin touch */
@media (hover: hover) and (pointer: fine) {
    .dpad-contenedor {
        display: none !important;
    }
}

/* --- Notificaciones toast --- */

.toast-contenedor {
    position: fixed;

    /* Anclar al borde derecho del área de juego (800px centrado) */
    right: max(10px, calc(50vw - 400px + 10px));
    top: 50%;
    transform: translateY(-50%);
    z-index: 300;
    display: flex;
    flex-direction: column;
    gap: 6px;
    pointer-events: none;
    width: 52px;
    align-items: flex-end;
}

/* En modo inmersivo (habitaciones 3D) el juego es full-width */
#juego.juego-inmersivo ~ .toast-contenedor {
    right: 10px;
}

/* Toast: diseño compacto tipo badge de juego */
.toast {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    padding: 0;
    background-color: rgb(10 10 25 / 90%);
    border: 2px solid var(--toast-color);
    border-radius: 12px;
    box-shadow:
        0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
        0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
        inset 0 1px 0 rgb(255 255 255 / 8%);
    pointer-events: auto;
    cursor: default;
    position: relative;
    animation: toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    transition:
        opacity 0.3s ease,
        transform 0.3s ease;
}

/* Efecto de resplandor pulsante en el toast activo (el más reciente) */
.toast:last-child {
    animation:
        toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
        toast-pulso 2s ease-in-out 0.35s infinite;
}

/* Los toasts más viejos se atenúan */
.toast:not(:last-child) {
    opacity: 0.5;
    transform: scale(0.85);
}

.toast-icono {
    font-size: 1.3rem;
    line-height: 1;
    flex-shrink: 0;
    filter: drop-shadow(0 0 4px var(--toast-color));
}

/* Tooltip con el mensaje — aparece al hacer hover */
.toast-mensaje {
    position: absolute;
    right: calc(100% + 8px);
    top: 50%;
    transform: translateY(-50%);
    white-space: nowrap;
    font-size: 0.75rem;
    font-weight: 700;
    color: rgb(255 255 255 / 95%);
    background-color: rgb(10 10 25 / 95%);
    border: 1px solid var(--toast-color);
    border-radius: 8px;
    padding: 6px 12px;
    box-shadow:
        0 4px 12px rgb(0 0 0 / 50%),
        0 0 8px color-mix(in srgb, var(--toast-color) 30%, transparent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
}

/* Flechita del tooltip */
.toast-mensaje::after {
    content: '';
    position: absolute;
    right: -5px;
    top: 50%;
    transform: translateY(-50%) rotate(45deg);
    width: 8px;
    height: 8px;
    background-color: rgb(10 10 25 / 95%);
    border-right: 1px solid var(--toast-color);
    border-top: 1px solid var(--toast-color);
}

.toast:hover .toast-mensaje {
    opacity: 1;
}

/* En touch el mensaje se muestra brevemente al aparecer */
.toast-mostrar-mensaje .toast-mensaje {
    opacity: 1;
}

@keyframes toast-entrada {
    from {
        transform: translateX(30px) scale(0.5);
        opacity: 0;
    }

    to {
        transform: translateX(0) scale(1);
        opacity: 1;
    }
}

@keyframes toast-pulso {
    0%,
    100% {
        box-shadow:
            0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
            0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 8%);
    }

    50% {
        box-shadow:
            0 0 16px color-mix(in srgb, var(--toast-color) 70%, transparent),
            0 0 32px color-mix(in srgb, var(--toast-color) 35%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 12%);
    }
}

.toast-salida {
    animation: toast-salida 0.3s ease forwards;
}

@keyframes toast-salida {
    from {
        transform: translateX(0) scale(1);
        opacity: 1;
    }

    to {
        transform: translateX(20px) scale(0.7);
        opacity: 0;
    }
}

/* --- Utilidades --- */

.oculto {
    display: none !important;
}

/* ============================================================
   LIBRO DE VILLANOS — Bestiario con índice y detalle
   ============================================================ */

/* Layout del libro — grimorio antiguo */
.libro-villanos {
    display: flex;
    width: 700px;
    height: 680px;
    max-width: 100%;
    max-height: calc(90vh - 40px);
    margin: 0 auto;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid rgb(255 215 0 / 25%);
    box-shadow:
        0 8px 32px rgb(0 0 0 / 50%),
        0 0 18px var(--v-glow, rgb(233 69 96 / 15%));
    animation: libro-entrada 0.5s ease;
    transition: box-shadow 0.5s;
}

@keyframes libro-entrada {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* Páginas */
.libro-pagina {
    padding: 20px;
}

.libro-pagina-izq {
    flex: 0 0 200px;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 20% 80%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 20%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to right, transparent 70%, rgb(0 0 0 / 15%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    border-right: none;
    display: flex;
    flex-direction: column;
}

.libro-pagina-der {
    flex: 1;
    position: relative;
    padding: 28px 32px 0;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 70% 30%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 30% 70%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to left, transparent 70%, rgb(0 0 0 / 12%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    display: flex;
    flex-direction: column;
    overflow: hidden auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

/* Tintado del villano en página derecha */
.libro-pagina-der::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse at center 30%,
        var(--v-tenue, transparent) 0%,
        transparent 70%
    );
    pointer-events: none;
    z-index: 0;
}

/* Lomo decorativo — cuero cálido */
.libro-lomo {
    flex: 0 0 22px;
    background: linear-gradient(
        90deg,
        #1a1008 0%,
        #2a1c10 30%,
        #3a2818 50%,
        #2a1c10 70%,
        #1a1008 100%
    );
    box-shadow:
        inset 2px 0 6px rgb(0 0 0 / 50%),
        inset -2px 0 6px rgb(0 0 0 / 50%);
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    padding: 20px 0;
}

/* Costuras doradas del lomo */
.libro-lomo-costura {
    height: 1px;
    margin: 0 3px;
    background: linear-gradient(
        90deg,
        transparent,
        rgb(255 215 0 / 30%),
        rgb(255 215 0 / 50%),
        rgb(255 215 0 / 30%),
        transparent
    );
}

/* Título del libro — dorado */
.libro-titulo {
    font-family: var(--font-display);
    color: var(--color-dorado);
    font-size: 1.15rem;
    text-align: left;
    padding-left: 10px;
    margin: 0 0 8px;
    text-shadow:
        0 0 8px rgb(255 215 0 / 30%),
        0 1px 2px rgb(0 0 0 / 60%);
}

/* Ornamentos decorativos — dorados con diamante */
.libro-ornamento {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgb(255 215 0 / 30%), transparent);
    margin: 6px 0;
    position: relative;
}

.libro-ornamento::after {
    content: '\25C6';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.5rem;
    color: rgb(255 215 0 / 40%);
    line-height: 1;
}

/* Índice */
.libro-indice {
    list-style: none;
    padding: 0;
    margin: 8px 0;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.libro-indice-item {
    padding: 8px 10px;
    font-size: 0.8rem;
    color: rgb(180 165 140);
    border-radius: 6px;
    border-left: 2px solid transparent;
    cursor: pointer;
    text-align: left;
    transition:
        background-color 0.2s,
        color 0.2s,
        border-color 0.2s;
    outline: none;
}

.libro-indice-item:hover {
    background-color: rgb(255 255 255 / 5%);
    color: rgb(220 200 170);
}

.libro-indice-item:focus-visible {
    outline: 2px dashed rgb(255 215 0 / 40%);
    outline-offset: -2px;
}

.libro-indice-activo {
    background-color: var(--v-tenue, rgb(233 69 96 / 15%));
    color: var(--v-color, var(--color-accent));
    border-left-color: var(--v-color, var(--color-accent));
    font-weight: bold;
}

/* Contenido del villano */
.libro-detalle-wrap {
    flex: 1;
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
}

.libro-detalle-contenido {
    text-align: center;
    padding: 12px 20px;
    display: flex;
    flex-direction: column;
    height: 100%;
}

/* --- Tabs Perfil / Habilidades --- */
.libro-tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 10px;
}

.libro-tab {
    background: none;
    border: none;
    border-bottom: 2px solid transparent;
    color: rgb(180 165 140 / 50%);
    font-family: var(--font-display);
    font-size: 0.75rem;
    padding: 4px 14px;
    cursor: pointer;
    letter-spacing: 0.05em;
    transition:
        color 0.2s,
        border-color 0.2s;
}

.libro-tab:hover {
    color: rgb(200 185 160);
}

.libro-tab-activo {
    color: var(--v-color, var(--color-dorado));
    border-bottom-color: var(--v-color, var(--color-dorado));
}

/* --- Paneles --- */
.libro-panel {
    display: none;
}

.libro-panel-activo {
    display: flex;
    flex-direction: column;
    flex: 1;
    animation: libro-panel-entrada 0.25s ease;
}

@keyframes libro-panel-entrada {
    from {
        opacity: 0;
        transform: translateY(4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.libro-detalle-contenido .avatar {
    margin-bottom: 4px;
}

/* Avatar mini para panel de habilidades */
.libro-avatar-mini img {
    width: 48px;
    height: 48px;
}

.libro-detalle-contenido .avatar img {
    width: 120px;
    height: 120px;
}

.libro-detalle-cabecera {
    margin-bottom: 4px;
}

.libro-detalle-cabecera h3 {
    font-family: var(--font-display);
    color: var(--v-color, #999);
    font-size: 1.4rem;
    margin: 4px 0 2px;
    text-shadow: 0 0 10px var(--v-glow, transparent);
    transition:
        color 0.5s,
        text-shadow 0.5s;
}

/* Descripción grande (panel perfil) */
.libro-descripcion-grande {
    font-size: 0.9rem;
    line-height: 1.6;
    color: rgb(210 195 170);
    font-style: italic;
    text-align: left;
    margin: 8px 0 0;
    flex: 1;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

.libro-descripcion-grande::-webkit-scrollbar {
    width: 4px;
}

.libro-descripcion-grande::-webkit-scrollbar-track {
    background: transparent;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb {
    background: rgb(255 215 0 / 25%);
    border-radius: 2px;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb:hover {
    background: rgb(255 215 0 / 40%);
}

.libro-detalle-contenido .stats {
    text-align: left;
    padding-top: 0;
}

/* Esquinas ornamentales doradas */
.libro-esquina {
    position: absolute;
    width: 20px;
    height: 20px;
    opacity: 0.4;
    pointer-events: none;
    z-index: 1;
    transition: opacity 0.3s;
}

.libro-villanos:hover .libro-esquina {
    opacity: 0.7;
}

.libro-esquina-tl {
    top: 8px;
    left: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-tr {
    top: 8px;
    right: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-bl {
    bottom: 8px;
    left: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-br {
    bottom: 8px;
    right: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

/* Volteo 3D de página */
.libro-detalle-wrap {
    perspective: 1200px;
}

@keyframes libro-flip-out {
    0% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: -4px 0 16px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: -20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(-90deg);
        opacity: 0;
        box-shadow: -2px 0 8px rgb(0 0 0 / 0%);
    }
}

@keyframes libro-flip-in {
    0% {
        transform: rotateY(90deg);
        opacity: 0;
        box-shadow: 20px 0 30px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: 20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: 0 0 0 rgb(0 0 0 / 0%);
    }
}

.libro-fade-out {
    transform-origin: left center;
    animation: libro-flip-out 0.3s ease-in forwards;
}

.libro-fade-in {
    transform-origin: right center;
    animation: libro-flip-in 0.35s ease-out;
}

/* Navegación */
.libro-navegacion {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 10px 0;
    margin-top: auto;
    border-top: 1px solid rgb(255 215 0 / 10%);
    position: sticky;
    bottom: 0;
    z-index: 2;
    background: linear-gradient(to top, #140f0a 70%, rgb(20 15 10 / 95%) 85%, transparent);
}

.libro-nav-btn {
    width: 32px;
    height: 32px;
    border: 2px solid rgb(255 215 0 / 20%);
    border-radius: 50%;
    background-color: transparent;
    color: rgb(200 185 160);
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-nav-btn:hover:not(:disabled) {
    border-color: var(--v-color, var(--color-accent));
    color: var(--v-color, var(--color-accent));
    background-color: var(--v-tenue, rgb(233 69 96 / 10%));
}

.libro-nav-btn:disabled {
    opacity: 0.25;
    cursor: default;
}

.libro-nav-contador {
    font-size: 0.75rem;
    color: rgb(180 165 140);
    font-style: italic;
    min-width: 40px;
    text-align: center;
}

/* --- Botón flotante del libro --- */

.libro-boton {
    margin-left: auto;
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    animation: libro-levitar 3s ease-in-out infinite;
}

.libro-boton img {
    width: 90px;
    height: 90px;
    border-radius: 12px;
    object-fit: cover;
    animation: libro-glow 2.5s ease-in-out infinite alternate;
}

.libro-boton-texto {
    font-family: var(--font-display);
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    text-shadow: 0 1px 4px rgb(0 0 0 / 60%);
    transition: color 0.3s;
}

.libro-boton:hover {
    animation-duration: 2s;
}

.libro-boton:hover img {
    animation: libro-glow-intenso 1.5s ease-in-out infinite alternate;
}

.libro-boton:hover .libro-boton-texto {
    color: var(--color-accent);
}

.libro-boton:active {
    animation: none;
    transform: translateY(2px) rotate(-6deg);
}

/* Levitación con rotación */
@keyframes libro-levitar {
    0%,
    100% {
        transform: translateY(0) rotate(-6deg);
    }

    50% {
        transform: translateY(-8px) rotate(-6deg);
    }
}

/* Glow normal */
@keyframes libro-glow {
    from {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 10px rgb(140 50 180 / 35%));
    }

    to {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 16px rgb(233 69 96 / 45%));
    }
}

/* Glow intenso (hover) */
@keyframes libro-glow-intenso {
    from {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 20px rgb(140 50 180 / 60%));
    }

    to {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 24px rgb(233 69 96 / 70%));
    }
}

/* Chispas mágicas */
.libro-chispas {
    position: absolute;
    inset: -10px;
    pointer-events: none;
}

.libro-chispa {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    opacity: 0;
}

.libro-chispa:nth-child(1) {
    left: 15%;
    top: 15%;
    background: rgb(180 80 220);
    box-shadow: 0 0 4px rgb(180 80 220);
    animation: chispa-flotar 2.8s ease-in-out infinite;
}

.libro-chispa:nth-child(2) {
    right: 10%;
    top: 25%;
    background: rgb(233 69 96);
    box-shadow: 0 0 4px rgb(233 69 96);
    animation: chispa-flotar 3.2s ease-in-out infinite 0.5s;
}

.libro-chispa:nth-child(3) {
    left: 50%;
    top: 5%;
    background: rgb(255 210 80);
    box-shadow: 0 0 5px rgb(255 210 80);
    animation: chispa-flotar 2.5s ease-in-out infinite 1s;
}

.libro-chispa:nth-child(4) {
    right: 5%;
    bottom: 35%;
    background: rgb(160 60 200);
    box-shadow: 0 0 4px rgb(160 60 200);
    animation: chispa-flotar 3s ease-in-out infinite 1.5s;
}

.libro-chispa:nth-child(5) {
    left: 5%;
    bottom: 40%;
    background: rgb(233 120 140);
    box-shadow: 0 0 4px rgb(233 120 140);
    animation: chispa-flotar 2.6s ease-in-out infinite 2s;
}

.libro-chispa:nth-child(6) {
    left: 30%;
    bottom: 30%;
    background: rgb(255 180 60);
    box-shadow: 0 0 4px rgb(255 180 60);
    animation: chispa-flotar 3.4s ease-in-out infinite 0.8s;
}

@keyframes chispa-flotar {
    0%,
    100% {
        opacity: 0;
        transform: translateY(0) scale(0.3);
    }

    15% {
        opacity: 1;
        transform: translateY(-5px) scale(1);
    }

    50% {
        opacity: 0.7;
        transform: translateY(-15px) scale(0.8);
    }

    85% {
        opacity: 0;
        transform: translateY(-25px) scale(0.2);
    }
}

/* --- Modal del libro --- */

.libro-modal {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow: hidden;
}

.libro-modal-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(0 0 0 / 80%);
}

.libro-modal-cuerpo {
    position: relative;
    animation: modal-aparecer 0.3s ease;
    max-height: 90vh;
    max-width: min(700px, calc(100vw - 40px));
    overflow: hidden auto;
    border-radius: 10px;
}

.libro-modal-cerrar {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
    width: 36px;
    height: 36px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 50%;
    background-color: rgb(15 12 20 / 85%);
    color: var(--color-texto-secundario);
    font-size: 1.3rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(6px);
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-modal-cerrar:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 15%);
}

/* ============================================================
   RESPONSIVE — Selección de personaje
   ============================================================ */

/* --- Tablet (481–768px) --- */
@media (width <= 768px) {
    /* Pasillo tablet */
    .puerta {
        width: 19%;
        height: 18%;
    }

    .antorcha {
        display: none;
    }

    .polvo-7,
    .polvo-8,
    .polvo-11,
    .polvo-12,
    .polvo-13,
    .polvo-14 {
        display: none;
    }

    #juego {
        padding: 30px 16px;
    }

    h1 {
        font-size: 2rem;
    }

    .personaje,
    .villano {
        width: min(200px, 28vw);
    }

    .avatar img {
        width: 80px;
        height: 80px;
    }

    .modal-contenido {
        padding: 24px 28px;
    }

    .modal-personaje-contenido {
        padding: 24px 28px;
    }

    .modal-derrota-caja {
        padding: 20px 24px;
    }

    .barra-superior {
        gap: 10px;
        padding: 6px 10px;
    }

    .barra-jugador img {
        width: 28px;
        height: 28px;
    }

    .barra-jugador span {
        font-size: 0.8rem;
    }

    .barra-vida-jugador {
        min-width: 80px;
    }

    .inventario-slot {
        width: 24px;
        height: 24px;
        font-size: 0.85rem;
    }

    .toast-contenedor {
        right: 8px;
        width: 46px;
    }

    .toast {
        width: 40px;
        height: 40px;
        border-radius: 10px;
    }

    .toast-icono {
        font-size: 1.1rem;
    }

    .toast-mensaje {
        font-size: 0.7rem;
    }

    /* Libro de villanos tablet */
    .libro-villanos {
        max-width: 580px;
        height: 560px;
        max-height: calc(85vh - 40px);
    }

    .libro-pagina-izq {
        flex: 0 0 170px;
        padding: 16px;
    }

    .libro-pagina-der {
        padding: 16px;
    }

    .libro-titulo {
        font-size: 1rem;
    }

    .libro-detalle-contenido .avatar img {
        width: 90px;
        height: 90px;
    }

    .libro-esquina {
        width: 16px;
        height: 16px;
    }

    .libro-lomo {
        flex: 0 0 20px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1.1rem;
    }

    .libro-tab {
        font-size: 0.7rem;
        padding: 3px 10px;
    }

    .libro-nav-btn {
        width: 28px;
        height: 28px;
        font-size: 1rem;
    }

    .libro-nav-contador {
        font-size: 0.7rem;
    }

    .libro-modal-cuerpo {
        max-height: 85vh;
    }
}

/* --- Mobile (≤480px) --- */
@media (width <= 480px) {
    /* Pasillo mobile */
    .puerta {
        width: 22%;
        height: 20%;
    }

    /* Touch target expandido */
    .puerta::after {
        content: '';
        position: absolute;
        inset: -10px;
    }

    .telarana,
    .pasillo-ventana {
        display: none;
    }

    .polvo-5,
    .polvo-6,
    .polvo-7,
    .polvo-8,
    .polvo-9,
    .polvo-10,
    .polvo-11,
    .polvo-12,
    .polvo-13,
    .polvo-14 {
        display: none;
    }

    .niebla-capa-2 {
        display: none;
    }

    #juego {
        padding: 20px 12px;
    }

    h1 {
        font-size: 1.6rem;
    }

    .personaje,
    .villano {
        width: min(200px, 42vw);
        padding: 14px;
    }

    .avatar img {
        width: 70px;
        height: 70px;
    }

    .personaje h3 {
        font-size: 1.1rem;
    }

    .titulo-heroes,
    .titulo-villanos {
        margin-top: 24px;
        font-size: 1.2rem;
    }

    .subtitulo-seleccion {
        font-size: 0.85rem;
    }

    .btn-empezar {
        padding: 10px 24px;
        font-size: 1rem;
    }

    .modal-contenido {
        padding: 20px;
    }

    .modal-contenido h2 {
        font-size: 1.1rem;
    }

    .modal-personaje-contenido {
        padding: 20px;
    }

    .modal-personaje-contenido .avatar img {
        width: 110px;
        height: 110px;
    }

    .modal-personaje-contenido h3 {
        font-size: 1.3rem;
    }

    .modal-personaje-tab {
        font-size: 0.7rem;
        padding: 3px 10px;
    }

    .modal-personaje-descripcion {
        font-size: 0.85rem;
        line-height: 1.5;
    }

    .modal-derrota-caja {
        padding: 18px 16px;
    }

    .modal-derrota-caja h2 {
        font-size: 1.05rem;
    }

    #btn-entrar,
    #btn-cancelar {
        padding: 10px 22px;
        font-size: 0.9rem;
    }

    .barra-superior {
        gap: 6px;
        padding: 5px 8px;
    }

    .barra-jugador img {
        width: 24px;
        height: 24px;
    }

    .barra-jugador span {
        font-size: 0.75rem;
    }

    .barra-vida-texto {
        font-size: 0.6rem;
    }

    .barra-vida-jugador {
        min-width: 60px;
        gap: 4px;
    }

    .barra-vida-corazon {
        font-size: 0.75rem;
    }

    .inventario-slot {
        width: 22px;
        height: 22px;
        font-size: 0.8rem;
    }

    .toast-contenedor {
        right: 6px;
        width: 42px;
    }

    .toast {
        width: 36px;
        height: 36px;
        border-radius: 8px;
    }

    .toast-icono {
        font-size: 1rem;
    }

    .toast-mensaje {
        font-size: 0.65rem;
        padding: 4px 10px;
    }

    /* Libro de villanos mobile */
    .libro-villanos {
        flex-direction: column;
        max-width: 100%;
        height: calc(80vh - 20px);
    }

    .libro-pagina-izq {
        flex: none;
        padding: 10px 12px;
    }

    .libro-titulo {
        font-size: 0.95rem;
        margin-bottom: 4px;
    }

    .libro-ornamento {
        display: none;
    }

    .libro-indice {
        flex-flow: row wrap;
        gap: 4px;
        margin: 4px 0;
    }

    .libro-indice-item {
        padding: 4px 6px;
        font-size: 0.65rem;
        text-align: center;
        border-left: none;
        border-bottom: 2px solid transparent;
    }

    .libro-indice-activo {
        border-left-color: transparent;
        border-bottom-color: var(--v-color, var(--color-accent));
    }

    .libro-lomo {
        display: none;
    }

    .libro-lomo-costura {
        display: none;
    }

    .libro-pagina-der {
        padding: 12px;
    }

    .libro-detalle-contenido {
        padding: 8px 12px;
    }

    .libro-detalle-contenido .avatar img {
        width: 80px;
        height: 80px;
    }

    .libro-esquina {
        width: 14px;
        height: 14px;
        opacity: 0.3;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1rem;
    }

    .libro-tab {
        font-size: 0.65rem;
        padding: 3px 8px;
    }

    .libro-descripcion-grande {
        font-size: 0.8rem;
        line-height: 1.5;
    }

    .libro-nav-btn {
        width: 26px;
        height: 26px;
        font-size: 0.9rem;
    }

    .libro-nav-contador {
        font-size: 0.65rem;
    }

    .libro-boton img {
        width: 70px;
        height: 70px;
    }

    .libro-boton-texto {
        font-size: 0.7rem;
    }

    .libro-modal-cuerpo {
        max-height: 80vh;
    }

    .libro-modal-cerrar {
        width: 30px;
        height: 30px;
        font-size: 1.1rem;
        top: 6px;
        right: 6px;
    }
}

/* --- Pantallas muy pequeñas (≤360px) --- */
@media (width <= 360px) {
    /* Pasillo pantallas pequeñas */
    .puerta {
        width: 24%;
        height: 22%;
    }

    .polvo {
        display: none;
    }

    .deco-cuadro {
        display: none;
    }

    .libro-villanos {
        max-height: calc(78vh - 20px);
    }

    .libro-detalle-contenido .avatar img {
        width: 64px;
        height: 64px;
    }

    .libro-esquina {
        display: none;
    }

    .libro-tab {
        font-size: 0.6rem;
        padding: 2px 6px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 0.9rem;
    }

    .libro-descripcion-grande {
        font-size: 0.75rem;
    }

    .libro-indice-item {
        padding: 3px 5px;
        font-size: 0.6rem;
    }

    .modal-personaje-tab {
        font-size: 0.6rem;
        padding: 2px 6px;
    }

    .modal-personaje-descripcion {
        font-size: 0.75rem;
    }
}

/* --- Pulido mobile --- */

/* Ocultar hints de teclado en dispositivos touch */
@media (hover: none), (pointer: coarse) {
    #controles-hint,
    .laberinto-hint {
        display: none;
    }
}

/* Targets mínimos de 44x44px y posición de botones en touch */
@media (pointer: coarse) {
    #btn-entrar,
    #btn-cancelar,
    .modal-derrota-btn,
    .btn-huir,
    .btn-cerrar-modal {
        min-height: 44px;
        min-width: 44px;
    }
}

/* Reducir animaciones pesadas si el usuario lo prefiere */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    /* Pasillo: sin entreapertura de puerta ni efectos decorativos */
    .puerta-cerca .puerta-hoja {
        transform: none;
    }

    .polvo,
    .antorcha-llama,
    .niebla-capa,
    .ventana-estrella {
        display: none;
    }
}
