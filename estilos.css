/* Estilos de La Mansi√≥n de Aventuras */

/* --- Fuentes locales --- */

@font-face {
    font-family: MedievalSharp;
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('assets/fonts/medievalsharp-400-latin.woff2') format('woff2');
}

@font-face {
    font-family: Quicksand;
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('assets/fonts/quicksand-variable-latin.woff2') format('woff2');
}

:root {
    /* Fuentes */
    --font-display: medievalsharp, cursive;
    --font-body: quicksand, sans-serif;

    /* Tema base */
    --color-fondo: #1a1a2e;
    --color-superficie: #16213e;
    --color-oscuro: #0d0d1a;
    --color-accent: #e94560;
    --color-accent-hover: #c73652;
    --color-texto: #e0e0e0;
    --color-texto-secundario: #a0a0b0;
    --color-texto-tenue: #888;
    --color-texto-apagado: #666;
    --color-texto-muy-apagado: #555;
    --color-borde: #333;
    --color-borde-claro: #444;
    --color-dorado: #ffd700;

    /* Radios */
    --radio-tarjeta: 15px;
    --radio-boton: 8px;
}

body {
    margin: 0;
    padding: 0;
    background-color: var(--color-fondo);
    color: var(--color-texto);
    font-family: var(--font-body);
    overflow: hidden;
    height: 100dvh;
}

#juego {
    max-width: 800px;
    margin: 0 auto;
    padding: 12px 20px;
    text-align: center;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
}

#seleccion-personaje {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

#juego.juego-inmersivo {
    max-width: none;
    padding: 10px;
}

#juego.juego-inmersivo .barra-superior {
    max-width: var(--ancho-3d);
    margin-inline: auto;
}

h1 {
    font-family: var(--font-display);
    font-size: 2.5rem;
    color: white;
    letter-spacing: 0.04em;
}

/* --- Selecci√≥n de personaje --- */

.avatar {
    font-size: 4rem;
    margin-bottom: 10px;
    display: inline-block;
}

.avatar img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-texto-muy-apagado);
}

/* --- Colores por personaje --- */

/* Lina - paleta morada */
.personaje-lina {
    --v-color: #bb86fc;
    --v-oscuro: #9b59b6;
    --v-glow: rgb(187 134 252 / 40%);
    --v-tenue: rgb(187 134 252 / 12%);

    border-color: #4a1a6b;
    background-color: #1a0a2e;
}

.personaje-lina h3 {
    color: #bb86fc;
}

.personaje-lina .avatar img {
    border-color: #9b59b6;
}

/* Ros√© - paleta verde */
.personaje-rose {
    --v-color: #6bfc86;
    --v-oscuro: #2ecc71;
    --v-glow: rgb(107 252 134 / 40%);
    --v-tenue: rgb(107 252 134 / 12%);

    border-color: #1a6b2a;
    background-color: #0a2e14;
}

.personaje-rose h3 {
    color: #6bfc86;
}

.personaje-rose .avatar img {
    border-color: #2ecc71;
}

/* Hana - paleta rosa/fucsia */
.personaje-hana {
    --v-color: #fc86d4;
    --v-oscuro: #e91e90;
    --v-glow: rgb(252 134 212 / 40%);
    --v-tenue: rgb(252 134 212 / 12%);

    border-color: #6b1a5a;
    background-color: #2e0a28;
}

.personaje-hana h3 {
    color: #fc86d4;
}

.personaje-hana .avatar img {
    border-color: #e91e90;
}

/* DonBu - paleta marr√≥n/√°mbar */
.personaje-donbu {
    --v-color: #e6b86a;
    --v-oscuro: #d4a052;
    --v-glow: rgb(230 184 106 / 40%);
    --v-tenue: rgb(230 184 106 / 12%);

    border-color: #6b4a1a;
    background-color: #2e1a0a;
}

.personaje-donbu h3 {
    color: #fcca6b;
}

.personaje-donbu .avatar img {
    border-color: #d4a052;
}

/* Kira - paleta teal/p√∫rpura */
.personaje-kira {
    --v-color: #3dd8c8;
    --v-oscuro: #2ec4b6;
    --v-glow: rgb(61 216 200 / 40%);
    --v-tenue: rgb(61 216 200 / 12%);

    border-color: #1a5a5a;
    background-color: #0a2020;
}

.personaje-kira h3 {
    color: #5eeadb;
}

.personaje-kira .avatar img {
    border-color: #2ec4b6;
}

/* PandaJuro - paleta azul con rojo */
.personaje-pandajuro {
    --v-color: #e74c3c;
    --v-oscuro: #c0392b;
    --v-glow: rgb(231 76 60 / 40%);
    --v-tenue: rgb(231 76 60 / 12%);

    border-color: #1a3a6b;
    background-color: #0a1430;
}

.personaje-pandajuro h3 {
    color: #6bb5fc;
}

.personaje-pandajuro .avatar img {
    border-color: #c0392b;
}

/* PomPom - paleta rosa/crema */
.personaje-pompom {
    --v-color: #fcc2d7;
    --v-oscuro: #f8a5c2;
    --v-glow: rgb(252 194 215 / 40%);
    --v-tenue: rgb(252 194 215 / 12%);

    border-color: #7a4a5a;
    background-color: #2a1520;
}

.personaje-pompom h3 {
    color: #fcc2d7;
}

.personaje-pompom .avatar img {
    border-color: #f8a5c2;
}

/* Orejas - paleta naranja/tierra */
.personaje-orejas {
    --v-color: #f0a04b;
    --v-oscuro: #e67e22;
    --v-glow: rgb(240 160 75 / 40%);
    --v-tenue: rgb(240 160 75 / 12%);

    border-color: #6b3a0a;
    background-color: #2a1505;
}

.personaje-orejas h3 {
    color: #f0a04b;
}

.personaje-orejas .avatar img {
    border-color: #e67e22;
}

.descripcion {
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* --- Stats del personaje en la tarjeta --- */

.stats {
    text-align: left;
    border-top: 1px solid rgb(255 255 255 / 8%);
    padding-top: 10px;
    margin-top: 4px;
}

.stat-label {
    display: block;
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: #9898b0;
    margin-bottom: 4px;
}

/* Barra de vida */
.stat-vida {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vida .stat-label {
    grid-column: 1 / -1;
}

.barra-vida-fondo {
    height: 6px;
    background-color: rgb(255 255 255 / 8%);
    border-radius: 3px;
    overflow: hidden;
}

.barra-vida-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e94560, #ff6b81);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-valor {
    font-size: 0.8rem;
    font-weight: bold;
    color: #ccc;
}

/* Barra de velocidad */
.stat-velocidad {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-velocidad .stat-label {
    grid-column: 1 / -1;
}

.barra-velocidad-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #f59e0b, #fbbf24);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

.stat-vel-ataque {
    display: grid;
    grid-template-columns: 1fr auto;
    grid-template-rows: auto auto;
    gap: 2px 8px;
    align-items: center;
    margin-bottom: 10px;
}

.stat-vel-ataque .stat-label {
    grid-column: 1 / -1;
}

.barra-vel-ataque-relleno {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #e05a8a, #f472b6);
    border-radius: 3px;
    transform-origin: left;
    transition: transform 0.3s;
}

/* Ataques */
.stat-atributos {
    margin-top: 6px;
    margin-bottom: 12px;
}

.stat-atributos .tier-badge {
    position: static;
}

.stat-ataques {
    margin-top: 12px;
}

.ataque {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 3px 0;
}

.ataque-nombre {
    font-size: 0.75rem;
    color: #b0b0c0;
}

.ataque-dano {
    font-size: 0.75rem;
    font-weight: bold;
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 12%);
    padding: 1px 6px;
    border-radius: var(--radio-boton);
}

/* Colores de barra de vida por personaje */
.personaje-lina .barra-vida-relleno {
    background: linear-gradient(90deg, #9b59b6, #bb86fc);
}

.personaje-lina .ataque-dano {
    color: #bb86fc;
    background-color: rgb(155 89 182 / 15%);
}

.personaje-rose .barra-vida-relleno {
    background: linear-gradient(90deg, #2ecc71, #6bfc86);
}

.personaje-rose .ataque-dano {
    color: #6bfc86;
    background-color: rgb(46 204 113 / 15%);
}

.personaje-hana .barra-vida-relleno {
    background: linear-gradient(90deg, #e91e90, #fc86d4);
}

.personaje-hana .ataque-dano {
    color: #fc86d4;
    background-color: rgb(233 30 144 / 15%);
}

.personaje-kira .barra-vida-relleno {
    background: linear-gradient(90deg, #2ec4b6, #5eeadb);
}

.personaje-kira .ataque-dano {
    color: #5eeadb;
    background-color: rgb(46 196 182 / 15%);
}

.personaje-donbu .barra-vida-relleno {
    background: linear-gradient(90deg, #d4a052, #fcca6b);
}

.personaje-donbu .ataque-dano {
    color: #fcca6b;
    background-color: rgb(212 160 82 / 15%);
}

.personaje-pompom .barra-vida-relleno {
    background: linear-gradient(90deg, #f8a5c2, #fcc2d7);
}

.personaje-pompom .ataque-dano {
    color: #fcc2d7;
    background-color: rgb(248 165 194 / 15%);
}

.personaje-orejas .barra-vida-relleno {
    background: linear-gradient(90deg, #e67e22, #f0a04b);
}

.personaje-orejas .ataque-dano {
    color: #f0a04b;
    background-color: rgb(230 126 34 / 15%);
}

.personaje-pandajuro .barra-vida-relleno {
    background: linear-gradient(90deg, #c0392b, #6bb5fc);
}

.personaje-pandajuro .ataque-dano {
    color: #6bb5fc;
    background-color: rgb(107 181 252 / 15%);
}

/* --- Secci√≥n de villanos --- */

.villano {
    position: relative;
    background-color: var(--color-superficie);
    border: 3px solid var(--color-borde);
    border-radius: var(--radio-tarjeta);
    padding: 20px;
    width: 200px;
    cursor: default;
    flex-shrink: 0;
    scroll-snap-align: center;
    opacity: 0.75;
    transition: opacity 0.3s;
}

.villano:hover {
    opacity: 1;
}

/* Badge de tier */
.tier-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 0.6rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    padding: 2px 8px;
    border-radius: 20px;
    line-height: 1.4;
}

.tier-esbirro {
    background-color: rgb(80 80 80 / 40%);
    color: #aaa;
}

.tier-elite {
    background-color: rgb(168 85 247 / 20%);
    color: #c084fc;
}

.tier-pesadilla {
    background-color: rgb(239 68 68 / 20%);
    color: #f87171;
}

.tier-leyenda {
    background-color: rgb(245 158 11 / 20%);
    color: #fbbf24;
}

.villano h3 {
    font-family: var(--font-display);
    color: #999;
    margin: 5px 0;
    font-size: 1.3rem;
}

.villano .descripcion {
    font-size: 0.85rem;
    color: #777;
}

.avatar-emoji {
    font-size: 4rem;
    display: block;
    line-height: 1;
}

/* Siniestra ‚Äî rojo/negro */
.villano-siniestra {
    --v-color: #f44;
    --v-oscuro: #8b0000;
    --v-glow: rgb(255 50 50 / 40%);
    --v-tenue: rgb(255 68 68 / 12%);

    border-color: #4a0a0a;
    background-color: #1a0808;
}

.villano-siniestra h3 {
    color: #f44;
}

.villano-siniestra .avatar img {
    border-color: #8b0000;
    box-shadow: 0 0 10px rgb(255 50 50 / 40%);
}

.villano-siniestra .barra-vida-relleno {
    background: linear-gradient(90deg, #8b0000, #f44);
}

.villano-siniestra .ataque-dano {
    color: #f44;
    background-color: rgb(255 68 68 / 15%);
}

/* Trasgo ‚Äî negro/gris */
.villano-trasgo {
    --v-color: #888;
    --v-oscuro: #555;
    --v-glow: rgb(150 150 150 / 30%);
    --v-tenue: rgb(150 150 150 / 12%);

    border-color: #333;
    background-color: #111118;
}

.villano-trasgo h3 {
    color: #888;
}

.villano-trasgo .avatar img {
    border-color: #555;
    box-shadow: 0 0 8px rgb(150 150 150 / 30%);
}

.villano-trasgo .barra-vida-relleno {
    background: linear-gradient(90deg, #444, #888);
}

.villano-trasgo .ataque-dano {
    color: #999;
    background-color: rgb(150 150 150 / 15%);
}

/* El Profano ‚Äî azul/negro */
.villano-profano {
    --v-color: #48c;
    --v-oscuro: #1a3a6b;
    --v-glow: rgb(50 100 200 / 40%);
    --v-tenue: rgb(68 136 204 / 12%);

    border-color: #0a1a3a;
    background-color: #080e1a;
}

.villano-profano h3 {
    color: #48c;
}

.villano-profano .avatar img {
    border-color: #1a3a6b;
    box-shadow: 0 0 10px rgb(50 100 200 / 40%);
}

.villano-profano .barra-vida-relleno {
    background: linear-gradient(90deg, #1a2a4a, #48c);
}

.villano-profano .ataque-dano {
    color: #48c;
    background-color: rgb(68 136 204 / 15%);
}

/* El Errante ‚Äî verde/negro */
.villano-errante {
    --v-color: #4c4;
    --v-oscuro: #2a6b2a;
    --v-glow: rgb(50 200 50 / 40%);
    --v-tenue: rgb(68 204 68 / 12%);

    border-color: #0a4a0a;
    background-color: #081a08;
}

.villano-errante h3 {
    color: #4c4;
}

.villano-errante .avatar img {
    border-color: #2a6b2a;
    box-shadow: 0 0 10px rgb(50 200 50 / 40%);
}

.villano-errante .barra-vida-relleno {
    background: linear-gradient(90deg, #1a6b1a, #4c4);
}

.villano-errante .ataque-dano {
    color: #4c4;
    background-color: rgb(68 204 68 / 15%);
}

/* Topete ‚Äî p√∫rpura/magenta */
.villano-topete {
    --v-color: #c050d0;
    --v-oscuro: #6a1b7a;
    --v-glow: rgb(192 80 208 / 40%);
    --v-tenue: rgb(192 80 208 / 12%);

    border-color: #3a0a4a;
    background-color: #12081a;
}

.villano-topete h3 {
    color: #c050d0;
}

.villano-topete .avatar img {
    border-color: #6a1b7a;
    box-shadow: 0 0 10px rgb(192 80 208 / 40%);
}

.villano-topete .barra-vida-relleno {
    background: linear-gradient(90deg, #6a1b7a, #c050d0);
}

.villano-topete .ataque-dano {
    color: #c050d0;
    background-color: rgb(192 80 208 / 15%);
}

/* Pototo ‚Äî rosa/magenta */
.villano-pototo {
    --v-color: #e060a0;
    --v-oscuro: #8b1a5a;
    --v-glow: rgb(224 96 160 / 40%);
    --v-tenue: rgb(224 96 160 / 12%);

    border-color: #4a0a2a;
    background-color: #1a0812;
}

.villano-pototo h3 {
    color: #e060a0;
}

.villano-pototo .avatar img {
    border-color: #8b1a5a;
    box-shadow: 0 0 10px rgb(224 96 160 / 40%);
}

.villano-pototo .barra-vida-relleno {
    background: linear-gradient(90deg, #8b1a5a, #e060a0);
}

.villano-pototo .ataque-dano {
    color: #e060a0;
    background-color: rgb(224 96 160 / 15%);
}

/* La Grotesca ‚Äî vino/p√∫rpura oscuro */
.villano-grotesca {
    --v-color: #a8325a;
    --v-oscuro: #5c1a30;
    --v-glow: rgb(168 50 90 / 40%);
    --v-tenue: rgb(168 50 90 / 12%);

    border-color: #3a0a1a;
    background-color: #150810;
}

.villano-grotesca h3 {
    color: #a8325a;
}

.villano-grotesca .avatar img {
    border-color: #5c1a30;
    box-shadow: 0 0 10px rgb(168 50 90 / 40%);
}

.villano-grotesca .barra-vida-relleno {
    background: linear-gradient(90deg, #5c1a30, #a8325a);
}

.villano-grotesca .ataque-dano {
    color: #a8325a;
    background-color: rgb(168 50 90 / 15%);
}

/* El Disonante ‚Äî √°mbar/siena */
.villano-disonante {
    --v-color: #c89030;
    --v-oscuro: #6e4e18;
    --v-glow: rgb(200 144 48 / 40%);
    --v-tenue: rgb(200 144 48 / 12%);

    border-color: #3a2a0e;
    background-color: #1a1408;
}

.villano-disonante h3 {
    color: #c89030;
}

.villano-disonante .avatar img {
    border-color: #6e4e18;
    box-shadow: 0 0 10px rgb(200 144 48 / 40%);
}

.villano-disonante .barra-vida-relleno {
    background: linear-gradient(90deg, #6e4e18, #c89030);
}

.villano-disonante .ataque-dano {
    color: #c89030;
    background-color: rgb(200 144 48 / 15%);
}

/* --- Overlay de empezar (sobre tarjeta seleccionada) --- */

.btn-empezar {
    font-family: var(--font-display);
    padding: 12px 30px;
    font-size: 1.1rem;
    font-weight: bold;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    background-color: var(--color-accent);
    color: white;
    box-shadow: 0 0 20px rgb(233 69 96 / 60%);
    position: relative;
    transition: background-color 0.2s;
}

/* Glow animado GPU-composited */
.btn-empezar::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    box-shadow:
        0 0 35px rgb(233 69 96 / 90%),
        0 0 60px rgb(233 69 96 / 30%);
    animation: pulso-opacity 1.5s ease-in-out infinite;
    pointer-events: none;
}

.btn-empezar:hover {
    background-color: var(--color-accent-hover);
    box-shadow: 0 0 30px rgb(233 69 96 / 80%);
}

/* --- Pantalla del pasillo --- */

#pantalla-juego {
    display: flex;
    flex-direction: column;
    align-items: center;
}

#pasillo {
    position: relative;
    width: min(400px, 90vw);
    aspect-ratio: 2 / 3;
    touch-action: none;
    contain: layout paint;
    background:
        repeating-conic-gradient(#1a1a28 0% 25%, #15152a 0% 50%) 0 0 / 50px 50px,
        radial-gradient(ellipse at 50% 60%, rgb(80 50 20 / 30%) 0%, transparent 60%),
        var(--color-oscuro);
    border-left: 18px solid transparent;
    border-right: 18px solid transparent;
    border-image: repeating-linear-gradient(
            180deg,
            #2a1a0a 0,
            #3d2815 8px,
            #1a0f05 8px,
            #2a1a0a 16px
        )
        18;
    box-shadow:
        inset 0 0 80px rgb(0 0 0 / 80%),
        inset 0 0 30px rgb(0 0 0 / 50%),
        0 0 20px rgb(0 0 0 / 60%);
    overflow: hidden;
    animation: parpadeo-luz 6s ease-in-out infinite;
}

/* Capas de niebla */
.niebla-capa {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 7;
}

.niebla-capa-1 {
    background:
        radial-gradient(ellipse at 25% 25%, rgb(120 90 160 / 22%) 0%, transparent 55%),
        radial-gradient(ellipse at 75% 65%, rgb(120 90 160 / 18%) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 80%, rgb(100 80 140 / 12%) 0%, transparent 60%);
    animation: niebla-1 8s ease-in-out infinite alternate;
}

.niebla-capa-2 {
    background:
        radial-gradient(ellipse at 65% 35%, rgb(90 70 130 / 18%) 0%, transparent 50%),
        radial-gradient(ellipse at 15% 75%, rgb(100 80 140 / 15%) 0%, transparent 45%),
        radial-gradient(ellipse at 80% 90%, rgb(80 60 120 / 10%) 0%, transparent 50%);
    animation: niebla-2 12s ease-in-out infinite alternate-reverse;
}

@keyframes niebla-1 {
    0% {
        opacity: 0.5;
        transform: translateX(-8px) translateY(2px);
    }

    100% {
        opacity: 1;
        transform: translateX(8px) translateY(-2px);
    }
}

@keyframes niebla-2 {
    0% {
        opacity: 0.4;
        transform: translateX(6px) translateY(-3px);
    }

    100% {
        opacity: 0.9;
        transform: translateX(-6px) translateY(3px);
    }
}

@keyframes parpadeo-luz {
    0%,
    90%,
    100% {
        opacity: 1;
    }

    92% {
        opacity: 0.7;
    }

    94% {
        opacity: 1;
    }

    96% {
        opacity: 0.6;
    }

    98% {
        opacity: 0.9;
    }
}

/* --- Decoraci√≥n del pasillo --- */

/* Ventana g√≥tica al fondo */
.pasillo-ventana {
    position: absolute;
    top: 3%;
    left: 50%;
    transform: translateX(-50%);
    width: 22%;
    height: 12%;
    border-radius: 50% 50% 4px 4px;
    border: 3px solid #3a2a1a;
    overflow: hidden;
    box-shadow:
        inset 0 0 10px rgb(0 0 0 / 60%),
        0 0 12px rgb(0 0 0 / 50%);
    pointer-events: none;
    z-index: 1;
}

.ventana-cielo {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #0a0a2a 0%, #1a1a4a 60%, #2a2a5a 100%);
    position: relative;
}

.ventana-luna {
    position: absolute;
    top: 18%;
    right: 20%;
    width: 28%;
    aspect-ratio: 1;
    border-radius: 50%;
    background: radial-gradient(circle at 40% 40%, #fffde8 0%, #e8d88a 60%, #c8b86a 100%);
    box-shadow:
        0 0 8px rgb(255 253 232 / 60%),
        0 0 20px rgb(255 253 232 / 25%);
    animation: luna-pulso 4s ease-in-out infinite;
}

@keyframes luna-pulso {
    0%,
    100% {
        box-shadow:
            0 0 8px rgb(255 253 232 / 60%),
            0 0 20px rgb(255 253 232 / 25%);
    }

    50% {
        box-shadow:
            0 0 12px rgb(255 253 232 / 80%),
            0 0 30px rgb(255 253 232 / 35%);
    }
}

.ventana-estrella {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #fff;
    border-radius: 50%;
    animation: estrella-titilar 2s ease-in-out infinite;
}

.ventana-estrella-1 {
    top: 20%;
    left: 15%;
}

.ventana-estrella-2 {
    top: 40%;
    left: 35%;
    animation-delay: 0.7s;
}

.ventana-estrella-3 {
    top: 15%;
    left: 55%;
    animation-delay: 1.3s;
}

@keyframes estrella-titilar {
    0%,
    100% {
        opacity: 0.3;
    }

    50% {
        opacity: 1;
    }
}

/* Enredaderas m√°gicas en esquinas superiores */
.enredadera {
    position: absolute;
    top: 0;
    width: 28%;
    height: 28%;
    pointer-events: none;
    z-index: 2;
    background-size: 100% 100%;
    background-repeat: no-repeat;
}

.enredadera-izq {
    left: 0;
    background-image: url('assets/img/pasillo/enredadera-izq.svg');
}

.enredadera-der {
    right: 0;
    background-image: url('assets/img/pasillo/enredadera-der.svg');
}

/* Alfombra central */
.pasillo-alfombra {
    position: absolute;
    top: 18%;
    left: 30%;
    width: 40%;
    height: 80%;
    background:
        repeating-linear-gradient(
            45deg,
            rgb(120 30 30 / 12%) 0,
            rgb(120 30 30 / 12%) 1px,
            transparent 1px,
            transparent 8px
        ),
        repeating-linear-gradient(
            -45deg,
            rgb(120 30 30 / 12%) 0,
            rgb(120 30 30 / 12%) 1px,
            transparent 1px,
            transparent 8px
        ),
        linear-gradient(
            180deg,
            rgb(80 20 20 / 20%) 0%,
            rgb(60 15 15 / 30%) 50%,
            rgb(80 20 20 / 20%) 100%
        );
    border-left: 2px solid rgb(100 30 30 / 20%);
    border-right: 2px solid rgb(100 30 30 / 20%);
    pointer-events: none;
    z-index: 0;
}

/* Cuadros misteriosos mejorados */
.deco-cuadro {
    position: absolute;
    pointer-events: none;
    z-index: 1;
}

.cuadro-marco {
    width: 100%;
    height: 100%;
    border: 3px solid #6a5a30;
    border-radius: 2px;
    overflow: hidden;
    box-shadow:
        0 2px 8px rgb(0 0 0 / 70%),
        0 0 3px rgb(100 70 30 / 30%),
        inset 0 0 6px rgb(100 80 30 / 20%);
    position: relative;
}

/* Brillo misterioso peri√≥dico en los cuadros */
.cuadro-marco::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 50% 50%, rgb(200 50 30 / 15%) 0%, transparent 70%);
    opacity: 0;
    animation: cuadro-misterioso 8s ease-in-out infinite;
}

@keyframes cuadro-misterioso {
    0%,
    85%,
    100% {
        opacity: 0;
    }

    90% {
        opacity: 1;
    }
}

.cuadro-marco img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.7);
}

.deco-cuadro-izq {
    left: 2%;
    top: 45.3%;
    width: 13.75%;
    height: 7.5%;
    transform: rotate(-2deg);
}

.deco-cuadro-der {
    right: 2%;
    top: 46.3%;
    width: 14.5%;
    height: 7%;
    transform: rotate(2deg);
}

/* Antorchas animadas */
.antorcha {
    position: absolute;
    width: 5%;
    height: 8%;
    pointer-events: none;
    z-index: 2;
}

.antorcha-soporte {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 30%;
    height: 55%;
    background: linear-gradient(180deg, #5a3a1a 0%, #3a2510 100%);
    border-radius: 2px;
}

.antorcha-llama {
    position: absolute;
    top: 5%;
    left: 50%;
    transform: translateX(-50%);
    width: 55%;
    aspect-ratio: 3 / 4;
    background: radial-gradient(
        ellipse at 50% 60%,
        #ffd54f 0%,
        #ff9800 40%,
        #e65100 70%,
        transparent 100%
    );
    border-radius: 50% 50% 40% 40%;
    animation: llama-parpadeo 0.4s ease-in-out infinite alternate;
    will-change: transform;
}

.antorcha-luz {
    position: absolute;
    top: -30%;
    left: -100%;
    width: 300%;
    height: 200%;
    background: radial-gradient(ellipse at 50% 40%, rgb(255 180 50 / 8%) 0%, transparent 60%);
    animation: llama-luz 2s ease-in-out infinite alternate;
    pointer-events: none;
}

@keyframes llama-parpadeo {
    0% {
        transform: translateX(-50%) scaleY(1) scaleX(1);
        opacity: 0.9;
    }

    100% {
        transform: translateX(-50%) scaleY(1.15) scaleX(0.9);
        opacity: 1;
    }
}

@keyframes llama-luz {
    0% {
        opacity: 0.6;
    }

    100% {
        opacity: 1;
    }
}

/* Posiciones de antorchas (par superior flanqueando la ventana) */
.antorcha-izq.antorcha-1 {
    left: 6%;
    top: 12%;
    animation-delay: 0.1s;
}

.antorcha-der.antorcha-2 {
    right: 6%;
    top: 12%;
}

.antorcha-2 .antorcha-llama {
    animation-delay: 0.15s;
}

/* Part√≠culas de polvo flotante */
.polvo {
    position: absolute;
    width: 2px;
    height: 2px;
    background: rgb(200 180 150 / 40%);
    border-radius: 50%;
    pointer-events: none;
    z-index: 6;
    animation: polvo-flotar var(--polvo-duracion, 10s) ease-in-out infinite;
    will-change: transform;
}

@keyframes polvo-flotar {
    0%,
    100% {
        opacity: 0;
        transform: translateY(0);
    }

    20% {
        opacity: 0.6;
    }

    50% {
        opacity: 0.4;
    }

    80% {
        opacity: 0.6;
    }

    90% {
        opacity: 0;
        transform: translateY(-40px);
    }
}

.polvo-1 {
    left: 15%;
    top: 30%;

    --polvo-duracion: 9s;
}

.polvo-2 {
    left: 70%;
    top: 50%;

    --polvo-duracion: 12s;

    animation-delay: 1.5s;
}

.polvo-3 {
    left: 40%;
    top: 20%;

    --polvo-duracion: 11s;

    animation-delay: 3s;
    width: 3px;
    height: 3px;
}

.polvo-4 {
    left: 85%;
    top: 65%;

    --polvo-duracion: 13s;

    animation-delay: 4.5s;
}

.polvo-5 {
    left: 25%;
    top: 75%;

    --polvo-duracion: 10s;

    animation-delay: 2s;
}

.polvo-6 {
    left: 55%;
    top: 35%;

    --polvo-duracion: 14s;

    animation-delay: 6s;
    width: 3px;
    height: 3px;
}

.polvo-7 {
    left: 80%;
    top: 15%;

    --polvo-duracion: 15s;

    animation-delay: 7s;
}

.polvo-8 {
    left: 10%;
    top: 55%;

    --polvo-duracion: 11s;

    animation-delay: 5s;
}

.polvo-9 {
    left: 48%;
    top: 60%;

    --polvo-duracion: 10s;

    animation-delay: 1s;
    width: 3px;
    height: 3px;
}

.polvo-10 {
    left: 92%;
    top: 40%;

    --polvo-duracion: 13s;

    animation-delay: 3.5s;
}

.polvo-11 {
    left: 33%;
    top: 85%;

    --polvo-duracion: 9s;

    animation-delay: 8s;
    width: 3px;
    height: 3px;
}

.polvo-12 {
    left: 65%;
    top: 10%;

    --polvo-duracion: 12s;

    animation-delay: 2.5s;
}

.polvo-13 {
    left: 20%;
    top: 45%;

    --polvo-duracion: 14s;

    animation-delay: 9s;
    width: 3px;
    height: 3px;
}

.polvo-14 {
    left: 75%;
    top: 75%;

    --polvo-duracion: 11s;

    animation-delay: 6.5s;
}

/* --- Puertas con personalidad --- */

/* Variables de color por puerta */
.puerta-1 {
    --puerta-accent: #bb86fc;
    --puerta-accent-rgb: 187 134 252;
    --puerta-marco: #4a3a5a;

    top: 58%;
}

.puerta-2 {
    --puerta-accent: #6bfc86;
    --puerta-accent-rgb: 107 252 134;
    --puerta-marco: #2a4a32;

    top: 58%;
}

.puerta-3 {
    --puerta-accent: #e94560;
    --puerta-accent-rgb: 233 69 96;
    --puerta-marco: #5a2a2a;

    top: 22%;
}

.puerta-4 {
    --puerta-accent: #5eeadb;
    --puerta-accent-rgb: 94 234 219;
    --puerta-marco: #1a3a4a;

    top: 22%;
}

.puerta {
    position: absolute;
    width: 17%;
    height: 17%;
    cursor: pointer;
    z-index: 3;
    display: flex;
    align-items: center;
    justify-content: center;
}

.puerta-marco {
    width: 100%;
    height: 100%;
    background: var(--puerta-marco);
    border-radius: 6px 6px 0 0;
    padding: 3px;
    box-shadow:
        inset 0 0 8px rgb(0 0 0 / 40%),
        0 2px 6px rgb(0 0 0 / 50%);
    overflow: hidden;
}

.puerta-hoja {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #3d2815 0%, #2a1a0a 40%, #1f1208 100%);
    border-radius: 4px 4px 0 0;
    position: relative;
    transition:
        transform 0.4s ease,
        box-shadow 0.3s;
    transform-origin: left center;
    will-change: transform;
}

.puerta-detalle {
    position: absolute;
    inset: 15% 10%;
    border-radius: 2px;
    opacity: 0.3;
    pointer-events: none;
}

/* Puerta 1 ‚Äî patr√≥n de laberinto */
.puerta-1 .puerta-detalle {
    background:
        repeating-linear-gradient(
            0deg,
            rgb(187 134 252 / 20%) 0,
            rgb(187 134 252 / 20%) 1px,
            transparent 1px,
            transparent 6px
        ),
        repeating-linear-gradient(
            90deg,
            rgb(187 134 252 / 20%) 0,
            rgb(187 134 252 / 20%) 1px,
            transparent 1px,
            transparent 6px
        );
}

.puerta-1 .puerta-marco {
    border-radius: 12px 12px 0 0;
}

/* Puerta 2 ‚Äî patr√≥n geom√©trico ne√≥n */
.puerta-2 .puerta-marco {
    background: #1a2a1e;
    border: 1px solid rgb(107 252 134 / 30%);
}

.puerta-2 .puerta-hoja {
    background: linear-gradient(180deg, #1a2a20 0%, #0f1a14 40%, #0a1210 100%);
}

.puerta-2 .puerta-detalle {
    background:
        repeating-linear-gradient(
            60deg,
            rgb(107 252 134 / 15%) 0,
            rgb(107 252 134 / 15%) 1px,
            transparent 1px,
            transparent 8px
        ),
        repeating-linear-gradient(
            -60deg,
            rgb(107 252 134 / 15%) 0,
            rgb(107 252 134 / 15%) 1px,
            transparent 1px,
            transparent 8px
        );
}

/* Puerta 3 ‚Äî resplandor de fuego */
.puerta-3 .puerta-detalle {
    background: linear-gradient(0deg, rgb(233 69 96 / 25%) 0%, transparent 60%);
    animation: fuego-puerta 2s ease-in-out infinite alternate;
}

@keyframes fuego-puerta {
    0% {
        inset: 40% 10% 15%;
    }

    100% {
        inset: 30% 10% 15%;
    }
}

.puerta-3 .puerta-marco {
    background: repeating-linear-gradient(180deg, #5a2a2a 0, #4a2020 3px, #3a1818 3px, #5a2a2a 6px);
}

/* Puerta 4 ‚Äî ondas de agua */
.puerta-4 .puerta-marco {
    background: #1a2a33;
}

.puerta-4 .puerta-detalle {
    background: repeating-linear-gradient(
        0deg,
        rgb(94 234 219 / 10%) 0,
        rgb(94 234 219 / 10%) 2px,
        transparent 2px,
        transparent 6px
    );
    animation: agua-puerta 3s linear infinite;
}

@keyframes agua-puerta {
    0% {
        transform: translateY(0);
    }

    100% {
        transform: translateY(6px);
    }
}

.puerta-tirador {
    position: absolute;
    width: 6px;
    height: 6px;
    background: #8a7a60;
    border-radius: 50%;
    right: 15%;
    top: 50%;
    box-shadow: 0 0 3px rgb(200 180 120 / 40%);
}

.puerta-brillo {
    position: absolute;
    inset: -4px;
    border-radius: 8px 8px 0 0;
    box-shadow: 0 0 12px rgb(var(--puerta-accent-rgb) / 25%);
    animation: respiracion-puerta 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes respiracion-puerta {
    0%,
    100% {
        opacity: 0.3;
    }

    50% {
        opacity: 0.8;
    }
}

.puerta-numero {
    position: absolute;
    bottom: -22px;
    left: 50%;
    transform: translateX(-50%);
    font-family: var(--font-display);
    font-size: 1.1rem;
    font-weight: bold;
    color: rgb(var(--puerta-accent-rgb) / 60%);
    text-shadow: 0 0 5px rgb(var(--puerta-accent-rgb) / 30%);
    pointer-events: none;
}

/* Posiciones de las puertas */
.puerta-izquierda {
    left: 2%;
}

.puerta-derecha {
    right: 2%;
}

/* --- Sistema de proximidad --- */

.puerta-cerca .puerta-hoja {
    transform: perspective(200px) rotateY(-8deg);
    box-shadow: inset 0 0 10px rgb(0 0 0 / 30%);
}

.puerta-cerca .puerta-brillo {
    box-shadow:
        0 0 16px rgb(var(--puerta-accent-rgb) / 40%),
        0 0 30px rgb(var(--puerta-accent-rgb) / 15%);
    animation-duration: 1.5s;
}

.puerta-cerca .puerta-numero {
    color: var(--puerta-accent);
    text-shadow: 0 0 8px rgb(var(--puerta-accent-rgb) / 50%);
}

@media (hover: hover) and (pointer: fine) {
    .puerta-cerca:hover .puerta-hoja {
        transform: perspective(200px) rotateY(-12deg);
    }

    .puerta-cerca:hover .puerta-brillo {
        box-shadow:
            0 0 22px rgb(var(--puerta-accent-rgb) / 50%),
            0 0 40px rgb(var(--puerta-accent-rgb) / 25%);
    }
}

/* --- Personaje jugador --- */

#personaje-jugador {
    position: absolute;
    width: 12.5%;
    aspect-ratio: 1;
    z-index: 9;
    contain: layout style;
}

.jugador-luz {
    position: absolute;
    inset: -80%;
    background: radial-gradient(ellipse at 50% 50%, rgb(255 220 150 / 8%) 0%, transparent 60%);
    pointer-events: none;
}

.jugador-sombra {
    position: absolute;
    bottom: -15%;
    left: 10%;
    width: 80%;
    height: 30%;
    background: radial-gradient(ellipse at 50% 50%, rgb(0 0 0 / 40%) 0%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
    transition: transform 0.15s;
}

#personaje-jugador img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
    box-shadow: 0 0 10px rgb(0 0 0 / 60%);
    position: relative;
    will-change: transform;
}

/* Animaci√≥n de caminar */
#personaje-jugador.moviendo img {
    animation: jugador-bobbing 0.3s ease-in-out infinite alternate;
}

@keyframes jugador-bobbing {
    0% {
        transform: translateY(0);
    }

    100% {
        transform: translateY(-2px);
    }
}

/* Brillo del personaje seg√∫n selecci√≥n */
#personaje-jugador.jugador-lina img {
    border-color: #9b59b6;
    box-shadow: 0 0 12px rgb(155 89 182 / 50%);
}

#personaje-jugador.jugador-rose img {
    border-color: #2ecc71;
    box-shadow: 0 0 12px rgb(46 204 113 / 50%);
}

#personaje-jugador.jugador-pandajuro img {
    border-color: #c0392b;
    box-shadow: 0 0 12px rgb(192 57 43 / 50%);
}

#personaje-jugador.jugador-hana img {
    border-color: #e91e90;
    box-shadow: 0 0 12px rgb(233 30 144 / 50%);
}

#personaje-jugador.jugador-kira img {
    border-color: #2ec4b6;
    box-shadow: 0 0 12px rgb(46 196 182 / 50%);
}

#personaje-jugador.jugador-donbu img {
    border-color: #d4a052;
    box-shadow: 0 0 12px rgb(212 160 82 / 50%);
}

#personaje-jugador.jugador-pompom img {
    border-color: #f8a5c2;
    box-shadow: 0 0 12px rgb(248 165 194 / 50%);
}

#personaje-jugador.jugador-orejas img {
    border-color: #e67e22;
    box-shadow: 0 0 12px rgb(230 126 34 / 50%);
}

/* --- Controles hint --- */

#controles-hint {
    margin-top: 15px;
    font-size: 0.9rem;
    color: var(--color-texto-apagado);
    animation: parpadeo-hint 2s ease-in-out infinite;
}

@keyframes parpadeo-hint {
    0%,
    100% {
        opacity: 0.5;
    }

    50% {
        opacity: 1;
    }
}

/* --- Modal de confirmaci√≥n --- */

#modal-puerta {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(0 0 0 / 75%);
}

.modal-contenido {
    position: relative;
    background-color: var(--color-superficie);
    border: 2px solid var(--modal-accent, var(--color-accent));
    border-radius: 15px;
    padding: 28px 32px 24px;
    text-align: center;
    box-shadow:
        0 0 40px rgb(0 0 0 / 50%),
        0 0 15px var(--modal-accent, var(--color-accent));
    animation: modal-aparecer 0.3s ease;
    max-width: min(340px, 90vw);
}

@keyframes modal-aparecer {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-puerta-linea {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    border-radius: 15px 15px 0 0;
    background: var(--modal-accent, var(--color-accent));
    box-shadow: 0 0 12px var(--modal-accent, var(--color-accent));
}

.modal-puerta-icono {
    font-size: 3rem;
    line-height: 1;
    margin: 4px 0 8px;
    filter: drop-shadow(0 0 12px var(--modal-accent, var(--color-accent)));
    animation: flotar-icono 2.5s ease-in-out infinite;
}

.modal-puerta-icono-img {
    width: 4.5rem;
    height: 4.5rem;
    object-fit: contain;
    border-radius: 12px;
}

@keyframes flotar-icono {
    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-5px);
    }
}

.modal-puerta-nivel {
    display: inline-block;
    font-family: var(--font-body);
    font-size: 0.65rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    color: var(--modal-accent, var(--color-accent));
    background: rgb(255 255 255 / 6%);
    padding: 3px 12px;
    border-radius: 20px;
    margin-bottom: 4px;
}

.modal-contenido h2 {
    font-family: var(--font-display);
    color: var(--modal-accent, var(--color-accent));
    margin: 0 0 8px;
    text-shadow: 0 0 10px var(--modal-accent, var(--color-accent));
}

.modal-contenido p {
    color: #ccc;
    margin: 0 0 25px;
}

.modal-botones {
    display: flex;
    gap: 15px;
    justify-content: center;
}

#btn-entrar {
    padding: 10px 30px;
    font-size: 1rem;
    border: none;
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: var(--modal-accent, var(--color-accent));
    color: white;
    transition: filter 0.2s;
}

#btn-entrar:hover {
    filter: brightness(0.85);
}

#btn-cancelar {
    padding: 10px 30px;
    font-size: 1rem;
    border: 2px solid var(--color-borde-claro);
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: transparent;
    color: #888;
    transition:
        border-color 0.3s,
        color 0.3s;
}

#btn-cancelar:hover {
    border-color: var(--modal-accent, var(--color-accent));
    color: var(--modal-accent, var(--color-accent));
}

/* Foco de navegaci√≥n con flechas */
.modal-btn-foco {
    outline: 2px solid #fff;
    outline-offset: 3px;
    animation: pulso-foco 1s ease-in-out infinite;
}

@keyframes pulso-foco {
    0%,
    100% {
        outline-color: rgb(255 255 255 / 60%);
    }

    50% {
        outline-color: rgb(255 255 255 / 100%);
    }
}

/* --- Modal de salir (confirmaci√≥n para volver al men√∫) --- */

#modal-salir {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
}

#modal-salir .modal-contenido {
    --modal-accent: #f0a500;
    --modal-fondo: #3e2e0a;
}

.modal-salir-linea {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    border-radius: 15px 15px 0 0;
    background: var(--modal-accent);
    box-shadow: 0 0 12px var(--modal-accent);
}

.modal-salir-icono {
    font-size: 3rem;
    line-height: 1;
    margin: 4px 0 8px;
    animation: flotar-icono 2.5s ease-in-out infinite;
}

.modal-salir-btn-confirmar {
    padding: 10px 30px;
    font-size: 1rem;
    border: 2px solid var(--modal-accent);
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: transparent;
    color: var(--modal-accent);
    transition:
        background-color 0.3s,
        color 0.3s;
}

.modal-salir-btn-confirmar:hover {
    background-color: var(--modal-accent);
    color: #1a1a2e;
}

.modal-salir-btn-cancelar {
    padding: 10px 30px;
    font-size: 1rem;
    border: none;
    border-radius: var(--radio-boton);
    cursor: pointer;
    background-color: var(--modal-accent);
    color: #1a1a2e;
    font-weight: bold;
    transition: filter 0.2s;
}

.modal-salir-btn-cancelar:hover {
    filter: brightness(0.85);
}

/* --- Modal de derrota --- */

.modal-derrota {
    position: absolute;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-derrota-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(10 0 0 / 85%);
    animation: derrota-fondo-aparecer 0.5s ease;
}

@keyframes derrota-fondo-aparecer {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.modal-derrota-caja {
    position: relative;
    background: linear-gradient(180deg, #1a0a0a 0%, #0d0d1a 100%);
    border: 2px solid #8b0000;
    border-radius: 12px;
    padding: 24px 32px;
    text-align: center;
    box-shadow:
        0 0 30px rgb(139 0 0 / 40%),
        inset 0 0 20px rgb(0 0 0 / 50%);
    animation: derrota-caja-aparecer 0.4s ease;
    max-width: min(280px, 85vw);
}

@keyframes derrota-caja-aparecer {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.modal-derrota-caja h2 {
    font-family: var(--font-display);
    color: #c33;
    font-size: 1.2rem;
    margin: 0 0 6px;
    text-shadow: 0 0 12px rgb(200 50 50 / 50%);
}

.modal-derrota-caja p {
    color: #999;
    font-size: 0.85rem;
    margin: 0 0 18px;
}

.modal-derrota-icono {
    font-size: 2.5rem;
    margin-bottom: 8px;
    animation: derrota-pulso 2s ease-in-out infinite;
}

@keyframes derrota-pulso {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

.modal-derrota-btn {
    padding: 10px 28px;
    font-size: 0.9rem;
    font-weight: bold;
    color: #fff;
    background: linear-gradient(180deg, #8b0000 0%, #5a0000 100%);
    border: 2px solid #a22;
    border-radius: 8px;
    cursor: pointer;
    text-shadow: 0 1px 2px rgb(0 0 0 / 50%);
    box-shadow: 0 2px 8px rgb(139 0 0 / 30%);
    transition:
        transform 0.15s,
        box-shadow 0.15s,
        background 0.2s;
}

.modal-derrota-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgb(139 0 0 / 50%);
    background: linear-gradient(180deg, #a11 0%, #6a0000 100%);
}

.modal-derrota-btn:active {
    transform: translateY(1px);
    box-shadow: 0 1px 4px rgb(139 0 0 / 30%);
}

/* --- Barra superior del jugador --- */

.barra-superior {
    display: flex;
    align-items: center;
    gap: 15px;
    background-color: rgb(15 15 30 / 95%);
    border: 2px solid var(--color-borde);
    border-radius: 10px;
    padding: 8px 15px;
    margin-bottom: 15px;
}

.barra-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.barra-jugador img {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
}

.barra-jugador span {
    font-size: 0.9rem;
    font-weight: bold;
    color: var(--color-texto);
}

.barra-vida-jugador {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    min-width: 100px;
}

.barra-vida-corazon {
    font-size: 0.9rem;
    animation: latido 1.2s ease-in-out infinite;
}

@keyframes latido {
    0%,
    100% {
        transform: scale(1);
    }

    15% {
        transform: scale(1.25);
    }

    30% {
        transform: scale(1);
    }
}

.barra-vida-jugador .barra-vida-fondo {
    flex: 1;
    height: 14px;
    border-radius: 7px;
    position: relative;
}

.barra-vida-jugador .barra-vida-relleno {
    border-radius: 7px;
    transition:
        transform 0.4s ease,
        background 0.4s ease;
    position: relative;
    overflow: hidden;
}

.barra-vida-jugador .barra-vida-relleno::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        transparent 0%,
        rgb(255 255 255 / 25%) 50%,
        transparent 100%
    );
    animation: shimmer-vida 2.5s ease-in-out infinite;
}

@keyframes shimmer-vida {
    0% {
        transform: translateX(-100%);
    }

    100% {
        transform: translateX(100%);
    }
}

.barra-vida-texto {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: bold;
    color: white;
    text-shadow: 0 1px 2px rgb(0 0 0 / 60%);
    z-index: 1;
}

.barra-vida-peligro .barra-vida-corazon {
    animation: latido-rapido 0.5s ease-in-out infinite;
}

@keyframes latido-rapido {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.35);
    }
}

.barra-inventario {
    display: flex;
    align-items: center;
    gap: 5px;
    flex-shrink: 0;
}

.inventario-slot {
    width: 28px;
    height: 28px;
    border: 2px solid rgb(255 255 255 / 8%);
    border-radius: 6px;
    background-color: rgb(255 255 255 / 3%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    line-height: 1;
    transition:
        border-color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s;
}

.inventario-slot-lleno {
    border-color: var(--slot-color);
    background-color: rgb(255 255 255 / 6%);
    box-shadow:
        0 0 8px var(--slot-color),
        inset 0 0 6px rgb(0 0 0 / 30%);
    animation: slot-aparecer 0.4s ease;
}

@keyframes slot-aparecer {
    0% {
        transform: scale(0.5);
        opacity: 0;
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Colores de borde de avatar seg√∫n personaje */
.barra-lina .barra-jugador img {
    border-color: #9b59b6;
}

.barra-rose .barra-jugador img {
    border-color: #2ecc71;
}

.barra-pandajuro .barra-jugador img {
    border-color: #c0392b;
}

.barra-hana .barra-jugador img {
    border-color: #e91e90;
}

.barra-kira .barra-jugador img {
    border-color: #2ec4b6;
}

.barra-donbu .barra-jugador img {
    border-color: #d4a052;
}

/* --- Habitaci√≥n 1: El Laberinto --- */

/* --- Paletas por habitaci√≥n --- */

.habitacion-1 {
    --hab-pared: #2a1a3e;
    --hab-pared-medio: #1a102e;
    --hab-pared-oscuro: #150d24;
    --hab-borde: rgb(100 60 150 / 20%);
    --hab-accent: #bb86fc;
}

.habitacion-2 {
    --hab-pared: #1a3e1a;
    --hab-pared-medio: #102e10;
    --hab-pared-oscuro: #0d240d;
    --hab-borde: rgb(60 150 80 / 20%);
    --hab-accent: #6bfc86;
}

.habitacion-3 {
    --hab-pared: #3e1a1a;
    --hab-pared-medio: #2e1010;
    --hab-pared-oscuro: #240d0d;
    --hab-borde: rgb(150 60 60 / 20%);
    --hab-accent: #e94560;
}

.habitacion-4 {
    --hab-pared: #1a1a3e;
    --hab-pared-medio: #10102e;
    --hab-pared-oscuro: #0d0d24;
    --hab-borde: rgb(60 80 150 / 20%);
    --hab-accent: #5eeadb;
}

/* --- Habitaci√≥n 4: El Abismo (platformer) --- */

#pantalla-habitacion4 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

#canvas-platformer {
    display: block;
    image-rendering: pixelated;
    border: 3px solid var(--hab-borde);
    border-radius: 8px;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%);
}

#pantalla-habitacion1 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Cabecera: bot√≥n huir + t√≠tulo en una sola fila */
.cabecera-habitacion {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0 0 2px;
    width: 100%;
    justify-content: center;
}

.titulo-habitacion {
    font-family: var(--font-display);
    color: var(--color-accent);
    font-size: 1.3rem;
    margin: 0;
    text-shadow: 0 0 10px rgb(233 69 96 / 50%);
}

#laberinto-indicador,
#laberinto3d-indicador {
    font-size: 0.95rem;
    color: #aaa;
    margin: 2px 0 6px;
    transition:
        color 0.3s,
        text-shadow 0.3s;
}

#laberinto-indicador.llave-obtenida,
#laberinto3d-indicador.llave-obtenida {
    color: var(--color-dorado);
    text-shadow: 0 0 10px rgb(255 215 0 / 60%);
    animation: brillo-llave 1.5s ease-in-out infinite;
}

@keyframes brillo-llave {
    0%,
    100% {
        text-shadow: 0 0 10px rgb(255 215 0 / 40%);
    }

    50% {
        text-shadow:
            0 0 20px rgb(255 215 0 / 80%),
            0 0 30px rgb(255 215 0 / 30%);
    }
}

/* Contenedor del laberinto (dimensiones se setean desde JS) */
#laberinto {
    position: relative;
    background-color: var(--color-oscuro);
    touch-action: none;
    contain: layout paint;
    border: 3px solid var(--color-borde);
    border-radius: 8px;
    overflow: hidden;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%);
}

/* Paredes del laberinto */
.laberinto-pared {
    position: absolute;
    background: linear-gradient(
        135deg,
        var(--hab-pared) 0%,
        var(--hab-pared-medio) 50%,
        var(--hab-pared-oscuro) 100%
    );
    border: 1px solid var(--hab-borde);
    box-shadow: inset 0 0 6px rgb(0 0 0 / 40%);
}

/* Trampas del laberinto */
.laberinto-trampa {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    border-radius: 3px;
    background-color: rgb(80 30 30 / 25%);
    transition:
        background-color 0.2s,
        box-shadow 0.2s;
}

.laberinto-trampa::after {
    content: 'üî•';
    font-size: 0.9rem;
    opacity: 0.15;
    transition: opacity 0.2s;
}

.laberinto-trampa.trampa-activa {
    background-color: rgb(200 50 30 / 45%);
    box-shadow: inset 0 0 10px rgb(255 50 30 / 50%);
}

.laberinto-trampa.trampa-activa::after {
    opacity: 1;
    animation: trampa-fuego 0.4s ease-in-out infinite alternate;
}

@keyframes trampa-fuego {
    from {
        transform: scale(1);
    }

    to {
        transform: scale(1.3);
    }
}

/* Trampas de lentitud */
.laberinto-trampa-lenta {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    border-radius: 3px;
    background-color: rgb(30 50 80 / 25%);
    transition:
        background-color 0.3s,
        box-shadow 0.3s;
}

.laberinto-trampa-lenta::after {
    content: 'üï∏Ô∏è';
    font-size: 0.9rem;
    opacity: 0.15;
    transition: opacity 0.3s;
}

.laberinto-trampa-lenta.trampa-lenta-activa {
    background-color: rgb(80 140 220 / 35%);
    box-shadow: inset 0 0 10px rgb(100 180 255 / 40%);
}

.laberinto-trampa-lenta.trampa-lenta-activa::after {
    opacity: 1;
    animation: trampa-lenta-pulso 0.6s ease-in-out infinite alternate;
}

@keyframes trampa-lenta-pulso {
    from {
        transform: scale(1);
        filter: brightness(1);
    }

    to {
        transform: scale(1.2);
        filter: brightness(1.4);
    }
}

/* Efecto de lentitud en el jugador */
.jugador-lento img {
    filter: brightness(0.7) saturate(0.5) hue-rotate(200deg) !important;
    animation: jugador-lento-pulso 0.8s ease-in-out infinite !important;
}

@keyframes jugador-lento-pulso {
    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

/* Texto flotante de efecto */
.efecto-flotante {
    position: absolute;
    font-weight: bold;
    font-size: 0.85rem;
    z-index: 10;
    pointer-events: none;
    animation: dano-subir 1s ease-out forwards;
}

.efecto-lentitud {
    color: #7cb8ff;
    text-shadow: 0 0 6px rgb(100 180 255 / 70%);
}

/* Flash al recibir da√±o de trampa */
.jugador-golpeado img {
    animation: golpe-flash 0.3s ease !important;
}

@keyframes golpe-flash {
    0% {
        filter: brightness(1);
    }

    25% {
        filter: brightness(3) saturate(0);
    }

    50% {
        filter: brightness(1) sepia(1) saturate(5) hue-rotate(-30deg);
    }

    100% {
        filter: brightness(1);
    }
}

/* N√∫mero de da√±o flotante */
.dano-flotante {
    position: absolute;
    font-family: var(--font-display);
    color: #f44;
    font-weight: bold;
    font-size: 1.4rem;
    z-index: 10;
    pointer-events: none;
    text-shadow:
        0 0 8px rgb(255 0 0 / 80%),
        0 2px 4px rgb(0 0 0 / 50%);
    animation: dano-subir 1s ease-out forwards;
}

@keyframes dano-subir {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1.5);
    }

    30% {
        opacity: 1;
        transform: translateY(-10px) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-35px) scale(0.8);
    }
}

/* Screen shake al recibir da√±o */
.screen-shake {
    animation: screen-shake 0.3s ease;
}

@keyframes screen-shake {
    0%,
    100% {
        transform: translate(0);
    }

    15% {
        transform: translate(-4px, 2px);
    }

    30% {
        transform: translate(4px, -2px);
    }

    45% {
        transform: translate(-3px, -1px);
    }

    60% {
        transform: translate(3px, 1px);
    }

    75% {
        transform: translate(-1px, 2px);
    }
}

/* Vi√±eta roja al recibir da√±o */
.vineta-dano::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    box-shadow: inset 0 0 40px rgb(233 69 96 / 60%);
    pointer-events: none;
    z-index: 20;
    animation: vineta-flash 0.4s ease-out forwards;
}

@keyframes vineta-flash {
    0% {
        opacity: 1;
    }

    100% {
        opacity: 0;
    }
}

/* Trasgo (enemigo) en el laberinto */
.trasgo-laberinto {
    position: absolute;
    z-index: 4;
    transform: scale(1.6);
}

.trasgo-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #666;
    box-shadow: 0 0 8px rgb(150 150 150 / 40%);
}

/* Glow animado GPU-composited (opacity en vez de box-shadow) */
.trasgo-laberinto::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    box-shadow: 0 0 14px rgb(200 80 80 / 60%);
    animation: pulso-opacity 2s ease-in-out infinite;
    pointer-events: none;
}

/* Villano √©lite en el laberinto */
.elite-laberinto {
    position: absolute;
    z-index: 4;
}

.elite-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #a855f7;
    box-shadow: 0 0 8px rgb(168 85 247 / 40%);
}

/* Glow p√∫rpura pulsante */
.elite-laberinto::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 50%;
    box-shadow: 0 0 14px rgb(168 85 247 / 60%);
    animation: pulso-opacity 2s ease-in-out infinite;
    pointer-events: none;
}

/* Animaci√≥n de aparici√≥n */
.elite-aparicion {
    animation: elite-spawn 0.5s ease-out;
}

@keyframes elite-spawn {
    from {
        transform: scale(0);
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* --- Countdown de amenaza: ring en esquina + borde pulsante --- */

/* Ring peque√±o en esquina superior derecha */
.countdown-elite {
    position: absolute;
    top: 6px;
    right: 6px;
    z-index: 15;
    display: flex;
    flex-direction: column;
    align-items: center;
    pointer-events: none;
    animation: countdown-aparecer 0.6s ease-out;
}

@keyframes countdown-aparecer {
    from {
        opacity: 0;
        transform: scale(0.5);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

.countdown-anillo-wrap {
    position: relative;
    width: 52px;
    height: 52px;
    filter: drop-shadow(0 0 6px rgb(168 85 247 / 50%));
}

.countdown-anillo {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.countdown-pista {
    fill: none;
    stroke: rgb(168 85 247 / 15%);
    stroke-width: 6;
}

.countdown-progreso {
    fill: none;
    stroke: #a855f7;
    stroke-width: 6;
    stroke-linecap: round;
    transition:
        stroke-dashoffset 0.8s ease-in-out,
        stroke 0.5s ease;
}

.countdown-numero {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: #c084fc;
    text-shadow: 0 0 8px rgb(168 85 247 / 70%);
    transition:
        color 0.5s ease,
        text-shadow 0.5s ease;
}

.countdown-tick {
    animation: countdown-tick 0.3s ease-out;
}

@keyframes countdown-tick {
    0% {
        transform: scale(1.3);
        opacity: 0.6;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.countdown-texto {
    font-family: var(--font-body);
    font-size: 0.5rem;
    font-weight: 700;
    color: rgb(192 132 252 / 70%);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-top: 2px;
    text-shadow: 0 0 6px rgb(168 85 247 / 40%);
    transition: color 0.5s ease;
}

/* --- Borde del laberinto pulsante durante countdown --- */

.laberinto-amenaza {
    border-color: rgb(168 85 247 / 40%) !important;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%),
        0 0 12px rgb(168 85 247 / 25%),
        inset 0 0 12px rgb(168 85 247 / 10%) !important;
    animation: borde-amenaza 2s ease-in-out infinite !important;
}

@keyframes borde-amenaza {
    0%,
    100% {
        border-color: rgb(168 85 247 / 25%);
    }

    50% {
        border-color: rgb(168 85 247 / 50%);
    }
}

/* --- Estado urgente (√∫ltimos 3 segundos) --- */

.countdown-urgente .countdown-progreso {
    stroke: #ef4444;
}

.countdown-urgente .countdown-anillo-wrap {
    filter: drop-shadow(0 0 8px rgb(239 68 68 / 60%));
    animation: countdown-sacudir 0.4s ease-in-out infinite;
}

.countdown-urgente .countdown-numero {
    color: #f87171;
    text-shadow: 0 0 10px rgb(239 68 68 / 90%);
    animation: countdown-pulso-num 0.5s ease-in-out infinite;
}

.countdown-urgente .countdown-texto {
    color: rgb(248 113 113 / 90%);
}

.laberinto-amenaza-urgente {
    border-color: rgb(239 68 68 / 50%) !important;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%),
        0 0 15px rgb(239 68 68 / 35%),
        inset 0 0 15px rgb(239 68 68 / 15%) !important;
    animation: borde-amenaza-urgente 0.6s ease-in-out infinite !important;
}

@keyframes borde-amenaza-urgente {
    0%,
    100% {
        border-color: rgb(239 68 68 / 30%);
    }

    50% {
        border-color: rgb(239 68 68 / 60%);
    }
}

@keyframes countdown-sacudir {
    0%,
    100% {
        transform: translateX(0);
    }

    25% {
        transform: translateX(-2px) rotate(-1deg);
    }

    75% {
        transform: translateX(2px) rotate(1deg);
    }
}

@keyframes countdown-pulso-num {
    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.15);
    }
}

/* Animaci√≥n de salida al llegar a 0 */
.countdown-salida {
    animation: countdown-salida 0.4s ease-in forwards;
}

@keyframes countdown-salida {
    from {
        opacity: 1;
        transform: scale(1);
    }

    to {
        opacity: 0;
        transform: scale(0.3);
    }
}

/* Llave */
.laberinto-llave {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    animation: flotar-llave 2s ease-in-out infinite;
    z-index: 2;
}

@keyframes flotar-llave {
    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-4px);
    }
}

/* Animaci√≥n al recoger la llave */
.laberinto-llave.llave-recogida {
    animation: absorber-llave 0.5s ease-in forwards;
    pointer-events: none;
}

@keyframes absorber-llave {
    0% {
        transform: scale(1);
        opacity: 1;
    }

    50% {
        transform: scale(1.5);
        opacity: 0.7;
    }

    100% {
        transform: scale(0);
        opacity: 0;
    }
}

/* Salida */
.laberinto-salida {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    z-index: 1;
    opacity: 0.6;
}

/* Jugador dentro del laberinto (escala visual se aplica desde JS seg√∫n estatura) */
.jugador-laberinto {
    position: absolute;
    z-index: 5;
}

.jugador-laberinto img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #888;
    box-shadow: 0 0 8px rgb(0 0 0 / 60%);
}

/* Colores del jugador en el laberinto */
.jugador-laberinto.jugador-lina img {
    border-color: #9b59b6;
    box-shadow: 0 0 10px rgb(155 89 182 / 50%);
}

.jugador-laberinto.jugador-rose img {
    border-color: #2ecc71;
    box-shadow: 0 0 10px rgb(46 204 113 / 50%);
}

.jugador-laberinto.jugador-pandajuro img {
    border-color: #c0392b;
    box-shadow: 0 0 10px rgb(192 57 43 / 50%);
}

.jugador-laberinto.jugador-hana img {
    border-color: #e91e90;
    box-shadow: 0 0 10px rgb(233 30 144 / 50%);
}

.jugador-laberinto.jugador-kira img {
    border-color: #2ec4b6;
    box-shadow: 0 0 10px rgb(46 196 182 / 50%);
}

.jugador-laberinto.jugador-donbu img {
    border-color: #d4a052;
    box-shadow: 0 0 10px rgb(212 160 82 / 50%);
}

.jugador-laberinto.jugador-pompom img {
    border-color: #f8a5c2;
    box-shadow: 0 0 10px rgb(248 165 194 / 50%);
}

.jugador-laberinto.jugador-orejas img {
    border-color: #e67e22;
    box-shadow: 0 0 10px rgb(230 126 34 / 50%);
}

/* Mensaje de √©xito */
#laberinto-mensaje,
#laberinto3d-mensaje {
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: #4cff4c;
    margin: 4px 0;
    text-shadow: 0 0 15px rgb(76 255 76 / 50%);
    animation: aparecer-mensaje 0.4s ease;
}

@keyframes aparecer-mensaje {
    from {
        transform: scale(0.5);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

/* Hint del laberinto */
.laberinto-hint {
    margin-top: 4px;
    font-size: 0.85rem;
    color: var(--color-texto-muy-apagado);
    animation: parpadeo-hint 2s ease-in-out infinite;
}

/* Bot√≥n huir: icono circular con imagen de puerta m√°gica */
.btn-huir {
    width: 44px;
    height: 44px;
    padding: 0;
    border: 2px solid rgb(240 165 0 / 30%);
    border-radius: 50%;
    cursor: pointer;
    background-color: rgb(240 165 0 / 8%);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
    transition:
        border-color 0.3s,
        background-color 0.3s,
        box-shadow 0.3s,
        transform 0.2s;
}

.btn-huir::after {
    content: '';
    position: absolute;
    inset: -3px;
    border-radius: 50%;
    border: 1px solid rgb(240 165 0 / 0%);
    transition: border-color 0.3s;
    pointer-events: none;
}

.btn-huir:hover {
    border-color: rgb(240 165 0 / 60%);
    background-color: rgb(240 165 0 / 15%);
    box-shadow:
        0 0 12px rgb(240 165 0 / 30%),
        0 0 24px rgb(240 165 0 / 10%);
    transform: scale(1.08);
}

.btn-huir:hover::after {
    border-color: rgb(240 165 0 / 20%);
}

.btn-huir:active {
    transform: scale(0.95);
    border-color: rgb(240 165 0 / 80%);
    box-shadow: 0 0 16px rgb(240 165 0 / 40%);
}

.btn-huir-icono {
    width: 32px;
    height: 32px;
    object-fit: contain;
    border-radius: 50%;
    filter: drop-shadow(0 0 4px rgb(240 165 0 / 40%));
    transition: filter 0.3s;
    pointer-events: none;
}

.btn-huir:hover .btn-huir-icono {
    filter: drop-shadow(0 0 8px rgb(240 165 0 / 60%));
}

/* --- Habitaci√≥n 2: El Laberinto 3D --- */

#pantalla-habitacion2 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

#contenedor-3d {
    position: relative;
    contain: layout paint;
    border: 3px solid var(--color-borde);
    border-radius: 8px;
    overflow: hidden;
    box-shadow:
        inset 0 0 40px rgb(0 0 0 / 60%),
        0 0 15px rgb(0 0 0 / 50%);
}

#canvas-3d {
    display: block;
}

#canvas-minimapa {
    position: absolute;
    top: 8px;
    right: 8px;
    border: 2px solid rgb(150 100 200 / 40%);
    border-radius: 4px;
    opacity: 0.85;
}

/* --- Transiciones entre pantallas --- */

.transicion-overlay {
    position: fixed;
    inset: 0;
    z-index: 200;
    pointer-events: none;
    opacity: 0;
}

/* Fade: oscurecer a negro */
.transicion-fade-in {
    background-color: var(--color-oscuro);
    opacity: 0;
    pointer-events: all;
    animation: fade-in 0.4s ease forwards;
}

.transicion-fade-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: fade-out 0.4s ease forwards;
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes fade-out {
    from {
        opacity: 1;
    }

    to {
        opacity: 0;
    }
}

/* Wipe: cortina horizontal de izquierda a derecha */
.transicion-wipe-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-in 0.4s ease forwards;
}

.transicion-wipe-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: wipe-out 0.4s ease forwards;
}

@keyframes wipe-in {
    from {
        clip-path: inset(0 100% 0 0);
    }

    to {
        clip-path: inset(0 0 0 0);
    }
}

@keyframes wipe-out {
    from {
        clip-path: inset(0 0 0 0);
    }

    to {
        clip-path: inset(0 0 0 100%);
    }
}

/* Iris: c√≠rculo que se cierra y abre (estilo cartoon) */
.transicion-iris-in {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-in 0.5s ease forwards;
}

.transicion-iris-out {
    background-color: var(--color-oscuro);
    opacity: 1;
    pointer-events: all;
    animation: iris-out 0.5s ease forwards;
}

@keyframes iris-in {
    from {
        clip-path: circle(100% at 50% 50%);
    }

    to {
        clip-path: circle(0% at 50% 50%);
    }
}

@keyframes iris-out {
    from {
        clip-path: circle(0% at 50% 50%);
    }

    to {
        clip-path: circle(100% at 50% 50%);
    }
}

/* --- D-pad virtual (touch) --- */

.dpad-contenedor {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 150;
    display: grid;
    grid-template:
        '.     arriba  .      ' 56px
        'izq   .       der    ' 56px
        '.     abajo   .      ' 56px
        / 56px 56px 56px;
    gap: 4px;
}

.dpad-btn {
    width: 56px;
    height: 56px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 12px;
    background-color: rgb(15 15 30 / 75%);
    color: rgb(255 255 255 / 60%);
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: none;
    user-select: none;
    transition:
        background-color 0.1s,
        border-color 0.1s;
}

.dpad-btn:active {
    background-color: rgb(233 69 96 / 40%);
    border-color: var(--color-accent);
    color: white;
}

.dpad-arriba {
    grid-area: arriba;
}

.dpad-izquierda {
    grid-area: izq;
}

.dpad-derecha {
    grid-area: der;
}

.dpad-abajo {
    grid-area: abajo;
}

/* Ocultar D-pad en dispositivos sin touch */
@media (hover: hover) and (pointer: fine) {
    .dpad-contenedor {
        display: none !important;
    }
}

/* Ocultar D-pad cuando un libro (heroario/villanario) est√° abierto */
body:has(.libro-modal:not(.oculto)) .dpad-contenedor {
    display: none !important;
}

/* --- Notificaciones toast --- */

.toast-contenedor {
    position: fixed;

    /* Anclar al borde derecho del √°rea de juego (800px centrado) */
    right: max(10px, calc(50vw - 400px + 10px));
    top: 50%;
    transform: translateY(-50%);
    z-index: 300;
    display: flex;
    flex-direction: column;
    gap: 6px;
    pointer-events: none;
    width: 52px;
    align-items: flex-end;
}

/* En modo inmersivo (habitaciones 3D) el juego es full-width */
#juego.juego-inmersivo ~ .toast-contenedor {
    right: 10px;
}

/* Toast: dise√±o compacto tipo badge de juego */
.toast {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    padding: 0;
    background-color: rgb(10 10 25 / 90%);
    border: 2px solid var(--toast-color);
    border-radius: 12px;
    box-shadow:
        0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
        0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
        inset 0 1px 0 rgb(255 255 255 / 8%);
    pointer-events: auto;
    cursor: default;
    position: relative;
    animation: toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    transition:
        opacity 0.3s ease,
        transform 0.3s ease;
}

/* Efecto de resplandor pulsante en el toast activo (el m√°s reciente) */
.toast:last-child {
    animation:
        toast-entrada 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
        toast-pulso 2s ease-in-out 0.35s infinite;
}

/* Los toasts m√°s viejos se aten√∫an */
.toast:not(:last-child) {
    opacity: 0.5;
    transform: scale(0.85);
}

.toast-icono {
    font-size: 1.3rem;
    line-height: 1;
    flex-shrink: 0;
    filter: drop-shadow(0 0 4px var(--toast-color));
}

/* Tooltip con el mensaje ‚Äî aparece al hacer hover */
.toast-mensaje {
    position: absolute;
    right: calc(100% + 8px);
    top: 50%;
    transform: translateY(-50%);
    white-space: nowrap;
    font-size: 0.75rem;
    font-weight: 700;
    color: rgb(255 255 255 / 95%);
    background-color: rgb(10 10 25 / 95%);
    border: 1px solid var(--toast-color);
    border-radius: 8px;
    padding: 6px 12px;
    box-shadow:
        0 4px 12px rgb(0 0 0 / 50%),
        0 0 8px color-mix(in srgb, var(--toast-color) 30%, transparent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
}

/* Flechita del tooltip */
.toast-mensaje::after {
    content: '';
    position: absolute;
    right: -5px;
    top: 50%;
    transform: translateY(-50%) rotate(45deg);
    width: 8px;
    height: 8px;
    background-color: rgb(10 10 25 / 95%);
    border-right: 1px solid var(--toast-color);
    border-top: 1px solid var(--toast-color);
}

.toast:hover .toast-mensaje {
    opacity: 1;
}

/* En touch el mensaje se muestra brevemente al aparecer */
.toast-mostrar-mensaje .toast-mensaje {
    opacity: 1;
}

@keyframes toast-entrada {
    from {
        transform: translateX(30px) scale(0.5);
        opacity: 0;
    }

    to {
        transform: translateX(0) scale(1);
        opacity: 1;
    }
}

@keyframes toast-pulso {
    0%,
    100% {
        box-shadow:
            0 0 12px color-mix(in srgb, var(--toast-color) 50%, transparent),
            0 0 24px color-mix(in srgb, var(--toast-color) 20%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 8%);
    }

    50% {
        box-shadow:
            0 0 16px color-mix(in srgb, var(--toast-color) 70%, transparent),
            0 0 32px color-mix(in srgb, var(--toast-color) 35%, transparent),
            inset 0 1px 0 rgb(255 255 255 / 12%);
    }
}

.toast.toast-salida {
    animation: toast-salida 0.3s ease forwards;
}

@keyframes toast-salida {
    from {
        transform: translateX(0) scale(1);
        opacity: 1;
    }

    to {
        transform: translateX(20px) scale(0.7);
        opacity: 0;
    }
}

/* --- Utilidades --- */

.oculto {
    display: none !important;
}

/* ============================================================
   LIBRO DE VILLANOS ‚Äî Bestiario con √≠ndice y detalle
   ============================================================ */

/* Layout del libro ‚Äî grimorio antiguo */
.libro-villanos,
.libro-heroes {
    display: flex;
    width: 700px;
    height: 680px;
    max-width: 100%;
    max-height: calc(90vh - 40px);
    margin: 0 auto;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid rgb(255 215 0 / 25%);
    box-shadow:
        0 8px 32px rgb(0 0 0 / 50%),
        0 0 18px var(--v-glow, rgb(233 69 96 / 15%));
    transition: box-shadow 0.5s;
}

.libro-villanos {
    animation: libro-entrada 0.5s ease;
}

.libro-heroes {
    flex: 1;
    min-height: 0;
}

@keyframes libro-entrada {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* P√°ginas */
.libro-pagina {
    padding: 20px;
}

.libro-pagina-izq {
    flex: 0 0 200px;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 20% 80%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 20%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to right, transparent 70%, rgb(0 0 0 / 15%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    border-right: none;
    display: flex;
    flex-direction: column;
}

.libro-pagina-der {
    flex: 1;
    position: relative;
    padding: 28px 32px 0;
    background:
        repeating-linear-gradient(135deg, rgb(120 100 70 / 2%) 0, transparent 2px, transparent 8px),
        radial-gradient(ellipse at 70% 30%, rgb(80 60 30 / 8%) 0%, transparent 60%),
        radial-gradient(ellipse at 30% 70%, rgb(60 50 25 / 6%) 0%, transparent 50%),
        linear-gradient(to left, transparent 70%, rgb(0 0 0 / 12%)),
        linear-gradient(135deg, #1c1510 0%, #18120d 50%, #140f0a 100%);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Tintado del villano en p√°gina derecha */
.libro-pagina-der::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse at center 30%,
        var(--v-tenue, transparent) 0%,
        transparent 70%
    );
    pointer-events: none;
    z-index: 0;
}

/* Lomo decorativo ‚Äî cuero c√°lido */
.libro-lomo {
    flex: 0 0 22px;
    background: linear-gradient(
        90deg,
        #1a1008 0%,
        #2a1c10 30%,
        #3a2818 50%,
        #2a1c10 70%,
        #1a1008 100%
    );
    box-shadow:
        inset 2px 0 6px rgb(0 0 0 / 50%),
        inset -2px 0 6px rgb(0 0 0 / 50%);
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    padding: 20px 0;
}

/* Costuras doradas del lomo */
.libro-lomo-costura {
    height: 1px;
    margin: 0 3px;
    background: linear-gradient(
        90deg,
        transparent,
        rgb(255 215 0 / 30%),
        rgb(255 215 0 / 50%),
        rgb(255 215 0 / 30%),
        transparent
    );
}

/* T√≠tulo del libro ‚Äî dorado */
.libro-titulo {
    font-family: var(--font-display);
    color: var(--color-dorado);
    font-size: 1.15rem;
    text-align: left;
    padding-left: 10px;
    margin: 0 0 8px;
    text-shadow:
        0 0 8px rgb(255 215 0 / 30%),
        0 1px 2px rgb(0 0 0 / 60%);
}

/* Subt√≠tulo del libro */
.libro-subtitulo {
    font-family: var(--font-display);
    color: rgb(255 215 0 / 50%);
    font-size: 0.75rem;
    text-align: left;
    padding-left: 10px;
    margin: -4px 0 8px;
    font-style: italic;
    letter-spacing: 0.5px;
}

/* Ornamentos decorativos ‚Äî dorados con diamante */
.libro-ornamento {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgb(255 215 0 / 30%), transparent);
    margin: 6px 0;
    position: relative;
}

.libro-ornamento::after {
    content: '\25C6';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.5rem;
    color: rgb(255 215 0 / 40%);
    line-height: 1;
}

/* √çndice */
.libro-indice {
    list-style: none;
    padding: 0;
    margin: 8px 0;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.libro-indice-item {
    padding: 8px 10px;
    font-size: 0.8rem;
    color: rgb(180 165 140);
    border-radius: 6px;
    border-left: 2px solid transparent;
    cursor: pointer;
    text-align: left;
    transition:
        background-color 0.2s,
        color 0.2s,
        border-color 0.2s;
    outline: none;
}

.libro-indice-item:hover {
    background-color: rgb(255 255 255 / 5%);
    color: rgb(220 200 170);
}

.libro-indice-item:focus-visible {
    outline: 2px dashed rgb(255 215 0 / 40%);
    outline-offset: -2px;
}

.libro-indice-activo {
    background-color: var(--v-tenue, rgb(255 215 0 / 10%));
    color: var(--v-color, var(--color-dorado));
    border-left-color: var(--v-color, var(--color-dorado));
    font-weight: bold;
}

/* Separador entre tiers ‚Äî l√≠nea dorada con diamante */
.libro-indice-sep {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgb(255 215 0 / 25%), transparent);
    margin: 6px 8px;
    position: relative;
    pointer-events: none;
}

.libro-indice-sep::after {
    content: '\25C6';
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.45rem;
    color: rgb(255 215 0 / 40%);
    background: var(--color-fondo-principal, #1a1a2e);
    padding: 0 4px;
    line-height: 1;
}

/* Contenido del villano */
.libro-detalle-wrap {
    flex: 1;
    min-height: 0;
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    perspective: 1200px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

.libro-detalle-contenido {
    text-align: center;
    padding: 12px 20px;
    display: flex;
    flex-direction: column;
    height: 100%;
}

/* --- Tabs Perfil / Habilidades --- */
.libro-tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 10px;
}

.libro-tab {
    background: none;
    border: none;
    border-bottom: 2px solid transparent;
    color: rgb(180 165 140 / 50%);
    font-family: var(--font-display);
    font-size: 0.75rem;
    padding: 4px 14px;
    cursor: pointer;
    letter-spacing: 0.05em;
    transition:
        color 0.2s,
        border-color 0.2s;
}

.libro-tab:hover {
    color: rgb(200 185 160);
}

.libro-tab-activo {
    color: var(--v-color, var(--color-dorado));
    border-bottom-color: var(--v-color, var(--color-dorado));
}

/* --- Paneles --- */
.libro-panel {
    display: none;
}

.libro-panel-activo {
    display: flex;
    flex-direction: column;
    flex: 1;
    animation: libro-panel-entrada 0.25s ease;
}

@keyframes libro-panel-entrada {
    from {
        opacity: 0;
        transform: translateY(4px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.libro-detalle-contenido .avatar {
    margin-bottom: 4px;
}

/* Avatar mini para panel de habilidades */
.libro-avatar-mini img {
    width: 48px;
    height: 48px;
}

.libro-detalle-contenido .avatar img {
    width: 120px;
    height: 120px;
}

.libro-detalle-cabecera {
    margin-bottom: 4px;
}

.libro-detalle-cabecera h3 {
    font-family: var(--font-display);
    color: var(--v-color, #999);
    font-size: 1.4rem;
    margin: 4px 0 2px;
    text-shadow: 0 0 10px var(--v-glow, transparent);
    transition:
        color 0.5s,
        text-shadow 0.5s;
}

/* Descripci√≥n grande (panel perfil) */
.libro-descripcion-grande {
    display: block;
    -webkit-line-clamp: unset;
    font-size: 0.9rem;
    line-height: 1.6;
    color: rgb(210 195 170);
    font-style: italic;
    text-align: left;
    margin: 8px 0 0;
    white-space: pre-line;
    flex: 1;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgb(255 215 0 / 25%) transparent;
}

.libro-descripcion-grande::-webkit-scrollbar {
    width: 4px;
}

.libro-descripcion-grande::-webkit-scrollbar-track {
    background: transparent;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb {
    background: rgb(255 215 0 / 25%);
    border-radius: 2px;
}

.libro-descripcion-grande::-webkit-scrollbar-thumb:hover {
    background: rgb(255 215 0 / 40%);
}

.libro-detalle-contenido .stats {
    text-align: left;
    padding-top: 0;
}

/* Esquinas ornamentales doradas */
.libro-esquina {
    position: absolute;
    width: 20px;
    height: 20px;
    opacity: 0.4;
    pointer-events: none;
    z-index: 1;
    transition: opacity 0.3s;
}

.libro-villanos:hover .libro-esquina,
.libro-heroes:hover .libro-esquina {
    opacity: 0.7;
}

.libro-esquina-tl {
    top: 8px;
    left: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-tr {
    top: 8px;
    right: 8px;
    border-top: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-bl {
    bottom: 8px;
    left: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-left: 2px solid rgb(255 215 0 / 50%);
}

.libro-esquina-br {
    bottom: 8px;
    right: 8px;
    border-bottom: 2px solid rgb(255 215 0 / 50%);
    border-right: 2px solid rgb(255 215 0 / 50%);
}

/* Page curl ‚Äî puntita inferior derecha */
.libro-page-curl {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 40px;
    height: 40px;
    z-index: 4;
    pointer-events: none;
    border-radius: 0 0 8px;
    transform-origin: bottom right;
    animation: page-curl-idle 4s ease-in-out infinite;
}

/* Reverso de la p√°gina (color crema claro) */
.libro-page-curl::before {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(315deg, #3d3225 0%, #2e2418 40%, #241c12 100%);
    clip-path: polygon(100% 0%, 100% 100%, 0% 100%);
    box-shadow: -3px -3px 6px rgb(0 0 0 / 50%);
}

/* L√≠nea de pliegue diagonal + brillo */
.libro-page-curl::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        315deg,
        rgb(255 235 200 / 15%) 0%,
        rgb(255 215 0 / 10%) 30%,
        transparent 50%
    );
    clip-path: polygon(100% 0%, 100% 100%, 0% 100%);
}

@keyframes page-curl-idle {
    0%,
    100% {
        transform: scale(1) rotate(0deg);
    }

    50% {
        transform: scale(1.15) rotate(-2deg) translate(-2px, -2px);
    }
}

/* Volteo 3D de p√°gina */
@keyframes libro-flip-out {
    0% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: -4px 0 16px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: -20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(-90deg);
        opacity: 0;
        box-shadow: -2px 0 8px rgb(0 0 0 / 0%);
    }
}

@keyframes libro-flip-in {
    0% {
        transform: rotateY(90deg);
        opacity: 0;
        box-shadow: 20px 0 30px rgb(0 0 0 / 0%);
    }

    40% {
        opacity: 1;
        box-shadow: 20px 0 30px rgb(0 0 0 / 40%);
    }

    100% {
        transform: rotateY(0deg);
        opacity: 1;
        box-shadow: 0 0 0 rgb(0 0 0 / 0%);
    }
}

.libro-fade-out {
    transform-origin: left center;
    animation: libro-flip-out 0.3s ease-in forwards;
}

.libro-fade-in {
    transform-origin: right center;
    animation: libro-flip-in 0.35s ease-out;
}

/* Navegaci√≥n */
.libro-navegacion {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 10px 0 12px;
    flex-shrink: 0;
    border-top: 1px solid rgb(255 215 0 / 10%);
    z-index: 2;
}

.libro-nav-btn {
    width: 32px;
    height: 32px;
    border: 2px solid rgb(255 215 0 / 20%);
    border-radius: 50%;
    background-color: transparent;
    color: rgb(200 185 160);
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-nav-btn:hover:not(:disabled) {
    border-color: var(--v-color, var(--color-accent));
    color: var(--v-color, var(--color-accent));
    background-color: var(--v-tenue, rgb(233 69 96 / 10%));
}

.libro-nav-btn:disabled {
    opacity: 0.25;
    cursor: default;
}

.libro-nav-contador {
    font-size: 0.75rem;
    color: rgb(180 165 140);
    font-style: italic;
    min-width: 40px;
    text-align: center;
}

/* --- Colores del √≠ndice del Heroario --- */
.libro-heroes .libro-titulo {
    color: rgb(230 200 160 / 95%);
    text-shadow:
        0 0 8px rgb(230 200 160 / 20%),
        0 1px 2px rgb(0 0 0 / 60%);
}

.libro-heroes .libro-subtitulo {
    color: rgb(220 205 180 / 70%);
}

/* --- Bot√≥n Empezar del Heroario --- */
.libro-heroes-empezar {
    margin-top: auto;
    width: 100%;
    padding: 8px 0;
    font-size: 0.85rem;
    background-color: var(--v-oscuro, #3a2818);
    box-shadow: 0 0 12px var(--v-glow, rgb(230 200 160 / 30%));
}

.libro-heroes-empezar::after {
    box-shadow:
        0 0 20px var(--v-glow, rgb(230 200 160 / 40%)),
        0 0 40px var(--v-glow, rgb(230 200 160 / 15%));
}

.libro-heroes-empezar:hover {
    background-color: var(--v-color, #4a3828);
    box-shadow: 0 0 18px var(--v-glow, rgb(230 200 160 / 50%));
}

/* Variables de color para la p√°gina de inicio (sin entidad activa) */
.libro-en-inicio {
    --v-color: rgb(230 200 160 / 95%);
    --v-oscuro: rgb(180 155 120);
    --v-glow: rgb(230 200 160 / 30%);
    --v-tenue: rgb(230 200 160 / 10%);
}

/* Ocultar bot√≥n Empezar en la p√°gina de inicio */
.libro-en-inicio .libro-heroes-empezar {
    display: none;
}

/* Item de inicio en el √≠ndice */
.libro-indice-inicio {
    font-style: italic;
    font-size: 0.7rem;
    letter-spacing: 0.04em;
}

/* Subt√≠tulo de secci√≥n en el √≠ndice */
.libro-indice-seccion {
    font-size: 0.58rem;
    font-family: var(--font-display);
    color: rgb(255 215 0 / 50%);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 4px 8px 2px;
    pointer-events: none;
    list-style: none;
}

/* --- P√°gina de bienvenida del Heroario --- */
.libro-intro {
    text-align: center;
    padding: 20px 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
}

.libro-intro-game-titulo {
    font-family: var(--font-display);
    font-size: 1.5rem;
    color: white;
    letter-spacing: 0.04em;
    margin: 0 0 8px;
    line-height: 1.3;
}

.libro-intro-texto {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 14px;
    max-width: 290px;
}

.libro-intro-texto p {
    font-size: 0.88rem;
    line-height: 1.6;
    color: rgb(220 205 180 / 95%);
}

.libro-intro-link {
    color: rgb(230 200 160 / 90%);
    text-decoration: underline;
    text-decoration-color: rgb(230 200 160 / 30%);
    text-underline-offset: 3px;
    cursor: pointer;
    transition:
        color 0.2s,
        text-decoration-color 0.2s;
}

.libro-intro-link:hover {
    color: rgb(255 220 170);
    text-decoration-color: rgb(255 220 170 / 60%);
}

.libro-intro-cta {
    color: rgb(240 210 150 / 95%) !important;
    font-family: var(--font-display);
    font-size: 0.92rem !important;
    margin-top: 4px;
}

/* --- P√°ginas de habitaciones del Heroario --- */
.libro-habitacion {
    text-align: center;
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
}

.libro-habitacion-img {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-dorado);
    box-shadow: 0 0 15px rgb(255 215 0 / 20%);
    margin-bottom: 8px;
}

.libro-habitacion-icono {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: rgb(255 215 0 / 8%);
    border: 3px solid rgb(255 215 0 / 25%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    margin-bottom: 8px;
}

.libro-habitacion-nombre {
    font-family: var(--font-display);
    font-size: 1.3rem;
    color: white;
    margin: 0 0 4px;
    line-height: 1.3;
}

.libro-habitacion-nivel {
    display: inline-block;
    background: rgb(255 215 0 / 12%);
    color: var(--color-dorado);
    font-family: var(--font-display);
    font-size: 0.68rem;
    padding: 2px 12px;
    border-radius: 10px;
    letter-spacing: 0.06em;
    margin-bottom: 6px;
}

.libro-habitacion-desc {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 280px;
}

.libro-habitacion-desc p {
    font-size: 0.84rem;
    line-height: 1.55;
    color: rgb(220 205 180 / 90%);
}

.libro-habitacion-tip {
    background: rgb(255 215 0 / 8%);
    border-left: 2px solid rgb(255 215 0 / 30%);
    padding: 8px 12px;
    border-radius: 0 6px 6px 0;
    font-size: 0.78rem;
    color: rgb(240 220 170 / 85%);
    line-height: 1.5;
    text-align: left;
    max-width: 280px;
    margin-top: 4px;
}

.libro-habitacion-tip-icono {
    margin-right: 4px;
}

/* --- Bot√≥n flotante del libro --- */

.libro-boton {
    margin-left: auto;
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    animation: libro-levitar 3s ease-in-out infinite;
}

.libro-boton img {
    width: 90px;
    height: 90px;
    border-radius: 12px;
    object-fit: cover;
    animation: libro-glow 2.5s ease-in-out infinite alternate;
}

.libro-boton-texto {
    font-family: var(--font-display);
    font-size: 0.85rem;
    color: var(--color-texto-secundario);
    text-shadow: 0 1px 4px rgb(0 0 0 / 60%);
    transition: color 0.3s;
}

.libro-boton:hover {
    animation-duration: 2s;
}

.libro-boton:hover img {
    animation: libro-glow-intenso 1.5s ease-in-out infinite alternate;
}

.libro-boton:hover .libro-boton-texto {
    color: var(--color-accent);
}

.libro-boton:active {
    animation: none;
    transform: translateY(2px) rotate(-6deg);
}

/* Levitaci√≥n con rotaci√≥n */
@keyframes libro-levitar {
    0%,
    100% {
        transform: translateY(0) rotate(-6deg);
    }

    50% {
        transform: translateY(-8px) rotate(-6deg);
    }
}

/* Glow normal */
@keyframes libro-glow {
    from {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 10px rgb(140 50 180 / 35%));
    }

    to {
        filter: drop-shadow(0 4px 8px rgb(0 0 0 / 40%)) drop-shadow(0 0 16px rgb(233 69 96 / 45%));
    }
}

/* Glow intenso (hover) */
@keyframes libro-glow-intenso {
    from {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 20px rgb(140 50 180 / 60%));
    }

    to {
        filter: drop-shadow(0 4px 12px rgb(0 0 0 / 50%)) drop-shadow(0 0 24px rgb(233 69 96 / 70%));
    }
}

/* Chispas m√°gicas */
.libro-chispas {
    position: absolute;
    inset: -10px;
    pointer-events: none;
}

.libro-chispa {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    opacity: 0;
}

.libro-chispa:nth-child(1) {
    left: 15%;
    top: 15%;
    background: rgb(180 80 220);
    box-shadow: 0 0 4px rgb(180 80 220);
    animation: chispa-flotar 2.8s ease-in-out infinite;
}

.libro-chispa:nth-child(2) {
    right: 10%;
    top: 25%;
    background: rgb(233 69 96);
    box-shadow: 0 0 4px rgb(233 69 96);
    animation: chispa-flotar 3.2s ease-in-out infinite 0.5s;
}

.libro-chispa:nth-child(3) {
    left: 50%;
    top: 5%;
    background: rgb(255 210 80);
    box-shadow: 0 0 5px rgb(255 210 80);
    animation: chispa-flotar 2.5s ease-in-out infinite 1s;
}

.libro-chispa:nth-child(4) {
    right: 5%;
    bottom: 35%;
    background: rgb(160 60 200);
    box-shadow: 0 0 4px rgb(160 60 200);
    animation: chispa-flotar 3s ease-in-out infinite 1.5s;
}

.libro-chispa:nth-child(5) {
    left: 5%;
    bottom: 40%;
    background: rgb(233 120 140);
    box-shadow: 0 0 4px rgb(233 120 140);
    animation: chispa-flotar 2.6s ease-in-out infinite 2s;
}

.libro-chispa:nth-child(6) {
    left: 30%;
    bottom: 30%;
    background: rgb(255 180 60);
    box-shadow: 0 0 4px rgb(255 180 60);
    animation: chispa-flotar 3.4s ease-in-out infinite 0.8s;
}

@keyframes chispa-flotar {
    0%,
    100% {
        opacity: 0;
        transform: translateY(0) scale(0.3);
    }

    15% {
        opacity: 1;
        transform: translateY(-5px) scale(1);
    }

    50% {
        opacity: 0.7;
        transform: translateY(-15px) scale(0.8);
    }

    85% {
        opacity: 0;
        transform: translateY(-25px) scale(0.2);
    }
}

/* --- Modal del libro --- */

.libro-modal {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow: hidden;
}

.libro-modal-fondo {
    position: absolute;
    inset: 0;
    background-color: rgb(0 0 0 / 80%);
}

.libro-modal-cuerpo {
    position: relative;
    animation: modal-aparecer 0.3s ease;
    height: calc(100dvh - 64px);
    max-width: min(700px, calc(100vw - 40px));
    overflow: hidden;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
}

.libro-modal-cuerpo .libro-villanos {
    flex: 1;
    height: auto;
    min-height: 0;
}

.libro-modal-cerrar {
    position: absolute;
    top: 8px;
    right: 8px;
    z-index: 10;
    width: 36px;
    height: 36px;
    border: 2px solid rgb(255 255 255 / 15%);
    border-radius: 50%;
    background-color: rgb(15 12 20 / 85%);
    color: var(--color-texto-secundario);
    font-size: 1.3rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(6px);
    transition:
        border-color 0.2s,
        color 0.2s,
        background-color 0.2s;
}

.libro-modal-cerrar:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
    background-color: rgb(233 69 96 / 15%);
}

/* --- Libros del pasillo (Heroario + Villanario lateral) --- */

.libros-pasillo {
    position: absolute;
    right: 6px;
    bottom: 8px;
    display: flex;
    gap: 8px;
    z-index: 10;
}

.libros-pasillo-boton {
    margin-left: 0;
    margin-top: 0;
    padding: 4px;
}

.libros-pasillo-boton img {
    width: 48px;
    height: 48px;
    border-radius: 8px;
}

.libros-pasillo-boton .libro-boton-texto {
    font-size: 0.6rem;
}

.libro-modal-cuerpo .libro-heroes {
    flex: 1;
    height: auto;
    min-height: 0;
}

/* ============================================================
   RESPONSIVE ‚Äî Selecci√≥n de personaje
   ============================================================ */

/* --- Tablet (481‚Äì768px) --- */
@media (width <= 768px) {
    /* Pasillo tablet */
    .puerta {
        width: 19%;
        height: 18%;
    }

    .antorcha {
        display: none;
    }

    .polvo-7,
    .polvo-8,
    .polvo-11,
    .polvo-12,
    .polvo-13,
    .polvo-14 {
        display: none;
    }

    #juego {
        padding: 30px 16px;
    }

    h1 {
        font-size: 2rem;
    }

    .modal-contenido {
        padding: 24px 28px;
    }

    .modal-derrota-caja {
        padding: 20px 24px;
    }

    .barra-superior {
        gap: 10px;
        padding: 6px 10px;
    }

    .barra-jugador img {
        width: 28px;
        height: 28px;
    }

    .barra-jugador span {
        font-size: 0.8rem;
    }

    .barra-vida-jugador {
        min-width: 80px;
    }

    .inventario-slot {
        width: 24px;
        height: 24px;
        font-size: 0.85rem;
    }

    .toast-contenedor {
        right: 8px;
        width: 46px;
    }

    .toast {
        width: 40px;
        height: 40px;
        border-radius: 10px;
    }

    .toast-icono {
        font-size: 1.1rem;
    }

    .toast-mensaje {
        font-size: 0.7rem;
    }

    /* Libro tablet */
    .libro-villanos,
    .libro-heroes {
        max-width: 580px;
        height: 560px;
        max-height: calc(85vh - 40px);
    }

    .libro-pagina-izq {
        flex: 0 0 170px;
        padding: 16px;
    }

    .libro-pagina-der {
        padding: 16px;
    }

    .libro-titulo {
        font-size: 1rem;
    }

    .libro-detalle-contenido .avatar img {
        width: 90px;
        height: 90px;
    }

    .libro-esquina {
        width: 16px;
        height: 16px;
    }

    .libro-lomo {
        flex: 0 0 20px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1.1rem;
    }

    .libro-tab {
        font-size: 0.7rem;
        padding: 3px 10px;
    }

    .libro-nav-btn {
        width: 28px;
        height: 28px;
        font-size: 1rem;
    }

    .libro-nav-contador {
        font-size: 0.7rem;
    }

    .libro-modal-cuerpo {
        height: calc(100dvh - 50px);
    }
}

/* --- Mobile (‚â§480px) --- */
@media (width <= 480px) {
    /* Pasillo mobile */
    .puerta {
        width: 22%;
        height: 20%;
    }

    /* Touch target expandido */
    .puerta::after {
        content: '';
        position: absolute;
        inset: -10px;
    }

    .enredadera,
    .pasillo-ventana {
        display: none;
    }

    .polvo-5,
    .polvo-6,
    .polvo-7,
    .polvo-8,
    .polvo-9,
    .polvo-10,
    .polvo-11,
    .polvo-12,
    .polvo-13,
    .polvo-14 {
        display: none;
    }

    .niebla-capa-2 {
        display: none;
    }

    #juego {
        padding: 8px;
    }

    .btn-empezar {
        padding: 10px 24px;
        font-size: 1rem;
    }

    .modal-contenido {
        padding: 20px;
    }

    .modal-contenido h2 {
        font-size: 1.1rem;
    }

    .modal-derrota-caja {
        padding: 18px 16px;
    }

    .modal-derrota-caja h2 {
        font-size: 1.05rem;
    }

    #btn-entrar,
    #btn-cancelar {
        padding: 10px 22px;
        font-size: 0.9rem;
    }

    .barra-superior {
        gap: 6px;
        padding: 5px 8px;
    }

    .barra-jugador img {
        width: 24px;
        height: 24px;
    }

    .barra-jugador span {
        font-size: 0.75rem;
    }

    .barra-vida-texto {
        font-size: 0.6rem;
    }

    .barra-vida-jugador {
        min-width: 60px;
        gap: 4px;
    }

    .barra-vida-corazon {
        font-size: 0.75rem;
    }

    .inventario-slot {
        width: 22px;
        height: 22px;
        font-size: 0.8rem;
    }

    .toast-contenedor {
        right: 6px;
        width: 42px;
    }

    .toast {
        width: 36px;
        height: 36px;
        border-radius: 8px;
    }

    .toast-icono {
        font-size: 1rem;
    }

    .toast-mensaje {
        font-size: 0.65rem;
        padding: 4px 10px;
    }

    /* Libro mobile */
    .libro-villanos,
    .libro-heroes {
        flex-direction: column;
        max-width: 100%;
        position: relative;
    }

    .libro-heroes {
        flex: 1;
        min-height: 0;
    }

    .libro-pagina-izq {
        flex: none;
        padding: 10px 12px;
    }

    .libro-titulo {
        font-size: 0.95rem;
        margin-bottom: 4px;
    }

    .libro-ornamento {
        display: none;
    }

    .libro-indice {
        flex-flow: row wrap;
        gap: 4px;
        margin: 4px 0;
    }

    .libro-indice-item {
        padding: 4px 6px;
        font-size: 0.65rem;
        text-align: center;
        border-left: none;
        border-bottom: 2px solid transparent;
    }

    .libro-indice-activo {
        border-left-color: transparent;
        border-bottom-color: var(--v-color, var(--color-accent));
    }

    .libro-indice-sep {
        width: 1px;
        height: auto;
        margin: 2px 4px;
        background: linear-gradient(180deg, transparent, rgb(255 215 0 / 25%), transparent);
    }

    .libro-indice-sep::after {
        display: none;
    }

    /* Bot√≥n Empezar: barra fija sobre la navegaci√≥n en mobile */
    .libro-heroes-empezar {
        position: absolute;
        bottom: 56px;
        left: 0;
        width: 100%;
        margin: 0;
        border-radius: 0;
        padding: 10px 0;
        font-size: 0.9rem;
        z-index: 5;
        box-shadow: 0 -4px 12px rgb(0 0 0 / 40%);
    }

    .libro-en-inicio .libro-heroes-empezar {
        display: none;
    }

    /* Espacio extra para que el contenido pueda scrollear m√°s all√° del bot√≥n Empezar */
    .libro-heroes .libro-descripcion-grande,
    .libro-heroes .stats {
        padding-bottom: 48px;
    }

    .libro-lomo {
        display: none;
    }

    .libro-lomo-costura {
        display: none;
    }

    .libro-pagina-der {
        padding: 12px;
    }

    /* Fondo plano del personaje solo cuando hay uno activo (no en Bienvenida) */
    :not(.libro-en-inicio) > .libro-pagina-der {
        background: none;
        background-color: inherit;
    }

    :not(.libro-en-inicio) > .libro-pagina-der::before {
        display: none;
    }

    .libro-detalle-contenido {
        padding: 8px 12px;
    }

    .libro-detalle-contenido .avatar img {
        width: 80px;
        height: 80px;
    }

    .libro-esquina {
        width: 14px;
        height: 14px;
        opacity: 0.3;
    }

    .libro-detalle-cabecera h3 {
        font-size: 1rem;
    }

    .libro-tab {
        font-size: 0.65rem;
        padding: 3px 8px;
    }

    .libro-descripcion-grande {
        font-size: 0.8rem;
        line-height: 1.5;
    }

    .libro-nav-btn {
        width: 26px;
        height: 26px;
        font-size: 0.9rem;
    }

    .libro-nav-contador {
        font-size: 0.65rem;
    }

    .libro-boton {
        margin-top: 12px;
        padding: 4px;
    }

    .libro-boton img {
        width: 54px;
        height: 54px;
        border-radius: 10px;
    }

    .libro-boton-texto {
        font-size: 0.6rem;
    }

    .libros-pasillo {
        right: 4px;
        bottom: 4px;
        gap: 4px;
    }

    .libros-pasillo-boton {
        padding: 2px;
    }

    .libros-pasillo-boton img {
        width: 36px;
        height: 36px;
        border-radius: 6px;
    }

    .libros-pasillo-boton .libro-boton-texto {
        font-size: 0.5rem;
    }

    .libro-modal-cuerpo {
        height: calc(100dvh - 36px);
    }

    .libro-modal-cerrar {
        width: 30px;
        height: 30px;
        font-size: 1.1rem;
        top: 6px;
        right: 6px;
    }

    .libro-habitacion {
        padding: 10px 14px;
    }

    .libro-habitacion-img {
        width: 80px;
        height: 80px;
    }

    .libro-habitacion-icono {
        width: 80px;
        height: 80px;
        font-size: 2rem;
    }

    .libro-habitacion-nombre {
        font-size: 1.05rem;
    }

    .libro-habitacion-desc p {
        font-size: 0.78rem;
    }

    .libro-habitacion-tip {
        font-size: 0.72rem;
        padding: 6px 10px;
    }
}

/* --- Pantallas muy peque√±as (‚â§360px) --- */
@media (width <= 360px) {
    /* Pasillo pantallas peque√±as */
    .puerta {
        width: 24%;
        height: 22%;
    }

    .polvo {
        display: none;
    }

    .deco-cuadro {
        display: none;
    }

    .libro-villanos {
        max-height: calc(78vh - 20px);
    }

    .libro-detalle-contenido .avatar img {
        width: 64px;
        height: 64px;
    }

    .libro-esquina {
        display: none;
    }

    .libro-tab {
        font-size: 0.6rem;
        padding: 2px 6px;
    }

    .libro-detalle-cabecera h3 {
        font-size: 0.9rem;
    }

    .libro-descripcion-grande {
        font-size: 0.75rem;
    }

    .libro-indice-item {
        padding: 3px 5px;
        font-size: 0.6rem;
    }
}

/* --- Habitaci√≥n 3: El Memorice --- */

#pantalla-habitacion3 {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

#memorice-indicador {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    margin: 4px auto 10px;
    padding: 8px 20px;
    min-width: 180px;
    background: rgb(0 0 0 / 40%);
    border: 1px solid rgb(255 255 255 / 12%);
    border-radius: 12px;
    transition:
        border-color 0.3s,
        box-shadow 0.3s;
}

.memorice-indicador-texto {
    font-family: var(--font-display);
    font-size: 1.05rem;
    color: #ddd;
    letter-spacing: 0.5px;
    transition:
        color 0.3s,
        text-shadow 0.3s;
}

.memorice-indicador-barra {
    width: 100%;
    height: 5px;
    background: rgb(255 255 255 / 8%);
    border-radius: 3px;
    overflow: hidden;
}

.memorice-indicador-progreso {
    height: 100%;
    border-radius: 3px;
    background: var(--hab-accent, #5eeadb);
    transition:
        width 0.4s ease-out,
        background-color 0.3s;
}

#memorice-indicador.memorice-alerta {
    border-color: rgb(233 69 96 / 40%);
    box-shadow: 0 0 15px rgb(233 69 96 / 25%);
    animation: memorice-alerta-pulso 0.8s ease-in-out infinite;
}

#memorice-indicador.memorice-alerta .memorice-indicador-texto {
    color: #e94560;
    text-shadow: 0 0 10px rgb(233 69 96 / 60%);
}

#memorice-indicador.memorice-alerta .memorice-indicador-progreso {
    background: #e94560;
}

@keyframes memorice-alerta-pulso {
    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.7;
    }
}

/* Grilla de cartas 5 columnas */
.memorice-grilla {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
    max-width: 500px;
    width: 100%;
    padding: 0 8px;
}

/* Carta individual */
.memorice-carta {
    aspect-ratio: 3 / 4;
    perspective: 600px;
    cursor: pointer;
}

.memorice-carta-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.5s ease;
}

.memorice-volteada .memorice-carta-inner {
    transform: rotateY(180deg);
}

/* Caras de la carta (front y back) */
.memorice-carta-front,
.memorice-carta-back {
    position: absolute;
    inset: 0;
    backface-visibility: hidden;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--hab-borde);
}

/* Front: imagen circular + nombre (visible al voltear) */
.memorice-carta-front {
    transform: rotateY(180deg);
    background: linear-gradient(
        145deg,
        var(--hab-pared) 0%,
        var(--hab-pared-medio) 60%,
        var(--hab-pared-oscuro) 100%
    );
    padding: 8px 4px 6px;
    gap: 4px;
}

.memorice-carta-front img {
    width: 60%;
    aspect-ratio: 1;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--hab-accent);
    box-shadow: 0 0 8px rgb(233 69 96 / 30%);
}

.memorice-carta-nombre {
    font-family: var(--font-display);
    font-size: 0.65rem;
    color: #ddd;
    text-align: center;
    line-height: 1.1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
}

/* Back: √≠cono de la mansi√≥n (boca abajo) */
.memorice-carta-back {
    background: linear-gradient(
        145deg,
        var(--hab-pared) 0%,
        var(--hab-pared-medio) 50%,
        var(--hab-pared-oscuro) 100%
    );
    box-shadow:
        inset 0 0 20px rgb(0 0 0 / 40%),
        0 2px 8px rgb(0 0 0 / 50%);
    overflow: hidden;
}

.memorice-carta-back img {
    width: 65%;
    aspect-ratio: 1;
    object-fit: contain;
    border-radius: 16px;
    filter: drop-shadow(0 0 8px rgb(233 69 96 / 40%));
}

/* Villanos: borde rojo sutil para diferenciar */
.memorice-carta-villano .memorice-carta-front {
    border-color: rgb(200 50 50 / 40%);
}

.memorice-carta-villano .memorice-carta-front img {
    border-color: #c03030;
    box-shadow: 0 0 8px rgb(200 50 50 / 40%);
}

/* Par encontrado: borde dorado + glow */
.memorice-encontrada .memorice-carta-front {
    border-color: var(--color-dorado);
    box-shadow: 0 0 12px rgb(255 215 0 / 50%);
    animation: memorice-encontrada 0.5s ease;
}

@keyframes memorice-encontrada {
    0% {
        transform: rotateY(180deg) scale(1);
    }

    50% {
        transform: rotateY(180deg) scale(1.1);
    }

    100% {
        transform: rotateY(180deg) scale(1);
    }
}

/* Cartas desactivadas (derrota) */
.memorice-desactivada {
    opacity: 0.4;
    filter: grayscale(0.8);
    pointer-events: none;
}

/* Responsive: m√≥vil */
@media (width <= 500px) {
    .memorice-grilla {
        gap: 5px;
        padding: 0 4px;
    }

    .memorice-carta-nombre {
        font-size: 0.55rem;
    }

    #memorice-indicador {
        min-width: 150px;
        padding: 6px 14px;
    }

    .memorice-indicador-texto {
        font-size: 0.9rem;
    }
}

/* --- Pulido mobile --- */

/* Ocultar hints de teclado en dispositivos touch */
@media (hover: none), (pointer: coarse) {
    #controles-hint,
    .laberinto-hint {
        display: none;
    }
}

/* Targets m√≠nimos de 44x44px y posici√≥n de botones en touch */
@media (pointer: coarse) {
    #btn-entrar,
    #btn-cancelar,
    .modal-derrota-btn,
    .btn-huir {
        min-height: 44px;
        min-width: 44px;
    }
}

/* Reducir animaciones pesadas si el usuario lo prefiere */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    /* Pasillo: sin entreapertura de puerta ni efectos decorativos */
    .puerta-cerca .puerta-hoja {
        transform: none;
    }

    .polvo,
    .antorcha-llama,
    .niebla-capa,
    .ventana-estrella {
        display: none;
    }
}
